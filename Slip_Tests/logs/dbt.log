[0m23:43:16.685208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183295CBE00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183275F46B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018329463560>]}


============================== 23:43:16.685208 | 3e9a8e5e-a39c-4d72-8efe-35aa0548d775 ==============================
[0m23:43:16.685208 [info ] [MainThread]: Running with dbt=1.10.1
[0m23:43:16.685208 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ThembaniFaleni\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'c:\\dbt_workspace\\Slip_Tests\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:43:16.935045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e9a8e5e-a39c-4d72-8efe-35aa0548d775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183298D2840>]}
[0m23:43:16.965772 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:43:16.966772 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:43:16.968587 [debug] [MainThread]: Command `cli deps` succeeded at 23:43:16.968587 after 0.50 seconds
[0m23:43:16.968587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018329635640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018329B3A2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018329ABE270>]}
[0m23:43:16.969625 [debug] [MainThread]: Flushing usage events
[0m23:43:18.380055 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:49:13.996227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002203A375580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002203C9E51F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002203CCE45F0>]}


============================== 23:49:14.009330 | 952b8411-f3b9-44e1-8664-c5f2a5ef756b ==============================
[0m23:49:14.009330 [info ] [MainThread]: Running with dbt=1.10.1
[0m23:49:14.009330 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ThembaniFaleni\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\dbt_workspace\\Slip_Tests\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:49:14.652016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '952b8411-f3b9-44e1-8664-c5f2a5ef756b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002203F4CB770>]}
[0m23:49:14.777677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '952b8411-f3b9-44e1-8664-c5f2a5ef756b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002203C859760>]}
[0m23:49:14.777677 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m23:49:14.970310 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m23:49:15.099518 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:49:15.099518 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:49:15.147940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '952b8411-f3b9-44e1-8664-c5f2a5ef756b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002203F5B7980>]}
[0m23:49:15.208296 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m23:49:15.241209 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m23:49:15.270521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '952b8411-f3b9-44e1-8664-c5f2a5ef756b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002203F49A060>]}
[0m23:49:15.270521 [info ] [MainThread]: Found 2 models, 4 data tests, 476 macros
[0m23:49:15.270521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '952b8411-f3b9-44e1-8664-c5f2a5ef756b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002203F7A8320>]}
[0m23:49:15.270521 [info ] [MainThread]: 
[0m23:49:15.270521 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:49:15.270521 [info ] [MainThread]: 
[0m23:49:15.270521 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:49:15.270521 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MOVIELENS'
[0m23:49:15.387662 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS"
[0m23:49:15.387662 [debug] [ThreadPool]: On list_MOVIELENS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS"} */
show terse schemas in database MOVIELENS
    limit 10000
[0m23:49:15.387662 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:49:18.963677 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 3.577 seconds
[0m23:49:18.963677 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MOVIELENS_DEV'
[0m23:49:18.979158 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m23:49:18.979158 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session set quoted_identifiers_ignore_case = false;
[0m23:49:18.979158 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:49:20.059788 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.074 seconds
[0m23:49:20.059788 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m23:49:20.059788 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
show objects in MOVIELENS.DEV
    limit 10000
    
;
[0m23:49:20.312607 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.246 seconds
[0m23:49:20.312607 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m23:49:20.312607 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session unset quoted_identifiers_ignore_case;
[0m23:49:20.561755 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.242 seconds
[0m23:49:20.561755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '952b8411-f3b9-44e1-8664-c5f2a5ef756b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002203F647F80>]}
[0m23:49:20.577468 [debug] [Thread-1 (]: Began running node model.Slip_Tests.my_first_dbt_model
[0m23:49:20.577468 [info ] [Thread-1 (]: 1 of 2 START sql table model DEV.my_first_dbt_model ............................ [RUN]
[0m23:49:20.577468 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Slip_Tests.my_first_dbt_model'
[0m23:49:20.577468 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.my_first_dbt_model
[0m23:49:20.593092 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.my_first_dbt_model"
[0m23:49:20.593092 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.my_first_dbt_model
[0m23:49:20.630935 [debug] [Thread-1 (]: Writing runtime sql for node "model.Slip_Tests.my_first_dbt_model"
[0m23:49:20.630935 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.my_first_dbt_model"
[0m23:49:20.630935 [debug] [Thread-1 (]: On model.Slip_Tests.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.my_first_dbt_model"} */
create or replace transient table MOVIELENS.DEV.my_first_dbt_model
    

    
    as (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
;
[0m23:49:20.630935 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:49:22.992055 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.361 seconds
[0m23:49:23.007818 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '952b8411-f3b9-44e1-8664-c5f2a5ef756b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002203A4796D0>]}
[0m23:49:23.007818 [info ] [Thread-1 (]: 1 of 2 OK created sql table model DEV.my_first_dbt_model ....................... [[32mSUCCESS 1[0m in 2.43s]
[0m23:49:23.007818 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.my_first_dbt_model
[0m23:49:23.018826 [debug] [Thread-1 (]: Began running node model.Slip_Tests.my_second_dbt_model
[0m23:49:23.018826 [info ] [Thread-1 (]: 2 of 2 START sql view model DEV.my_second_dbt_model ............................ [RUN]
[0m23:49:23.018826 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Slip_Tests.my_first_dbt_model, now model.Slip_Tests.my_second_dbt_model)
[0m23:49:23.018826 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.my_second_dbt_model
[0m23:49:23.018826 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.my_second_dbt_model"
[0m23:49:23.018826 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.my_second_dbt_model
[0m23:49:23.039575 [debug] [Thread-1 (]: Writing runtime sql for node "model.Slip_Tests.my_second_dbt_model"
[0m23:49:23.039575 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.my_second_dbt_model"
[0m23:49:23.039575 [debug] [Thread-1 (]: On model.Slip_Tests.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.my_second_dbt_model"} */
create or replace   view MOVIELENS.DEV.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from MOVIELENS.DEV.my_first_dbt_model
where id = 1
  );
[0m23:49:23.601971 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.567 seconds
[0m23:49:23.601971 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '952b8411-f3b9-44e1-8664-c5f2a5ef756b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002204001F5F0>]}
[0m23:49:23.617441 [info ] [Thread-1 (]: 2 of 2 OK created sql view model DEV.my_second_dbt_model ....................... [[32mSUCCESS 1[0m in 0.58s]
[0m23:49:23.617441 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.my_second_dbt_model
[0m23:49:23.620548 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:49:23.620548 [debug] [MainThread]: Connection 'list_MOVIELENS' was left open.
[0m23:49:23.620548 [debug] [MainThread]: On list_MOVIELENS: Close
[0m23:49:23.997344 [debug] [MainThread]: Connection 'list_MOVIELENS_DEV' was left open.
[0m23:49:23.997344 [debug] [MainThread]: On list_MOVIELENS_DEV: Close
[0m23:49:24.343602 [debug] [MainThread]: Connection 'model.Slip_Tests.my_second_dbt_model' was left open.
[0m23:49:24.343602 [debug] [MainThread]: On model.Slip_Tests.my_second_dbt_model: Close
[0m23:49:24.871894 [info ] [MainThread]: 
[0m23:49:24.871894 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 9.60 seconds (9.60s).
[0m23:49:24.871894 [debug] [MainThread]: Command end result
[0m23:49:24.889546 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m23:49:24.902160 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m23:49:24.914350 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\dbt_workspace\Slip_Tests\target\run_results.json
[0m23:49:24.914350 [info ] [MainThread]: 
[0m23:49:24.914350 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:49:24.915457 [info ] [MainThread]: 
[0m23:49:24.916394 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m23:49:24.917522 [debug] [MainThread]: Command `dbt run` succeeded at 23:49:24.917522 after 11.17 seconds
[0m23:49:24.918062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002203CCA2A80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022039A7A210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002203CE9F1D0>]}
[0m23:49:24.918062 [debug] [MainThread]: Flushing usage events
[0m23:49:26.093946 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:55:22.520358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026730DA8E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026730DA93A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026730DA9220>]}


============================== 23:55:22.524510 | ca32a959-1bd2-407e-838c-0002fdb3a1a4 ==============================
[0m23:55:22.524510 [info ] [MainThread]: Running with dbt=1.10.1
[0m23:55:22.524510 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ThembaniFaleni\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\dbt_workspace\\Slip_Tests\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m23:55:23.259286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca32a959-1bd2-407e-838c-0002fdb3a1a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026731877950>]}
[0m23:55:23.401527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca32a959-1bd2-407e-838c-0002fdb3a1a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026733B6A150>]}
[0m23:55:23.417158 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m23:55:23.603444 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m23:55:23.791529 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 4 files added, 0 files changed.
[0m23:55:23.791529 [debug] [MainThread]: Partial parsing: added file: Slip_Tests://models\Staging\my_first_dbt_model.sql
[0m23:55:23.791529 [debug] [MainThread]: Partial parsing: added file: Slip_Tests://models\Staging\schema.yml
[0m23:55:23.791529 [debug] [MainThread]: Partial parsing: added file: Slip_Tests://models\Staging\my_second_dbt_model.sql
[0m23:55:23.791529 [debug] [MainThread]: Partial parsing: added file: Slip_Tests://models\Staging\src_tags.sql
[0m23:55:23.791529 [debug] [MainThread]: Partial parsing: deleted file: Slip_Tests://models\example\my_first_dbt_model.sql
[0m23:55:23.791529 [debug] [MainThread]: Partial parsing: deleted file: Slip_Tests://models\example\my_second_dbt_model.sql
[0m23:55:24.646412 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.Slip_Tests.example
[0m23:55:24.652844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca32a959-1bd2-407e-838c-0002fdb3a1a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026733F5F650>]}
[0m23:55:24.723979 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m23:55:24.734119 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m23:55:24.753505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca32a959-1bd2-407e-838c-0002fdb3a1a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267341AC170>]}
[0m23:55:24.754502 [info ] [MainThread]: Found 3 models, 4 data tests, 476 macros
[0m23:55:24.754502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca32a959-1bd2-407e-838c-0002fdb3a1a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267336AEAB0>]}
[0m23:55:24.755501 [info ] [MainThread]: 
[0m23:55:24.755501 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:55:24.755501 [info ] [MainThread]: 
[0m23:55:24.755501 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:55:24.755501 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MOVIELENS'
[0m23:55:24.824100 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS"
[0m23:55:24.824100 [debug] [ThreadPool]: On list_MOVIELENS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS"} */
show terse schemas in database MOVIELENS
    limit 10000
[0m23:55:24.824100 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:55:26.470641 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.649 seconds
[0m23:55:26.470641 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MOVIELENS_DEV'
[0m23:55:26.486255 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m23:55:26.486255 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session set quoted_identifiers_ignore_case = false;
[0m23:55:26.486255 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:55:27.554967 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.070 seconds
[0m23:55:27.576422 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m23:55:27.576422 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
show objects in MOVIELENS.DEV
    limit 10000
    
;
[0m23:55:27.854758 [debug] [ThreadPool]: SQL status: SUCCESS 16 in 0.276 seconds
[0m23:55:27.854758 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m23:55:27.854758 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session unset quoted_identifiers_ignore_case;
[0m23:55:28.167693 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.310 seconds
[0m23:55:28.170615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca32a959-1bd2-407e-838c-0002fdb3a1a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026733E39370>]}
[0m23:55:28.175408 [debug] [Thread-1 (]: Began running node model.Slip_Tests.my_first_dbt_model
[0m23:55:28.175408 [info ] [Thread-1 (]: 1 of 3 START sql table model DEV.my_first_dbt_model ............................ [RUN]
[0m23:55:28.175408 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Slip_Tests.my_first_dbt_model'
[0m23:55:28.175408 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.my_first_dbt_model
[0m23:55:28.181007 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.my_first_dbt_model"
[0m23:55:28.181007 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.my_first_dbt_model
[0m23:55:28.221164 [debug] [Thread-1 (]: Writing runtime sql for node "model.Slip_Tests.my_first_dbt_model"
[0m23:55:28.222539 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.my_first_dbt_model"
[0m23:55:28.222539 [debug] [Thread-1 (]: On model.Slip_Tests.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.my_first_dbt_model"} */
create or replace transient table MOVIELENS.DEV.my_first_dbt_model
    

    
    as (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
;
[0m23:55:28.222539 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:55:30.018663 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.798 seconds
[0m23:55:30.038570 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca32a959-1bd2-407e-838c-0002fdb3a1a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026730CF2060>]}
[0m23:55:30.038570 [info ] [Thread-1 (]: 1 of 3 OK created sql table model DEV.my_first_dbt_model ....................... [[32mSUCCESS 1[0m in 1.86s]
[0m23:55:30.038570 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.my_first_dbt_model
[0m23:55:30.038570 [debug] [Thread-1 (]: Began running node model.Slip_Tests.src_tags
[0m23:55:30.050621 [info ] [Thread-1 (]: 2 of 3 START sql table model DEV.src_tags ...................................... [RUN]
[0m23:55:30.051779 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Slip_Tests.my_first_dbt_model, now model.Slip_Tests.src_tags)
[0m23:55:30.052417 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.src_tags
[0m23:55:30.052417 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.src_tags"
[0m23:55:30.052417 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.src_tags
[0m23:55:30.052417 [debug] [Thread-1 (]: Writing runtime sql for node "model.Slip_Tests.src_tags"
[0m23:55:30.052417 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.src_tags"
[0m23:55:30.052417 [debug] [Thread-1 (]: On model.Slip_Tests.src_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.src_tags"} */
create or replace transient table MOVIELENS.DEV.src_tags
    

    
    as (

WITH raw_tags AS (
    SELECT * FROM MOVIELENS.RAW.RAW_TAGS
)
SELECT
    userId AS user_id,
    movieId AS movie_id,
    tag,
    TO_TIMESTAMP_LTZ(timestamp) AS tag_timestamp
FROM raw_tags
    )
;
[0m23:55:31.732676 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.672 seconds
[0m23:55:31.734792 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca32a959-1bd2-407e-838c-0002fdb3a1a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267347F7CE0>]}
[0m23:55:31.734792 [info ] [Thread-1 (]: 2 of 3 OK created sql table model DEV.src_tags ................................. [[32mSUCCESS 1[0m in 1.68s]
[0m23:55:31.734792 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.src_tags
[0m23:55:31.734792 [debug] [Thread-1 (]: Began running node model.Slip_Tests.my_second_dbt_model
[0m23:55:31.734792 [info ] [Thread-1 (]: 3 of 3 START sql view model DEV.my_second_dbt_model ............................ [RUN]
[0m23:55:31.742372 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Slip_Tests.src_tags, now model.Slip_Tests.my_second_dbt_model)
[0m23:55:31.742372 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.my_second_dbt_model
[0m23:55:31.742372 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.my_second_dbt_model"
[0m23:55:31.742372 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.my_second_dbt_model
[0m23:55:31.776162 [debug] [Thread-1 (]: Writing runtime sql for node "model.Slip_Tests.my_second_dbt_model"
[0m23:55:31.776162 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.my_second_dbt_model"
[0m23:55:31.776162 [debug] [Thread-1 (]: On model.Slip_Tests.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.my_second_dbt_model"} */
create or replace   view MOVIELENS.DEV.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from MOVIELENS.DEV.my_first_dbt_model
where id = 1
  );
[0m23:55:32.085645 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.316 seconds
[0m23:55:32.085645 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca32a959-1bd2-407e-838c-0002fdb3a1a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026734844380>]}
[0m23:55:32.085645 [info ] [Thread-1 (]: 3 of 3 OK created sql view model DEV.my_second_dbt_model ....................... [[32mSUCCESS 1[0m in 0.34s]
[0m23:55:32.085645 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.my_second_dbt_model
[0m23:55:32.101367 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:55:32.102395 [debug] [MainThread]: Connection 'list_MOVIELENS' was left open.
[0m23:55:32.102395 [debug] [MainThread]: On list_MOVIELENS: Close
[0m23:55:32.469904 [debug] [MainThread]: Connection 'list_MOVIELENS_DEV' was left open.
[0m23:55:32.471997 [debug] [MainThread]: On list_MOVIELENS_DEV: Close
[0m23:55:32.851391 [debug] [MainThread]: Connection 'model.Slip_Tests.my_second_dbt_model' was left open.
[0m23:55:32.851391 [debug] [MainThread]: On model.Slip_Tests.my_second_dbt_model: Close
[0m23:55:33.200649 [info ] [MainThread]: 
[0m23:55:33.216444 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 8.45 seconds (8.45s).
[0m23:55:33.217326 [debug] [MainThread]: Command end result
[0m23:55:33.217326 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m23:55:33.233517 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m23:55:33.239186 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\dbt_workspace\Slip_Tests\target\run_results.json
[0m23:55:33.239186 [info ] [MainThread]: 
[0m23:55:33.239186 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:55:33.246193 [info ] [MainThread]: 
[0m23:55:33.247189 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m23:55:33.248258 [debug] [MainThread]: Command `dbt run` succeeded at 23:55:33.248258 after 10.97 seconds
[0m23:55:33.249248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267308B20F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026731252780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002673083B290>]}
[0m23:55:33.249248 [debug] [MainThread]: Flushing usage events
[0m23:55:34.267080 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:00:20.875979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001860274E060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001860291C740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001867FF29D90>]}


============================== 00:00:20.875979 | 77a88982-a6d0-4064-94c2-73587e5cdd00 ==============================
[0m00:00:20.875979 [info ] [MainThread]: Running with dbt=1.10.1
[0m00:00:20.891548 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\dbt_workspace\\Slip_Tests\\logs', 'profiles_dir': 'C:\\Users\\ThembaniFaleni\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:00:21.538900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '77a88982-a6d0-4064-94c2-73587e5cdd00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186051777D0>]}
[0m00:00:21.683674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '77a88982-a6d0-4064-94c2-73587e5cdd00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018600BC0D40>]}
[0m00:00:21.683674 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m00:00:21.851172 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m00:00:21.946032 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m00:00:21.946032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '77a88982-a6d0-4064-94c2-73587e5cdd00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001860555E1B0>]}
[0m00:00:23.263111 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.Slip_Tests
- models.Slip_Tests.fct
- models.Slip_Tests.dim
[0m00:00:23.263111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '77a88982-a6d0-4064-94c2-73587e5cdd00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186054ACC20>]}
[0m00:00:23.340423 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m00:00:23.340423 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m00:00:23.371077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '77a88982-a6d0-4064-94c2-73587e5cdd00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018605769700>]}
[0m00:00:23.372087 [info ] [MainThread]: Found 3 models, 4 data tests, 476 macros
[0m00:00:23.373092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77a88982-a6d0-4064-94c2-73587e5cdd00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001860580F1D0>]}
[0m00:00:23.374367 [info ] [MainThread]: 
[0m00:00:23.374367 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:00:23.374367 [info ] [MainThread]: 
[0m00:00:23.380062 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:00:23.385255 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MOVIELENS'
[0m00:00:23.439903 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS"
[0m00:00:23.439903 [debug] [ThreadPool]: On list_MOVIELENS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "netflix", "target_name": "dev", "connection_name": "list_MOVIELENS"} */
show terse schemas in database MOVIELENS
    limit 10000
[0m00:00:23.439903 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:00:24.787278 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.353 seconds
[0m00:00:24.802296 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MOVIELENS_DEV'
[0m00:00:24.802296 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m00:00:24.802296 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "netflix", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session set quoted_identifiers_ignore_case = false;
[0m00:00:24.802296 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:00:25.881009 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.079 seconds
[0m00:00:25.896705 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m00:00:25.896705 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "netflix", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
show objects in MOVIELENS.DEV
    limit 10000
    
;
[0m00:00:27.049924 [debug] [ThreadPool]: SQL status: SUCCESS 16 in 1.150 seconds
[0m00:00:27.049924 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m00:00:27.049924 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "netflix", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session unset quoted_identifiers_ignore_case;
[0m00:00:27.276207 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.230 seconds
[0m00:00:27.276207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77a88982-a6d0-4064-94c2-73587e5cdd00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018605174800>]}
[0m00:00:27.291717 [debug] [Thread-1 (]: Began running node model.netflix.my_first_dbt_model
[0m00:00:27.291717 [info ] [Thread-1 (]: 1 of 3 START sql table model DEV.my_first_dbt_model ............................ [RUN]
[0m00:00:27.291717 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.netflix.my_first_dbt_model'
[0m00:00:27.291717 [debug] [Thread-1 (]: Began compiling node model.netflix.my_first_dbt_model
[0m00:00:27.291717 [debug] [Thread-1 (]: Writing injected SQL for node "model.netflix.my_first_dbt_model"
[0m00:00:27.291717 [debug] [Thread-1 (]: Began executing node model.netflix.my_first_dbt_model
[0m00:00:27.326969 [debug] [Thread-1 (]: Writing runtime sql for node "model.netflix.my_first_dbt_model"
[0m00:00:27.336793 [debug] [Thread-1 (]: Using snowflake connection "model.netflix.my_first_dbt_model"
[0m00:00:27.337804 [debug] [Thread-1 (]: On model.netflix.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "netflix", "target_name": "dev", "node_id": "model.netflix.my_first_dbt_model"} */
create or replace transient table MOVIELENS.DEV.my_first_dbt_model
    

    
    as (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
;
[0m00:00:27.337804 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:00:29.877442 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.542 seconds
[0m00:00:29.892915 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77a88982-a6d0-4064-94c2-73587e5cdd00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186001393D0>]}
[0m00:00:29.892915 [info ] [Thread-1 (]: 1 of 3 OK created sql table model DEV.my_first_dbt_model ....................... [[32mSUCCESS 1[0m in 2.60s]
[0m00:00:29.892915 [debug] [Thread-1 (]: Finished running node model.netflix.my_first_dbt_model
[0m00:00:29.892915 [debug] [Thread-1 (]: Began running node model.netflix.src_tags
[0m00:00:29.892915 [info ] [Thread-1 (]: 2 of 3 START sql table model DEV.src_tags ...................................... [RUN]
[0m00:00:29.892915 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.netflix.my_first_dbt_model, now model.netflix.src_tags)
[0m00:00:29.892915 [debug] [Thread-1 (]: Began compiling node model.netflix.src_tags
[0m00:00:29.908555 [debug] [Thread-1 (]: Writing injected SQL for node "model.netflix.src_tags"
[0m00:00:29.909886 [debug] [Thread-1 (]: Began executing node model.netflix.src_tags
[0m00:00:29.913235 [debug] [Thread-1 (]: Writing runtime sql for node "model.netflix.src_tags"
[0m00:00:29.914595 [debug] [Thread-1 (]: Using snowflake connection "model.netflix.src_tags"
[0m00:00:29.914595 [debug] [Thread-1 (]: On model.netflix.src_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "netflix", "target_name": "dev", "node_id": "model.netflix.src_tags"} */
create or replace transient table MOVIELENS.DEV.src_tags
    

    
    as (

WITH raw_tags AS (
    SELECT * FROM MOVIELENS.RAW.RAW_TAGS
)
SELECT
    userId AS user_id,
    movieId AS movie_id,
    tag,
    TO_TIMESTAMP_LTZ(timestamp) AS tag_timestamp
FROM raw_tags
    )
;
[0m00:00:31.648375 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.744 seconds
[0m00:00:31.661010 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77a88982-a6d0-4064-94c2-73587e5cdd00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018605E96390>]}
[0m00:00:31.664137 [info ] [Thread-1 (]: 2 of 3 OK created sql table model DEV.src_tags ................................. [[32mSUCCESS 1[0m in 1.77s]
[0m00:00:31.664137 [debug] [Thread-1 (]: Finished running node model.netflix.src_tags
[0m00:00:31.664137 [debug] [Thread-1 (]: Began running node model.netflix.my_second_dbt_model
[0m00:00:31.664137 [info ] [Thread-1 (]: 3 of 3 START sql view model DEV.my_second_dbt_model ............................ [RUN]
[0m00:00:31.664137 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.netflix.src_tags, now model.netflix.my_second_dbt_model)
[0m00:00:31.664137 [debug] [Thread-1 (]: Began compiling node model.netflix.my_second_dbt_model
[0m00:00:31.664137 [debug] [Thread-1 (]: Writing injected SQL for node "model.netflix.my_second_dbt_model"
[0m00:00:31.664137 [debug] [Thread-1 (]: Began executing node model.netflix.my_second_dbt_model
[0m00:00:31.690509 [debug] [Thread-1 (]: Writing runtime sql for node "model.netflix.my_second_dbt_model"
[0m00:00:31.691553 [debug] [Thread-1 (]: Using snowflake connection "model.netflix.my_second_dbt_model"
[0m00:00:31.692537 [debug] [Thread-1 (]: On model.netflix.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "netflix", "target_name": "dev", "node_id": "model.netflix.my_second_dbt_model"} */
create or replace   view MOVIELENS.DEV.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from MOVIELENS.DEV.my_first_dbt_model
where id = 1
  );
[0m00:00:32.401057 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.708 seconds
[0m00:00:32.402820 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77a88982-a6d0-4064-94c2-73587e5cdd00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018605F77E90>]}
[0m00:00:32.404014 [info ] [Thread-1 (]: 3 of 3 OK created sql view model DEV.my_second_dbt_model ....................... [[32mSUCCESS 1[0m in 0.74s]
[0m00:00:32.405101 [debug] [Thread-1 (]: Finished running node model.netflix.my_second_dbt_model
[0m00:00:32.406818 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:00:32.407422 [debug] [MainThread]: Connection 'list_MOVIELENS' was left open.
[0m00:00:32.408002 [debug] [MainThread]: On list_MOVIELENS: Close
[0m00:00:32.785394 [debug] [MainThread]: Connection 'list_MOVIELENS_DEV' was left open.
[0m00:00:32.785394 [debug] [MainThread]: On list_MOVIELENS_DEV: Close
[0m00:00:33.168142 [debug] [MainThread]: Connection 'model.netflix.my_second_dbt_model' was left open.
[0m00:00:33.168142 [debug] [MainThread]: On model.netflix.my_second_dbt_model: Close
[0m00:00:33.567029 [info ] [MainThread]: 
[0m00:00:33.567029 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 10.19 seconds (10.19s).
[0m00:00:33.567029 [debug] [MainThread]: Command end result
[0m00:00:33.583183 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m00:00:33.583183 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m00:00:33.605407 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\dbt_workspace\Slip_Tests\target\run_results.json
[0m00:00:33.605407 [info ] [MainThread]: 
[0m00:00:33.605407 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:00:33.611520 [info ] [MainThread]: 
[0m00:00:33.611520 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m00:00:33.612528 [debug] [MainThread]: Command `dbt run` succeeded at 00:00:33.612528 after 12.96 seconds
[0m00:00:33.613639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018602AEFF20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018602518B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018602490440>]}
[0m00:00:33.613639 [debug] [MainThread]: Flushing usage events
[0m00:00:35.139804 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:39:09.144072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D0CDF8CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D10460D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D105BB980>]}


============================== 00:39:09.159750 | c3c1329b-5794-4768-9efa-9a4e01a57941 ==============================
[0m00:39:09.159750 [info ] [MainThread]: Running with dbt=1.10.1
[0m00:39:09.159750 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\ThembaniFaleni\\.dbt', 'log_path': 'C:\\dbt_workspace\\Slip_Tests\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m00:39:09.910149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3c1329b-5794-4768-9efa-9a4e01a57941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D12EEF050>]}
[0m00:39:10.082504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c3c1329b-5794-4768-9efa-9a4e01a57941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D1299DFA0>]}
[0m00:39:10.082504 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m00:39:10.331178 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m00:39:10.444155 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m00:39:10.444155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c3c1329b-5794-4768-9efa-9a4e01a57941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D1328E570>]}
[0m00:39:12.291429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c3c1329b-5794-4768-9efa-9a4e01a57941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D13567650>]}
[0m00:39:12.369627 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m00:39:12.369627 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m00:39:12.400877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c3c1329b-5794-4768-9efa-9a4e01a57941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D13584EF0>]}
[0m00:39:12.400877 [info ] [MainThread]: Found 12 models, 1 snapshot, 476 macros
[0m00:39:12.400877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3c1329b-5794-4768-9efa-9a4e01a57941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D13487DD0>]}
[0m00:39:12.400877 [info ] [MainThread]: 
[0m00:39:12.400877 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:39:12.400877 [info ] [MainThread]: 
[0m00:39:12.400877 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:39:12.416476 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MOVIELENS'
[0m00:39:12.488754 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS"
[0m00:39:12.488754 [debug] [ThreadPool]: On list_MOVIELENS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS"} */
show terse schemas in database MOVIELENS
    limit 10000
[0m00:39:12.488754 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:39:14.377841 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.881 seconds
[0m00:39:14.377841 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MOVIELENS_snapshots'
[0m00:39:14.393603 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m00:39:14.393603 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
alter session set quoted_identifiers_ignore_case = false;
[0m00:39:14.393603 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:39:15.426356 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.046 seconds
[0m00:39:15.441947 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m00:39:15.441947 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
show objects in MOVIELENS.snapshots
    limit 10000
    
;
[0m00:39:15.677948 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.241 seconds
[0m00:39:15.677948 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m00:39:15.677948 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
alter session unset quoted_identifiers_ignore_case;
[0m00:39:15.928010 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.251 seconds
[0m00:39:15.928010 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MOVIELENS_snapshots, now list_MOVIELENS_DEV)
[0m00:39:15.928010 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m00:39:15.943619 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session set quoted_identifiers_ignore_case = false;
[0m00:39:16.179959 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.240 seconds
[0m00:39:16.179959 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m00:39:16.179959 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
show objects in MOVIELENS.DEV
    limit 10000
    
;
[0m00:39:16.493292 [debug] [ThreadPool]: SQL status: SUCCESS 16 in 0.311 seconds
[0m00:39:16.493292 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m00:39:16.493292 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session unset quoted_identifiers_ignore_case;
[0m00:39:16.682843 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.196 seconds
[0m00:39:16.698533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3c1329b-5794-4768-9efa-9a4e01a57941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D131A2AE0>]}
[0m00:39:16.698533 [debug] [Thread-1 (]: Began running node model.Slip_Tests.src_genome_score
[0m00:39:16.698533 [info ] [Thread-1 (]: 1 of 11 START sql view model DEV.src_genome_score .............................. [RUN]
[0m00:39:16.698533 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Slip_Tests.src_genome_score'
[0m00:39:16.706207 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.src_genome_score
[0m00:39:16.706207 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.src_genome_score"
[0m00:39:16.706207 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.src_genome_score
[0m00:39:16.754447 [debug] [Thread-1 (]: Writing runtime sql for node "model.Slip_Tests.src_genome_score"
[0m00:39:16.754447 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.src_genome_score"
[0m00:39:16.754447 [debug] [Thread-1 (]: On model.Slip_Tests.src_genome_score: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.src_genome_score"} */
create or replace   view MOVIELENS.DEV.src_genome_score
  
   as (
    -- For genome_scores
WITH raw_genome_scores AS (
    SELECT * FROM MOVIELENS.RAW.RAW_GENOME_SCORES
)

SELECT
    movieId AS movie_id,
    tagId AS tag_id,
    relevance
FROM raw_genome_scores
  );
[0m00:39:16.754447 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:39:17.950680 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.194 seconds
[0m00:39:17.966749 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3c1329b-5794-4768-9efa-9a4e01a57941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D13584440>]}
[0m00:39:17.966749 [info ] [Thread-1 (]: 1 of 11 OK created sql view model DEV.src_genome_score ......................... [[32mSUCCESS 1[0m in 1.27s]
[0m00:39:17.966749 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.src_genome_score
[0m00:39:17.966749 [debug] [Thread-1 (]: Began running node model.Slip_Tests.src_genome_tags
[0m00:39:17.966749 [info ] [Thread-1 (]: 2 of 11 START sql view model DEV.src_genome_tags ............................... [RUN]
[0m00:39:17.966749 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Slip_Tests.src_genome_score, now model.Slip_Tests.src_genome_tags)
[0m00:39:17.966749 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.src_genome_tags
[0m00:39:17.982425 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.src_genome_tags"
[0m00:39:17.983091 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.src_genome_tags
[0m00:39:17.983091 [debug] [Thread-1 (]: Writing runtime sql for node "model.Slip_Tests.src_genome_tags"
[0m00:39:17.983091 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.src_genome_tags"
[0m00:39:17.983091 [debug] [Thread-1 (]: On model.Slip_Tests.src_genome_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.src_genome_tags"} */
create or replace   view MOVIELENS.DEV.src_genome_tags
  
   as (
    WITH raw_genome_tags AS (
    SELECT * FROM MOVIELENS.RAW.RAW_GENOME_TAGS
)

SELECT
    tagId AS tag_id,
    tag
FROM raw_genome_tags
  );
[0m00:39:18.369116 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.389 seconds
[0m00:39:18.369116 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3c1329b-5794-4768-9efa-9a4e01a57941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D13A82120>]}
[0m00:39:18.369116 [info ] [Thread-1 (]: 2 of 11 OK created sql view model DEV.src_genome_tags .......................... [[32mSUCCESS 1[0m in 0.40s]
[0m00:39:18.369116 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.src_genome_tags
[0m00:39:18.369116 [debug] [Thread-1 (]: Began running node model.Slip_Tests.src_links
[0m00:39:18.369116 [info ] [Thread-1 (]: 3 of 11 START sql view model DEV.src_links ..................................... [RUN]
[0m00:39:18.369116 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Slip_Tests.src_genome_tags, now model.Slip_Tests.src_links)
[0m00:39:18.369116 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.src_links
[0m00:39:18.384804 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.src_links"
[0m00:39:18.384804 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.src_links
[0m00:39:18.384804 [debug] [Thread-1 (]: Writing runtime sql for node "model.Slip_Tests.src_links"
[0m00:39:18.384804 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.src_links"
[0m00:39:18.384804 [debug] [Thread-1 (]: On model.Slip_Tests.src_links: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.src_links"} */
create or replace   view MOVIELENS.DEV.src_links
  
   as (
    -- For links
WITH raw_links AS (
    SELECT * FROM MOVIELENS.RAW.RAW_LINKS
)

SELECT
    movieId AS movie_id,
    imdbId AS imdb_id,
    tmdbId AS tmdb_id
FROM raw_links
  );
[0m00:39:18.801372 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.414 seconds
[0m00:39:18.801372 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3c1329b-5794-4768-9efa-9a4e01a57941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D13C2D6A0>]}
[0m00:39:18.801372 [info ] [Thread-1 (]: 3 of 11 OK created sql view model DEV.src_links ................................ [[32mSUCCESS 1[0m in 0.43s]
[0m00:39:18.801372 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.src_links
[0m00:39:18.801372 [debug] [Thread-1 (]: Began running node model.Slip_Tests.src_movies
[0m00:39:18.801372 [info ] [Thread-1 (]: 4 of 11 START sql view model DEV.src_movies .................................... [RUN]
[0m00:39:18.801372 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Slip_Tests.src_links, now model.Slip_Tests.src_movies)
[0m00:39:18.801372 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.src_movies
[0m00:39:18.801372 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.src_movies"
[0m00:39:18.801372 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.src_movies
[0m00:39:18.817689 [debug] [Thread-1 (]: Writing runtime sql for node "model.Slip_Tests.src_movies"
[0m00:39:18.819697 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.src_movies"
[0m00:39:18.819697 [debug] [Thread-1 (]: On model.Slip_Tests.src_movies: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.src_movies"} */
create or replace   view MOVIELENS.DEV.src_movies
  
   as (
    WITH raw_movies AS (
   SELECT * FROM MOVIELENS.RAW.RAW_MOVIES
)
SELECT
    movieId As movie_id,
    title,
    genres
FROM raw_movies
  );
[0m00:39:19.189102 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.383 seconds
[0m00:39:19.204796 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3c1329b-5794-4768-9efa-9a4e01a57941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D13CF72F0>]}
[0m00:39:19.204796 [info ] [Thread-1 (]: 4 of 11 OK created sql view model DEV.src_movies ............................... [[32mSUCCESS 1[0m in 0.40s]
[0m00:39:19.204796 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.src_movies
[0m00:39:19.204796 [debug] [Thread-1 (]: Began running node model.Slip_Tests.src_ratings
[0m00:39:19.204796 [info ] [Thread-1 (]: 5 of 11 START sql table model DEV.src_ratings .................................. [RUN]
[0m00:39:19.204796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Slip_Tests.src_movies, now model.Slip_Tests.src_ratings)
[0m00:39:19.204796 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.src_ratings
[0m00:39:19.204796 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.src_ratings"
[0m00:39:19.204796 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.src_ratings
[0m00:39:19.237495 [debug] [Thread-1 (]: Writing runtime sql for node "model.Slip_Tests.src_ratings"
[0m00:39:19.238541 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.src_ratings"
[0m00:39:19.238541 [debug] [Thread-1 (]: On model.Slip_Tests.src_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.src_ratings"} */
create or replace transient table MOVIELENS.DEV.src_ratings
    

    
    as (

WITH raw_ratings AS (

    SELECT * FROM MOVIELENS.RAW.RAW_RATINGS
)

SELECT
    userId AS user_id,
    movieId AS movie_id,
    rating,
    TO_TIMESTAMP_LTZ(timestamp) AS rating_timestamp
FROM raw_ratings
    )
;
[0m00:39:24.613921 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 5.372 seconds
[0m00:39:24.613921 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3c1329b-5794-4768-9efa-9a4e01a57941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D13C19040>]}
[0m00:39:24.613921 [info ] [Thread-1 (]: 5 of 11 OK created sql table model DEV.src_ratings ............................. [[32mSUCCESS 1[0m in 5.41s]
[0m00:39:24.613921 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.src_ratings
[0m00:39:24.613921 [debug] [Thread-1 (]: Began running node model.Slip_Tests.src_tags
[0m00:39:24.613921 [info ] [Thread-1 (]: 6 of 11 START sql table model DEV.src_tags ..................................... [RUN]
[0m00:39:24.613921 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Slip_Tests.src_ratings, now model.Slip_Tests.src_tags)
[0m00:39:24.613921 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.src_tags
[0m00:39:24.613921 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.src_tags"
[0m00:39:24.613921 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.src_tags
[0m00:39:24.613921 [debug] [Thread-1 (]: Writing runtime sql for node "model.Slip_Tests.src_tags"
[0m00:39:24.613921 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.src_tags"
[0m00:39:24.613921 [debug] [Thread-1 (]: On model.Slip_Tests.src_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.src_tags"} */
create or replace transient table MOVIELENS.DEV.src_tags
    

    
    as (

WITH raw_tags AS (
    SELECT * FROM MOVIELENS.RAW.RAW_TAGS
)
SELECT
    userId AS user_id,
    movieId AS movie_id,
    tag,
    TO_TIMESTAMP_LTZ(timestamp) AS tag_timestamp
FROM raw_tags
    )
;
[0m00:39:26.148827 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.535 seconds
[0m00:39:26.164436 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3c1329b-5794-4768-9efa-9a4e01a57941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D13CD7800>]}
[0m00:39:26.164436 [info ] [Thread-1 (]: 6 of 11 OK created sql table model DEV.src_tags ................................ [[32mSUCCESS 1[0m in 1.55s]
[0m00:39:26.164436 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.src_tags
[0m00:39:26.164436 [debug] [Thread-1 (]: Began running node model.Slip_Tests.fct_genome_score
[0m00:39:26.164436 [info ] [Thread-1 (]: 7 of 11 START sql table model DEV.fct_genome_score ............................. [RUN]
[0m00:39:26.164436 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Slip_Tests.src_tags, now model.Slip_Tests.fct_genome_score)
[0m00:39:26.164436 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.fct_genome_score
[0m00:39:26.170951 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.fct_genome_score"
[0m00:39:26.170951 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.fct_genome_score
[0m00:39:26.170951 [debug] [Thread-1 (]: Writing runtime sql for node "model.Slip_Tests.fct_genome_score"
[0m00:39:26.170951 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_genome_score"
[0m00:39:26.170951 [debug] [Thread-1 (]: On model.Slip_Tests.fct_genome_score: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_genome_score"} */
create or replace transient table MOVIELENS.DEV.fct_genome_score
    

    
    as (WITH src_scores AS (
    SELECT * FROM MOVIELENS.DEV.src_genome_score
)

SELECT
    movie_id,
    tag_id,
    ROUND(relevance, 4) AS relevance_score
FROM src_scores
WHERE relevance > 0
    )
;
[0m00:39:28.764800 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.590 seconds
[0m00:39:28.764800 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3c1329b-5794-4768-9efa-9a4e01a57941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D13D36870>]}
[0m00:39:28.764800 [info ] [Thread-1 (]: 7 of 11 OK created sql table model DEV.fct_genome_score ........................ [[32mSUCCESS 1[0m in 2.60s]
[0m00:39:28.764800 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.fct_genome_score
[0m00:39:28.764800 [debug] [Thread-1 (]: Began running node model.Slip_Tests.dim_genome_tags
[0m00:39:28.764800 [info ] [Thread-1 (]: 8 of 11 START sql table model DEV.dim_genome_tags .............................. [RUN]
[0m00:39:28.764800 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Slip_Tests.fct_genome_score, now model.Slip_Tests.dim_genome_tags)
[0m00:39:28.764800 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.dim_genome_tags
[0m00:39:28.774356 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.dim_genome_tags"
[0m00:39:28.774356 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.dim_genome_tags
[0m00:39:28.774356 [debug] [Thread-1 (]: Writing runtime sql for node "model.Slip_Tests.dim_genome_tags"
[0m00:39:28.774356 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.dim_genome_tags"
[0m00:39:28.774356 [debug] [Thread-1 (]: On model.Slip_Tests.dim_genome_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.dim_genome_tags"} */
create or replace transient table MOVIELENS.DEV.dim_genome_tags
    

    
    as (WITH src_tags AS (
    SELECT * FROM MOVIELENS.DEV.src_genome_tags
)

SELECT
    tag_id,
    INITCAP(TRIM(tag)) AS tag_name
FROM src_tags
    )
;
[0m00:39:29.799969 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.034 seconds
[0m00:39:29.815592 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3c1329b-5794-4768-9efa-9a4e01a57941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D13CE4230>]}
[0m00:39:29.815592 [info ] [Thread-1 (]: 8 of 11 OK created sql table model DEV.dim_genome_tags ......................... [[32mSUCCESS 1[0m in 1.05s]
[0m00:39:29.815592 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.dim_genome_tags
[0m00:39:29.815592 [debug] [Thread-1 (]: Began running node model.Slip_Tests.dim_movies
[0m00:39:29.815592 [info ] [Thread-1 (]: 9 of 11 START sql table model DEV.dim_movies ................................... [RUN]
[0m00:39:29.815592 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Slip_Tests.dim_genome_tags, now model.Slip_Tests.dim_movies)
[0m00:39:29.815592 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.dim_movies
[0m00:39:29.815592 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.dim_movies"
[0m00:39:29.815592 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.dim_movies
[0m00:39:29.815592 [debug] [Thread-1 (]: Writing runtime sql for node "model.Slip_Tests.dim_movies"
[0m00:39:29.815592 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.dim_movies"
[0m00:39:29.815592 [debug] [Thread-1 (]: On model.Slip_Tests.dim_movies: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.dim_movies"} */
create or replace transient table MOVIELENS.DEV.dim_movies
    

    
    as (WITH src_movies AS (
    SELECT * FROM MOVIELENS.DEV.src_movies
)

SELECT
    movie_id,
    INITCAP(TRIM(title)) AS movie_title,
    SPLIT(genres, '|') AS genre_array,
FROM src_movies
    )
;
[0m00:39:31.085090 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.268 seconds
[0m00:39:31.100770 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3c1329b-5794-4768-9efa-9a4e01a57941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D13D6F2C0>]}
[0m00:39:31.100770 [info ] [Thread-1 (]: 9 of 11 OK created sql table model DEV.dim_movies .............................. [[32mSUCCESS 1[0m in 1.29s]
[0m00:39:31.100770 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.dim_movies
[0m00:39:31.100770 [debug] [Thread-1 (]: Began running node model.Slip_Tests.fct_ratings
[0m00:39:31.100770 [info ] [Thread-1 (]: 10 of 11 START sql incremental model DEV.fct_ratings ........................... [RUN]
[0m00:39:31.100770 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Slip_Tests.dim_movies, now model.Slip_Tests.fct_ratings)
[0m00:39:31.100770 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.fct_ratings
[0m00:39:31.170824 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.fct_ratings"
[0m00:39:31.171819 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.fct_ratings
[0m00:39:31.195827 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m00:39:31.195827 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
create or replace  temporary view MOVIELENS.DEV.fct_ratings__dbt_tmp
  
   as (
    

WITH src_ratings AS (
    SELECT * FROM MOVIELENS.DEV.src_ratings
)

SELECT
    user_id,
    movie_id,
    rating,
    rating_timestamp
FROM src_ratings
WHERE rating IS NOT NULL

    AND rating_timestamp > (
        SELECT MAX(rating_timestamp) FROM MOVIELENS.DEV.fct_ratings
    )

  );
[0m00:39:31.619630 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.413 seconds
[0m00:39:31.619630 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m00:39:31.619630 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
describe table MOVIELENS.DEV.fct_ratings__dbt_tmp
[0m00:39:31.837294 [debug] [Thread-1 (]: SQL status: SUCCESS 4 in 0.207 seconds
[0m00:39:31.837294 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m00:39:31.837294 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
describe table MOVIELENS.DEV.fct_ratings
[0m00:39:32.041359 [debug] [Thread-1 (]: SQL status: SUCCESS 4 in 0.209 seconds
[0m00:39:32.057526 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m00:39:32.057526 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
describe table MOVIELENS.DEV.fct_ratings__dbt_tmp
[0m00:39:32.279651 [debug] [Thread-1 (]: SQL status: SUCCESS 4 in 0.223 seconds
[0m00:39:32.291232 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m00:39:32.291232 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
describe table "MOVIELENS"."DEV"."FCT_RATINGS"
[0m00:39:32.503572 [debug] [Thread-1 (]: SQL status: SUCCESS 4 in 0.210 seconds
[0m00:39:32.512463 [debug] [Thread-1 (]: 
    In "MOVIELENS"."DEV"."FCT_RATINGS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m00:39:32.526016 [debug] [Thread-1 (]: Writing runtime sql for node "model.Slip_Tests.fct_ratings"
[0m00:39:32.526016 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m00:39:32.526016 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
-- back compat for old kwarg name
  
  begin;
[0m00:39:32.777092 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.244 seconds
[0m00:39:32.777092 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m00:39:32.777092 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
insert into MOVIELENS.DEV.fct_ratings ("USER_ID", "MOVIE_ID", "RATING", "RATING_TIMESTAMP")
        (
            select "USER_ID", "MOVIE_ID", "RATING", "RATING_TIMESTAMP"
            from MOVIELENS.DEV.fct_ratings__dbt_tmp
        );
[0m00:39:33.985177 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.215 seconds
[0m00:39:33.985177 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m00:39:33.985177 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
COMMIT
[0m00:39:34.314818 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.330 seconds
[0m00:39:34.331436 [debug] [Thread-1 (]: Applying DROP to: MOVIELENS.DEV.fct_ratings__dbt_tmp
[0m00:39:34.331436 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m00:39:34.331436 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
drop view if exists MOVIELENS.DEV.fct_ratings__dbt_tmp cascade
[0m00:39:34.583903 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.243 seconds
[0m00:39:34.583903 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3c1329b-5794-4768-9efa-9a4e01a57941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D133CF980>]}
[0m00:39:34.583903 [info ] [Thread-1 (]: 10 of 11 OK created sql incremental model DEV.fct_ratings ...................... [[32mSUCCESS 0[0m in 3.48s]
[0m00:39:34.583903 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.fct_ratings
[0m00:39:34.583903 [debug] [Thread-1 (]: Began running node model.Slip_Tests.dim_user
[0m00:39:34.583903 [info ] [Thread-1 (]: 11 of 11 START sql table model DEV.dim_user .................................... [RUN]
[0m00:39:34.583903 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Slip_Tests.fct_ratings, now model.Slip_Tests.dim_user)
[0m00:39:34.583903 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.dim_user
[0m00:39:34.583903 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.dim_user"
[0m00:39:34.596455 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.dim_user
[0m00:39:34.600262 [debug] [Thread-1 (]: Writing runtime sql for node "model.Slip_Tests.dim_user"
[0m00:39:34.601934 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.dim_user"
[0m00:39:34.601934 [debug] [Thread-1 (]: On model.Slip_Tests.dim_user: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.dim_user"} */
create or replace transient table MOVIELENS.DEV.dim_user
    

    
    as (WITH ratings AS (
    SELECT DISTINCT user_id FROM MOVIELENS.DEV.src_ratings
),

tags AS (
    SELECT DISTINCT user_id FROM MOVIELENS.DEV.src_tags
)

SELECT DISTINCT user_id
FROM (
    SELECT * FROM ratings
    UNION
    SELECT * FROM tags
)
    )
;
[0m00:39:35.551905 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.954 seconds
[0m00:39:35.551905 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3c1329b-5794-4768-9efa-9a4e01a57941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D1331A840>]}
[0m00:39:35.551905 [info ] [Thread-1 (]: 11 of 11 OK created sql table model DEV.dim_user ............................... [[32mSUCCESS 1[0m in 0.97s]
[0m00:39:35.551905 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.dim_user
[0m00:39:35.551905 [debug] [Thread-1 (]: Began running node model.Slip_Tests.dim_movies_with_tags
[0m00:39:35.551905 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Slip_Tests.dim_user, now model.Slip_Tests.dim_movies_with_tags)
[0m00:39:35.551905 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.dim_movies_with_tags
[0m00:39:35.551905 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.dim_movies_with_tags"
[0m00:39:35.569146 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.dim_movies_with_tags
[0m00:39:35.570392 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:39:35.571452 [debug] [MainThread]: Connection 'list_MOVIELENS' was left open.
[0m00:39:35.572440 [debug] [MainThread]: On list_MOVIELENS: Close
[0m00:39:35.942969 [debug] [MainThread]: Connection 'list_MOVIELENS_DEV' was left open.
[0m00:39:35.942969 [debug] [MainThread]: On list_MOVIELENS_DEV: Close
[0m00:39:36.303079 [debug] [MainThread]: Connection 'model.Slip_Tests.dim_movies_with_tags' was left open.
[0m00:39:36.303079 [debug] [MainThread]: On model.Slip_Tests.dim_movies_with_tags: Close
[0m00:39:36.688022 [info ] [MainThread]: 
[0m00:39:36.688022 [info ] [MainThread]: Finished running 1 incremental model, 6 table models, 4 view models in 0 hours 0 minutes and 24.29 seconds (24.29s).
[0m00:39:36.688022 [debug] [MainThread]: Command end result
[0m00:39:36.696902 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m00:39:36.713103 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m00:39:36.729030 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\dbt_workspace\Slip_Tests\target\run_results.json
[0m00:39:36.729030 [info ] [MainThread]: 
[0m00:39:36.731024 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:39:36.731024 [info ] [MainThread]: 
[0m00:39:36.732077 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=11
[0m00:39:36.733214 [debug] [MainThread]: Command `dbt run` succeeded at 00:39:36.733214 after 27.81 seconds
[0m00:39:36.733214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D0E964860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D10394980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D10638F80>]}
[0m00:39:36.734762 [debug] [MainThread]: Flushing usage events
[0m00:39:37.871768 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:58:17.735047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024118D99880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024118D99820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024118D9A930>]}


============================== 00:58:17.742061 | 0a5c6290-5977-4deb-8253-82b1c4cc763c ==============================
[0m00:58:17.742061 [info ] [MainThread]: Running with dbt=1.10.1
[0m00:58:17.742061 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\ThembaniFaleni\\.dbt', 'log_path': 'c:\\dbt_workspace\\Slip_Tests\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:58:18.030740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a5c6290-5977-4deb-8253-82b1c4cc763c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241191C7EF0>]}
[0m00:58:18.075601 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m00:58:18.077600 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m00:58:18.079633 [debug] [MainThread]: Command `cli deps` succeeded at 00:58:18.078626 after 0.61 seconds
[0m00:58:18.080597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024118D99910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002411876D640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002411876F440>]}
[0m00:58:18.081105 [debug] [MainThread]: Flushing usage events
[0m00:58:19.296747 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:58:26.110000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002486F281CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024870EB9940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002486F19E9F0>]}


============================== 00:58:26.121857 | 8daf6ac9-6b08-402b-88e5-d77effa652d4 ==============================
[0m00:58:26.121857 [info ] [MainThread]: Running with dbt=1.10.1
[0m00:58:26.121857 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'c:\\dbt_workspace\\Slip_Tests\\logs', 'profiles_dir': 'C:\\Users\\ThembaniFaleni\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m00:58:26.328713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F384259D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F384258050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F38648FFB0>]}


============================== 00:58:26.328713 | a9e89997-91d0-41af-87a9-777070cb9a85 ==============================
[0m00:58:26.328713 [info ] [MainThread]: Running with dbt=1.10.1
[0m00:58:26.344396 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\ThembaniFaleni\\.dbt', 'log_path': 'c:\\dbt_workspace\\Slip_Tests\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:58:26.352339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E045D767B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E045933290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E045FE3B00>]}
[0m00:58:26.354332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E95FF39EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E95F7D9F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E95F7DB9E0>]}


============================== 00:58:26.364722 | 100ba95b-0487-4c93-a8a7-5f0f4383e4b2 ==============================
[0m00:58:26.364722 [info ] [MainThread]: Running with dbt=1.10.1
[0m00:58:26.366739 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'c:\\dbt_workspace\\Slip_Tests\\logs', 'profiles_dir': 'C:\\Users\\ThembaniFaleni\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:58:26.366739 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'c:\\dbt_workspace\\Slip_Tests\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\ThembaniFaleni\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:58:26.457213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8F5B6F830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8F5B6D220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8F5B6EB70>]}


============================== 00:58:26.473259 | e97f20a1-d89c-46b5-86a6-250873f538e9 ==============================
[0m00:58:26.473259 [info ] [MainThread]: Running with dbt=1.10.1
[0m00:58:26.473259 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ThembaniFaleni\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'c:\\dbt_workspace\\Slip_Tests\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:58:26.473259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002651CAC3290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002651EB3CAA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002651EB3D2B0>]}


============================== 00:58:26.473259 | 20e41695-a037-49ef-b224-fbace11ee666 ==============================
[0m00:58:26.473259 [info ] [MainThread]: Running with dbt=1.10.1
[0m00:58:26.473259 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'c:\\dbt_workspace\\Slip_Tests\\logs', 'profiles_dir': 'C:\\Users\\ThembaniFaleni\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:58:26.535543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E32A1AC3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3278EDF40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E32A539C70>]}


============================== 00:58:26.549231 | ab9358b6-7725-44ec-89c0-38b1cfe4117a ==============================
[0m00:58:26.549231 [info ] [MainThread]: Running with dbt=1.10.1
[0m00:58:26.551247 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\ThembaniFaleni\\.dbt', 'log_path': 'c:\\dbt_workspace\\Slip_Tests\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:58:26.646720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8daf6ac9-6b08-402b-88e5-d77effa652d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024871A439B0>]}
[0m00:58:26.719048 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m00:58:26.730211 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m00:58:26.733468 [debug] [MainThread]: Command `cli deps` succeeded at 00:58:26.733468 after 1.16 seconds
[0m00:58:26.735800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024871EF8B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002486BFF6210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024871DB2E70>]}
[0m00:58:26.738194 [debug] [MainThread]: Flushing usage events
[0m00:58:26.879489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9e89997-91d0-41af-87a9-777070cb9a85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F38617BFE0>]}
[0m00:58:26.914951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b3110744-347a-41a8-a1c1-7334b39bee3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E96001F4D0>]}
[0m00:58:26.918105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '100ba95b-0487-4c93-a8a7-5f0f4383e4b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E04624A3F0>]}
[0m00:58:26.946574 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m00:58:26.949571 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m00:58:26.953615 [debug] [MainThread]: Command `cli deps` succeeded at 00:58:26.953615 after 1.11 seconds
[0m00:58:26.954467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F38776E270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F3866CB140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F3866CB3E0>]}
[0m00:58:26.954467 [debug] [MainThread]: Flushing usage events
[0m00:58:26.987007 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m00:58:26.987007 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m00:58:26.990462 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m00:58:26.993213 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m00:58:26.993590 [debug] [MainThread]: Command `cli deps` succeeded at 00:58:26.993590 after 1.15 seconds
[0m00:58:26.995642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E04655AA20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E04661AC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E045EFA1E0>]}
[0m00:58:26.997150 [debug] [MainThread]: Command `cli deps` succeeded at 00:58:26.996149 after 1.12 seconds
[0m00:58:26.997150 [debug] [MainThread]: Flushing usage events
[0m00:58:26.998150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E95FD582F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E95F8EE7E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E959BFB080>]}
[0m00:58:26.999125 [debug] [MainThread]: Flushing usage events
[0m00:58:27.032309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e97f20a1-d89c-46b5-86a6-250873f538e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8F66437D0>]}
[0m00:58:27.043571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '20e41695-a037-49ef-b224-fbace11ee666', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002651F3F5430>]}
[0m00:58:27.083040 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m00:58:27.086028 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m00:58:27.088028 [debug] [MainThread]: Command `cli deps` succeeded at 00:58:27.088028 after 1.00 seconds
[0m00:58:27.088028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8F52DAD20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8F5B0C7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8F358EC90>]}
[0m00:58:27.089029 [debug] [MainThread]: Flushing usage events
[0m00:58:27.092041 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m00:58:27.094479 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m00:58:27.095456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ab9358b6-7725-44ec-89c0-38b1cfe4117a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3279F6DB0>]}
[0m00:58:27.097460 [debug] [MainThread]: Command `cli deps` succeeded at 00:58:27.097460 after 1.00 seconds
[0m00:58:27.098455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002651F36A0C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002651FB8B3E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002651EACD6A0>]}
[0m00:58:27.098455 [debug] [MainThread]: Flushing usage events
[0m00:58:27.134925 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m00:58:27.135722 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m00:58:27.135722 [debug] [MainThread]: Command `cli deps` succeeded at 00:58:27.135722 after 0.99 seconds
[0m00:58:27.135722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3277FEBA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3278EDF40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3284EAC90>]}
[0m00:58:27.135722 [debug] [MainThread]: Flushing usage events
[0m00:58:27.661881 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:58:27.916110 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:58:27.928123 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:58:27.961167 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:58:28.031608 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:58:28.031608 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:58:28.093663 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:00:43.813190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023576719130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023574164680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023574164620>]}


============================== 01:00:43.813190 | db5086c2-31b6-429e-8904-e382ae2e67f6 ==============================
[0m01:00:43.813190 [info ] [MainThread]: Running with dbt=1.10.1
[0m01:00:43.813190 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\dbt_workspace\\Slip_Tests\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\ThembaniFaleni\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:00:44.470632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db5086c2-31b6-429e-8904-e382ae2e67f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023578DE3770>]}
[0m01:00:44.623626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'db5086c2-31b6-429e-8904-e382ae2e67f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023578CC77A0>]}
[0m01:00:44.624862 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m01:00:44.819077 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m01:00:44.941956 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:00:44.941956 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:00:44.987894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'db5086c2-31b6-429e-8904-e382ae2e67f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023576B84080>]}
[0m01:00:45.051067 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m01:00:45.051067 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m01:00:45.129316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'db5086c2-31b6-429e-8904-e382ae2e67f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023579034C20>]}
[0m01:00:45.129316 [info ] [MainThread]: Found 12 models, 1 snapshot, 476 macros
[0m01:00:45.141866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db5086c2-31b6-429e-8904-e382ae2e67f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023575BE07A0>]}
[0m01:00:45.141866 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m01:00:45.146941 [debug] [MainThread]: Command end result
[0m01:00:45.161559 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m01:00:45.161559 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m01:00:45.161559 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\dbt_workspace\Slip_Tests\target\run_results.json
[0m01:00:45.161559 [debug] [MainThread]: Command `dbt test` succeeded at 01:00:45.161559 after 1.58 seconds
[0m01:00:45.161559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002357689DC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235745D53D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235745D7530>]}
[0m01:00:45.161559 [debug] [MainThread]: Flushing usage events
[0m01:00:46.289299 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:02:52.014404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F6759E600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F6489A0F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F65B44F20>]}


============================== 01:02:52.014404 | ecc14814-fa6b-4e5f-ab99-5fb842fbfea2 ==============================
[0m01:02:52.014404 [info ] [MainThread]: Running with dbt=1.10.1
[0m01:02:52.014404 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\ThembaniFaleni\\.dbt', 'log_path': 'C:\\dbt_workspace\\Slip_Tests\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m01:02:52.719573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ecc14814-fa6b-4e5f-ab99-5fb842fbfea2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F6A09A450>]}
[0m01:02:52.861348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ecc14814-fa6b-4e5f-ab99-5fb842fbfea2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F69C483E0>]}
[0m01:02:52.861348 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m01:02:53.039041 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m01:02:53.196720 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:02:53.196720 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:02:53.261802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ecc14814-fa6b-4e5f-ab99-5fb842fbfea2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F6A4471A0>]}
[0m01:02:53.359800 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m01:02:53.361909 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m01:02:53.438121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ecc14814-fa6b-4e5f-ab99-5fb842fbfea2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F6A7FFBF0>]}
[0m01:02:53.438121 [info ] [MainThread]: Found 12 models, 1 snapshot, 12 data tests, 6 sources, 476 macros
[0m01:02:53.438121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecc14814-fa6b-4e5f-ab99-5fb842fbfea2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F69FCD2B0>]}
[0m01:02:53.438121 [info ] [MainThread]: 
[0m01:02:53.438121 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:02:53.438121 [info ] [MainThread]: 
[0m01:02:53.453744 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:02:53.453744 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MOVIELENS_snapshots'
[0m01:02:53.532599 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m01:02:53.533601 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
alter session set quoted_identifiers_ignore_case = false;
[0m01:02:53.533601 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:02:55.602246 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 2.082 seconds
[0m01:02:55.617723 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m01:02:55.617723 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
show objects in MOVIELENS.snapshots
    limit 10000
    
;
[0m01:02:55.900734 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.282 seconds
[0m01:02:55.900734 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m01:02:55.900734 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
alter session unset quoted_identifiers_ignore_case;
[0m01:02:56.135122 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.235 seconds
[0m01:02:56.135122 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MOVIELENS_snapshots, now list_MOVIELENS_DEV)
[0m01:02:56.135122 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m01:02:56.135122 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session set quoted_identifiers_ignore_case = false;
[0m01:02:56.402862 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.253 seconds
[0m01:02:56.402862 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m01:02:56.402862 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
show objects in MOVIELENS.DEV
    limit 10000
    
;
[0m01:02:56.670562 [debug] [ThreadPool]: SQL status: SUCCESS 16 in 0.269 seconds
[0m01:02:56.670562 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m01:02:56.670562 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session unset quoted_identifiers_ignore_case;
[0m01:02:56.903008 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.228 seconds
[0m01:02:56.903008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecc14814-fa6b-4e5f-ab99-5fb842fbfea2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F6A80AC30>]}
[0m01:02:56.918602 [debug] [Thread-1 (]: Began running node test.Slip_Tests.dbt_utils_equal_rowcount_fct_genome_score_ref_src_genome_score_.c5d70ca0d7
[0m01:02:56.918602 [info ] [Thread-1 (]: 1 of 12 START test dbt_utils_equal_rowcount_fct_genome_score_ref_src_genome_score_  [RUN]
[0m01:02:56.918602 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.Slip_Tests.dbt_utils_equal_rowcount_fct_genome_score_ref_src_genome_score_.c5d70ca0d7'
[0m01:02:56.918602 [debug] [Thread-1 (]: Began compiling node test.Slip_Tests.dbt_utils_equal_rowcount_fct_genome_score_ref_src_genome_score_.c5d70ca0d7
[0m01:02:56.950969 [debug] [Thread-1 (]: Compilation Error in test dbt_utils_equal_rowcount_fct_genome_score_ref_src_genome_score_ (models\staging\schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m01:02:56.951976 [error] [Thread-1 (]: 1 of 12 ERROR dbt_utils_equal_rowcount_fct_genome_score_ref_src_genome_score_ .. [[31mERROR[0m in 0.03s]
[0m01:02:56.952517 [debug] [Thread-1 (]: Finished running node test.Slip_Tests.dbt_utils_equal_rowcount_fct_genome_score_ref_src_genome_score_.c5d70ca0d7
[0m01:02:56.953534 [debug] [Thread-1 (]: Began running node test.Slip_Tests.dbt_utils_equal_rowcount_snap_tags_ref_src_tags_.78963607ce
[0m01:02:56.954316 [debug] [Thread-4 (]: Marking all children of 'test.Slip_Tests.dbt_utils_equal_rowcount_fct_genome_score_ref_src_genome_score_.c5d70ca0d7' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_utils_equal_rowcount_fct_genome_score_ref_src_genome_score_ (models\staging\schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m01:02:56.954667 [info ] [Thread-1 (]: 2 of 12 START test dbt_utils_equal_rowcount_snap_tags_ref_src_tags_ ............ [RUN]
[0m01:02:56.959162 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Slip_Tests.dbt_utils_equal_rowcount_fct_genome_score_ref_src_genome_score_.c5d70ca0d7, now test.Slip_Tests.dbt_utils_equal_rowcount_snap_tags_ref_src_tags_.78963607ce)
[0m01:02:56.959162 [debug] [Thread-1 (]: Began compiling node test.Slip_Tests.dbt_utils_equal_rowcount_snap_tags_ref_src_tags_.78963607ce
[0m01:02:56.971675 [debug] [Thread-1 (]: Compilation Error in test dbt_utils_equal_rowcount_snap_tags_ref_src_tags_ (models\staging\schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m01:02:56.974684 [error] [Thread-1 (]: 2 of 12 ERROR dbt_utils_equal_rowcount_snap_tags_ref_src_tags_ ................. [[31mERROR[0m in 0.02s]
[0m01:02:56.974684 [debug] [Thread-1 (]: Finished running node test.Slip_Tests.dbt_utils_equal_rowcount_snap_tags_ref_src_tags_.78963607ce
[0m01:02:56.974684 [debug] [Thread-1 (]: Began running node test.Slip_Tests.not_null_dim_movies_movie_id.0f96ca970d
[0m01:02:56.976836 [debug] [Thread-4 (]: Marking all children of 'test.Slip_Tests.dbt_utils_equal_rowcount_snap_tags_ref_src_tags_.78963607ce' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_utils_equal_rowcount_snap_tags_ref_src_tags_ (models\staging\schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m01:02:56.976836 [info ] [Thread-1 (]: 3 of 12 START test not_null_dim_movies_movie_id ................................ [RUN]
[0m01:02:56.977846 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Slip_Tests.dbt_utils_equal_rowcount_snap_tags_ref_src_tags_.78963607ce, now test.Slip_Tests.not_null_dim_movies_movie_id.0f96ca970d)
[0m01:02:56.977846 [debug] [Thread-1 (]: Began compiling node test.Slip_Tests.not_null_dim_movies_movie_id.0f96ca970d
[0m01:02:56.988679 [debug] [Thread-1 (]: Writing injected SQL for node "test.Slip_Tests.not_null_dim_movies_movie_id.0f96ca970d"
[0m01:02:56.989631 [debug] [Thread-1 (]: Began executing node test.Slip_Tests.not_null_dim_movies_movie_id.0f96ca970d
[0m01:02:57.013392 [debug] [Thread-1 (]: Writing runtime sql for node "test.Slip_Tests.not_null_dim_movies_movie_id.0f96ca970d"
[0m01:02:57.013392 [debug] [Thread-1 (]: Using snowflake connection "test.Slip_Tests.not_null_dim_movies_movie_id.0f96ca970d"
[0m01:02:57.013392 [debug] [Thread-1 (]: On test.Slip_Tests.not_null_dim_movies_movie_id.0f96ca970d: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "test.Slip_Tests.not_null_dim_movies_movie_id.0f96ca970d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select movie_id
from MOVIELENS.DEV.dim_movies
where movie_id is null



  
  
      
    ) dbt_internal_test
[0m01:02:57.013392 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:02:58.673869 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.659 seconds
[0m01:02:58.673869 [info ] [Thread-1 (]: 3 of 12 PASS not_null_dim_movies_movie_id ...................................... [[32mPASS[0m in 1.70s]
[0m01:02:58.673869 [debug] [Thread-1 (]: Finished running node test.Slip_Tests.not_null_dim_movies_movie_id.0f96ca970d
[0m01:02:58.689546 [debug] [Thread-1 (]: Began running node test.Slip_Tests.not_null_dim_movies_movie_title.0206534c81
[0m01:02:58.689546 [info ] [Thread-1 (]: 4 of 12 START test not_null_dim_movies_movie_title ............................. [RUN]
[0m01:02:58.689546 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Slip_Tests.not_null_dim_movies_movie_id.0f96ca970d, now test.Slip_Tests.not_null_dim_movies_movie_title.0206534c81)
[0m01:02:58.689546 [debug] [Thread-1 (]: Began compiling node test.Slip_Tests.not_null_dim_movies_movie_title.0206534c81
[0m01:02:58.689546 [debug] [Thread-1 (]: Writing injected SQL for node "test.Slip_Tests.not_null_dim_movies_movie_title.0206534c81"
[0m01:02:58.689546 [debug] [Thread-1 (]: Began executing node test.Slip_Tests.not_null_dim_movies_movie_title.0206534c81
[0m01:02:58.689546 [debug] [Thread-1 (]: Writing runtime sql for node "test.Slip_Tests.not_null_dim_movies_movie_title.0206534c81"
[0m01:02:58.689546 [debug] [Thread-1 (]: Using snowflake connection "test.Slip_Tests.not_null_dim_movies_movie_title.0206534c81"
[0m01:02:58.689546 [debug] [Thread-1 (]: On test.Slip_Tests.not_null_dim_movies_movie_title.0206534c81: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "test.Slip_Tests.not_null_dim_movies_movie_title.0206534c81"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select movie_title
from MOVIELENS.DEV.dim_movies
where movie_title is null



  
  
      
    ) dbt_internal_test
[0m01:02:59.316467 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.630 seconds
[0m01:02:59.332054 [info ] [Thread-1 (]: 4 of 12 PASS not_null_dim_movies_movie_title ................................... [[32mPASS[0m in 0.64s]
[0m01:02:59.332054 [debug] [Thread-1 (]: Finished running node test.Slip_Tests.not_null_dim_movies_movie_title.0206534c81
[0m01:02:59.332054 [debug] [Thread-1 (]: Began running node test.Slip_Tests.not_null_fct_genome_score_movie_id.a06a45d2b3
[0m01:02:59.332054 [info ] [Thread-1 (]: 5 of 12 START test not_null_fct_genome_score_movie_id .......................... [RUN]
[0m01:02:59.332054 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Slip_Tests.not_null_dim_movies_movie_title.0206534c81, now test.Slip_Tests.not_null_fct_genome_score_movie_id.a06a45d2b3)
[0m01:02:59.332054 [debug] [Thread-1 (]: Began compiling node test.Slip_Tests.not_null_fct_genome_score_movie_id.a06a45d2b3
[0m01:02:59.332054 [debug] [Thread-1 (]: Writing injected SQL for node "test.Slip_Tests.not_null_fct_genome_score_movie_id.a06a45d2b3"
[0m01:02:59.348624 [debug] [Thread-1 (]: Began executing node test.Slip_Tests.not_null_fct_genome_score_movie_id.a06a45d2b3
[0m01:02:59.352224 [debug] [Thread-1 (]: Writing runtime sql for node "test.Slip_Tests.not_null_fct_genome_score_movie_id.a06a45d2b3"
[0m01:02:59.355286 [debug] [Thread-1 (]: Using snowflake connection "test.Slip_Tests.not_null_fct_genome_score_movie_id.a06a45d2b3"
[0m01:02:59.356371 [debug] [Thread-1 (]: On test.Slip_Tests.not_null_fct_genome_score_movie_id.a06a45d2b3: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "test.Slip_Tests.not_null_fct_genome_score_movie_id.a06a45d2b3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select movie_id
from MOVIELENS.DEV.fct_genome_score
where movie_id is null



  
  
      
    ) dbt_internal_test
[0m01:02:59.960211 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.603 seconds
[0m01:02:59.960211 [info ] [Thread-1 (]: 5 of 12 PASS not_null_fct_genome_score_movie_id ................................ [[32mPASS[0m in 0.63s]
[0m01:02:59.960211 [debug] [Thread-1 (]: Finished running node test.Slip_Tests.not_null_fct_genome_score_movie_id.a06a45d2b3
[0m01:02:59.960211 [debug] [Thread-1 (]: Began running node test.Slip_Tests.not_null_fct_genome_score_relevance_score.c1509905ec
[0m01:02:59.960211 [info ] [Thread-1 (]: 6 of 12 START test not_null_fct_genome_score_relevance_score ................... [RUN]
[0m01:02:59.960211 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Slip_Tests.not_null_fct_genome_score_movie_id.a06a45d2b3, now test.Slip_Tests.not_null_fct_genome_score_relevance_score.c1509905ec)
[0m01:02:59.960211 [debug] [Thread-1 (]: Began compiling node test.Slip_Tests.not_null_fct_genome_score_relevance_score.c1509905ec
[0m01:02:59.960211 [debug] [Thread-1 (]: Writing injected SQL for node "test.Slip_Tests.not_null_fct_genome_score_relevance_score.c1509905ec"
[0m01:02:59.960211 [debug] [Thread-1 (]: Began executing node test.Slip_Tests.not_null_fct_genome_score_relevance_score.c1509905ec
[0m01:02:59.960211 [debug] [Thread-1 (]: Writing runtime sql for node "test.Slip_Tests.not_null_fct_genome_score_relevance_score.c1509905ec"
[0m01:02:59.978513 [debug] [Thread-1 (]: Using snowflake connection "test.Slip_Tests.not_null_fct_genome_score_relevance_score.c1509905ec"
[0m01:02:59.979599 [debug] [Thread-1 (]: On test.Slip_Tests.not_null_fct_genome_score_relevance_score.c1509905ec: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "test.Slip_Tests.not_null_fct_genome_score_relevance_score.c1509905ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select relevance_score
from MOVIELENS.DEV.fct_genome_score
where relevance_score is null



  
  
      
    ) dbt_internal_test
[0m01:03:00.429593 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.453 seconds
[0m01:03:00.429593 [info ] [Thread-1 (]: 6 of 12 PASS not_null_fct_genome_score_relevance_score ......................... [[32mPASS[0m in 0.47s]
[0m01:03:00.429593 [debug] [Thread-1 (]: Finished running node test.Slip_Tests.not_null_fct_genome_score_relevance_score.c1509905ec
[0m01:03:00.429593 [debug] [Thread-1 (]: Began running node test.Slip_Tests.not_null_fct_genome_score_tag_id.5d40275b2b
[0m01:03:00.429593 [info ] [Thread-1 (]: 7 of 12 START test not_null_fct_genome_score_tag_id ............................ [RUN]
[0m01:03:00.429593 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Slip_Tests.not_null_fct_genome_score_relevance_score.c1509905ec, now test.Slip_Tests.not_null_fct_genome_score_tag_id.5d40275b2b)
[0m01:03:00.429593 [debug] [Thread-1 (]: Began compiling node test.Slip_Tests.not_null_fct_genome_score_tag_id.5d40275b2b
[0m01:03:00.442154 [debug] [Thread-1 (]: Writing injected SQL for node "test.Slip_Tests.not_null_fct_genome_score_tag_id.5d40275b2b"
[0m01:03:00.446022 [debug] [Thread-1 (]: Began executing node test.Slip_Tests.not_null_fct_genome_score_tag_id.5d40275b2b
[0m01:03:00.449771 [debug] [Thread-1 (]: Writing runtime sql for node "test.Slip_Tests.not_null_fct_genome_score_tag_id.5d40275b2b"
[0m01:03:00.451654 [debug] [Thread-1 (]: Using snowflake connection "test.Slip_Tests.not_null_fct_genome_score_tag_id.5d40275b2b"
[0m01:03:00.452420 [debug] [Thread-1 (]: On test.Slip_Tests.not_null_fct_genome_score_tag_id.5d40275b2b: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "test.Slip_Tests.not_null_fct_genome_score_tag_id.5d40275b2b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select tag_id
from MOVIELENS.DEV.fct_genome_score
where tag_id is null



  
  
      
    ) dbt_internal_test
[0m01:03:01.027472 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.587 seconds
[0m01:03:01.043274 [info ] [Thread-1 (]: 7 of 12 PASS not_null_fct_genome_score_tag_id .................................. [[32mPASS[0m in 0.61s]
[0m01:03:01.043274 [debug] [Thread-1 (]: Finished running node test.Slip_Tests.not_null_fct_genome_score_tag_id.5d40275b2b
[0m01:03:01.043274 [debug] [Thread-1 (]: Began running node test.Slip_Tests.not_null_snap_tags_id.015a2066c2
[0m01:03:01.043274 [info ] [Thread-1 (]: 8 of 12 START test not_null_snap_tags_id ....................................... [RUN]
[0m01:03:01.043274 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Slip_Tests.not_null_fct_genome_score_tag_id.5d40275b2b, now test.Slip_Tests.not_null_snap_tags_id.015a2066c2)
[0m01:03:01.043274 [debug] [Thread-1 (]: Began compiling node test.Slip_Tests.not_null_snap_tags_id.015a2066c2
[0m01:03:01.043274 [debug] [Thread-1 (]: Writing injected SQL for node "test.Slip_Tests.not_null_snap_tags_id.015a2066c2"
[0m01:03:01.057786 [debug] [Thread-1 (]: Began executing node test.Slip_Tests.not_null_snap_tags_id.015a2066c2
[0m01:03:01.062344 [debug] [Thread-1 (]: Writing runtime sql for node "test.Slip_Tests.not_null_snap_tags_id.015a2066c2"
[0m01:03:01.064024 [debug] [Thread-1 (]: Using snowflake connection "test.Slip_Tests.not_null_snap_tags_id.015a2066c2"
[0m01:03:01.065510 [debug] [Thread-1 (]: On test.Slip_Tests.not_null_snap_tags_id.015a2066c2: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "test.Slip_Tests.not_null_snap_tags_id.015a2066c2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from MOVIELENS.snapshots.snap_tags
where id is null



  
  
      
    ) dbt_internal_test
[0m01:03:01.385178 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.320 seconds
[0m01:03:01.385178 [info ] [Thread-1 (]: 8 of 12 PASS not_null_snap_tags_id ............................................. [[32mPASS[0m in 0.34s]
[0m01:03:01.385178 [debug] [Thread-1 (]: Finished running node test.Slip_Tests.not_null_snap_tags_id.015a2066c2
[0m01:03:01.385178 [debug] [Thread-1 (]: Began running node test.Slip_Tests.not_null_snap_tags_movie_id.fb9962de5f
[0m01:03:01.385178 [info ] [Thread-1 (]: 9 of 12 START test not_null_snap_tags_movie_id ................................. [RUN]
[0m01:03:01.385178 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Slip_Tests.not_null_snap_tags_id.015a2066c2, now test.Slip_Tests.not_null_snap_tags_movie_id.fb9962de5f)
[0m01:03:01.385178 [debug] [Thread-1 (]: Began compiling node test.Slip_Tests.not_null_snap_tags_movie_id.fb9962de5f
[0m01:03:01.385178 [debug] [Thread-1 (]: Writing injected SQL for node "test.Slip_Tests.not_null_snap_tags_movie_id.fb9962de5f"
[0m01:03:01.385178 [debug] [Thread-1 (]: Began executing node test.Slip_Tests.not_null_snap_tags_movie_id.fb9962de5f
[0m01:03:01.400823 [debug] [Thread-1 (]: Writing runtime sql for node "test.Slip_Tests.not_null_snap_tags_movie_id.fb9962de5f"
[0m01:03:01.402517 [debug] [Thread-1 (]: Using snowflake connection "test.Slip_Tests.not_null_snap_tags_movie_id.fb9962de5f"
[0m01:03:01.403483 [debug] [Thread-1 (]: On test.Slip_Tests.not_null_snap_tags_movie_id.fb9962de5f: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "test.Slip_Tests.not_null_snap_tags_movie_id.fb9962de5f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select movie_id
from MOVIELENS.snapshots.snap_tags
where movie_id is null



  
  
      
    ) dbt_internal_test
[0m01:03:01.934412 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.537 seconds
[0m01:03:01.934412 [info ] [Thread-1 (]: 9 of 12 PASS not_null_snap_tags_movie_id ....................................... [[32mPASS[0m in 0.55s]
[0m01:03:01.934412 [debug] [Thread-1 (]: Finished running node test.Slip_Tests.not_null_snap_tags_movie_id.fb9962de5f
[0m01:03:01.934412 [debug] [Thread-1 (]: Began running node test.Slip_Tests.not_null_snap_tags_tag.b66ecb49f3
[0m01:03:01.934412 [info ] [Thread-1 (]: 10 of 12 START test not_null_snap_tags_tag ..................................... [RUN]
[0m01:03:01.934412 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Slip_Tests.not_null_snap_tags_movie_id.fb9962de5f, now test.Slip_Tests.not_null_snap_tags_tag.b66ecb49f3)
[0m01:03:01.934412 [debug] [Thread-1 (]: Began compiling node test.Slip_Tests.not_null_snap_tags_tag.b66ecb49f3
[0m01:03:01.955035 [debug] [Thread-1 (]: Writing injected SQL for node "test.Slip_Tests.not_null_snap_tags_tag.b66ecb49f3"
[0m01:03:01.956216 [debug] [Thread-1 (]: Began executing node test.Slip_Tests.not_null_snap_tags_tag.b66ecb49f3
[0m01:03:01.957581 [debug] [Thread-1 (]: Writing runtime sql for node "test.Slip_Tests.not_null_snap_tags_tag.b66ecb49f3"
[0m01:03:01.957581 [debug] [Thread-1 (]: Using snowflake connection "test.Slip_Tests.not_null_snap_tags_tag.b66ecb49f3"
[0m01:03:01.957581 [debug] [Thread-1 (]: On test.Slip_Tests.not_null_snap_tags_tag.b66ecb49f3: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "test.Slip_Tests.not_null_snap_tags_tag.b66ecb49f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select tag
from MOVIELENS.snapshots.snap_tags
where tag is null



  
  
      
    ) dbt_internal_test
[0m01:03:02.307210 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.350 seconds
[0m01:03:02.307210 [info ] [Thread-1 (]: 10 of 12 PASS not_null_snap_tags_tag ........................................... [[32mPASS[0m in 0.37s]
[0m01:03:02.307210 [debug] [Thread-1 (]: Finished running node test.Slip_Tests.not_null_snap_tags_tag.b66ecb49f3
[0m01:03:02.307210 [debug] [Thread-1 (]: Began running node test.Slip_Tests.not_null_snap_tags_user_id.a9aef7cace
[0m01:03:02.307210 [info ] [Thread-1 (]: 11 of 12 START test not_null_snap_tags_user_id ................................. [RUN]
[0m01:03:02.307210 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Slip_Tests.not_null_snap_tags_tag.b66ecb49f3, now test.Slip_Tests.not_null_snap_tags_user_id.a9aef7cace)
[0m01:03:02.307210 [debug] [Thread-1 (]: Began compiling node test.Slip_Tests.not_null_snap_tags_user_id.a9aef7cace
[0m01:03:02.322815 [debug] [Thread-1 (]: Writing injected SQL for node "test.Slip_Tests.not_null_snap_tags_user_id.a9aef7cace"
[0m01:03:02.324418 [debug] [Thread-1 (]: Began executing node test.Slip_Tests.not_null_snap_tags_user_id.a9aef7cace
[0m01:03:02.327294 [debug] [Thread-1 (]: Writing runtime sql for node "test.Slip_Tests.not_null_snap_tags_user_id.a9aef7cace"
[0m01:03:02.327754 [debug] [Thread-1 (]: Using snowflake connection "test.Slip_Tests.not_null_snap_tags_user_id.a9aef7cace"
[0m01:03:02.328896 [debug] [Thread-1 (]: On test.Slip_Tests.not_null_snap_tags_user_id.a9aef7cace: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "test.Slip_Tests.not_null_snap_tags_user_id.a9aef7cace"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from MOVIELENS.snapshots.snap_tags
where user_id is null



  
  
      
    ) dbt_internal_test
[0m01:03:02.548315 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.227 seconds
[0m01:03:02.558619 [info ] [Thread-1 (]: 11 of 12 PASS not_null_snap_tags_user_id ....................................... [[32mPASS[0m in 0.25s]
[0m01:03:02.559446 [debug] [Thread-1 (]: Finished running node test.Slip_Tests.not_null_snap_tags_user_id.a9aef7cace
[0m01:03:02.560248 [debug] [Thread-1 (]: Began running node test.Slip_Tests.unique_snap_tags_id.4ac4f44417
[0m01:03:02.560718 [info ] [Thread-1 (]: 12 of 12 START test unique_snap_tags_id ........................................ [RUN]
[0m01:03:02.561948 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Slip_Tests.not_null_snap_tags_user_id.a9aef7cace, now test.Slip_Tests.unique_snap_tags_id.4ac4f44417)
[0m01:03:02.562046 [debug] [Thread-1 (]: Began compiling node test.Slip_Tests.unique_snap_tags_id.4ac4f44417
[0m01:03:02.570633 [debug] [Thread-1 (]: Writing injected SQL for node "test.Slip_Tests.unique_snap_tags_id.4ac4f44417"
[0m01:03:02.571811 [debug] [Thread-1 (]: Began executing node test.Slip_Tests.unique_snap_tags_id.4ac4f44417
[0m01:03:02.574267 [debug] [Thread-1 (]: Writing runtime sql for node "test.Slip_Tests.unique_snap_tags_id.4ac4f44417"
[0m01:03:02.575504 [debug] [Thread-1 (]: Using snowflake connection "test.Slip_Tests.unique_snap_tags_id.4ac4f44417"
[0m01:03:02.576016 [debug] [Thread-1 (]: On test.Slip_Tests.unique_snap_tags_id.4ac4f44417: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "test.Slip_Tests.unique_snap_tags_id.4ac4f44417"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from MOVIELENS.snapshots.snap_tags
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:03:03.562860 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.987 seconds
[0m01:03:03.562860 [error] [Thread-1 (]: 12 of 12 FAIL 25 unique_snap_tags_id ........................................... [[31mFAIL 25[0m in 1.00s]
[0m01:03:03.562860 [debug] [Thread-1 (]: Finished running node test.Slip_Tests.unique_snap_tags_id.4ac4f44417
[0m01:03:03.562860 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:03:03.562860 [debug] [MainThread]: Connection 'list_MOVIELENS_DEV' was left open.
[0m01:03:03.562860 [debug] [MainThread]: On list_MOVIELENS_DEV: Close
[0m01:03:04.131044 [debug] [MainThread]: Connection 'test.Slip_Tests.unique_snap_tags_id.4ac4f44417' was left open.
[0m01:03:04.131044 [debug] [MainThread]: On test.Slip_Tests.unique_snap_tags_id.4ac4f44417: Close
[0m01:03:04.504875 [info ] [MainThread]: 
[0m01:03:04.504875 [info ] [MainThread]: Finished running 12 data tests in 0 hours 0 minutes and 11.05 seconds (11.05s).
[0m01:03:04.504875 [debug] [MainThread]: Command end result
[0m01:03:04.533181 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m01:03:04.538579 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m01:03:04.555694 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\dbt_workspace\Slip_Tests\target\run_results.json
[0m01:03:04.555694 [info ] [MainThread]: 
[0m01:03:04.555694 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m01:03:04.555694 [info ] [MainThread]: 
[0m01:03:04.555694 [error] [MainThread]: [31mFailure in test dbt_utils_equal_rowcount_fct_genome_score_ref_src_genome_score_ (models\staging\schema.yml)[0m
[0m01:03:04.555694 [error] [MainThread]:   Compilation Error in test dbt_utils_equal_rowcount_fct_genome_score_ref_src_genome_score_ (models\staging\schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m01:03:04.555694 [info ] [MainThread]: 
[0m01:03:04.555694 [error] [MainThread]: [31mFailure in test dbt_utils_equal_rowcount_snap_tags_ref_src_tags_ (models\staging\schema.yml)[0m
[0m01:03:04.555694 [error] [MainThread]:   Compilation Error in test dbt_utils_equal_rowcount_snap_tags_ref_src_tags_ (models\staging\schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m01:03:04.555694 [info ] [MainThread]: 
[0m01:03:04.562974 [error] [MainThread]: [31mFailure in test unique_snap_tags_id (models\staging\schema.yml)[0m
[0m01:03:04.563762 [error] [MainThread]:   Got 25 results, configured to fail if != 0
[0m01:03:04.564593 [info ] [MainThread]: 
[0m01:03:04.565260 [info ] [MainThread]:   compiled code at target\compiled\Slip_Tests\models\staging\schema.yml\unique_snap_tags_id.sql
[0m01:03:04.565861 [info ] [MainThread]: 
[0m01:03:04.566872 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=12
[0m01:03:04.567651 [debug] [MainThread]: Command `dbt test` failed at 01:03:04.567651 after 12.78 seconds
[0m01:03:04.567651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F67A28FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F67FEF3E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F67FBB890>]}
[0m01:03:04.568754 [debug] [MainThread]: Flushing usage events
[0m01:03:05.664855 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:12:50.785060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCAE8B5370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCB13D9340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCB13DA750>]}


============================== 01:12:50.785060 | 6b1e138e-09b7-4395-b8dd-16c74bf2c1e9 ==============================
[0m01:12:50.785060 [info ] [MainThread]: Running with dbt=1.10.1
[0m01:12:50.785060 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\dbt_workspace\\Slip_Tests\\logs', 'profiles_dir': 'C:\\Users\\ThembaniFaleni\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:12:51.468403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b1e138e-09b7-4395-b8dd-16c74bf2c1e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCB322EA20>]}
[0m01:12:51.622223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b1e138e-09b7-4395-b8dd-16c74bf2c1e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCB34E14F0>]}
[0m01:12:51.622223 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m01:12:51.806664 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m01:12:51.963213 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:12:51.963213 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:12:52.026201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b1e138e-09b7-4395-b8dd-16c74bf2c1e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCB1598FE0>]}
[0m01:12:52.104605 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m01:12:52.122239 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m01:12:52.187968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b1e138e-09b7-4395-b8dd-16c74bf2c1e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCB3E05DC0>]}
[0m01:12:52.187968 [info ] [MainThread]: Found 12 models, 1 snapshot, 12 data tests, 6 sources, 476 macros
[0m01:12:52.187968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b1e138e-09b7-4395-b8dd-16c74bf2c1e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCB05110D0>]}
[0m01:12:52.195897 [info ] [MainThread]: 
[0m01:12:52.196636 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:12:52.197143 [info ] [MainThread]: 
[0m01:12:52.198150 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:12:52.199149 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MOVIELENS'
[0m01:12:52.263743 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS"
[0m01:12:52.264742 [debug] [ThreadPool]: On list_MOVIELENS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS"} */
show terse schemas in database MOVIELENS
    limit 10000
[0m01:12:52.264742 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:12:54.578344 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.323 seconds
[0m01:12:54.593898 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MOVIELENS_DEV'
[0m01:12:54.609574 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m01:12:54.609574 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session set quoted_identifiers_ignore_case = false;
[0m01:12:54.609574 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:12:55.620442 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.010 seconds
[0m01:12:55.624860 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m01:12:55.625368 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
show objects in MOVIELENS.DEV
    limit 10000
    
;
[0m01:12:55.863665 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.238 seconds
[0m01:12:55.865425 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m01:12:55.865929 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session unset quoted_identifiers_ignore_case;
[0m01:12:56.082837 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.218 seconds
[0m01:12:56.082837 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MOVIELENS_DEV, now list_MOVIELENS_snapshots)
[0m01:12:56.082837 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m01:12:56.082837 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
alter session set quoted_identifiers_ignore_case = false;
[0m01:12:56.303136 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.218 seconds
[0m01:12:56.303136 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m01:12:56.303136 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
show objects in MOVIELENS.snapshots
    limit 10000
    
;
[0m01:12:56.567189 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.262 seconds
[0m01:12:56.567189 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m01:12:56.567189 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
alter session unset quoted_identifiers_ignore_case;
[0m01:12:56.787306 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.212 seconds
[0m01:12:56.787306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b1e138e-09b7-4395-b8dd-16c74bf2c1e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCAEA679E0>]}
[0m01:12:56.787306 [debug] [Thread-1 (]: Began running node snapshot.Slip_Tests.snap_tags
[0m01:12:56.802914 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.snap_tags ...................................... [RUN]
[0m01:12:56.802914 [debug] [Thread-1 (]: Acquiring new snowflake connection 'snapshot.Slip_Tests.snap_tags'
[0m01:12:56.802914 [debug] [Thread-1 (]: Began compiling node snapshot.Slip_Tests.snap_tags
[0m01:12:56.819024 [debug] [Thread-1 (]: Compilation Error in snapshot snap_tags (snapshots\snap_tag.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m01:12:56.819024 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b1e138e-09b7-4395-b8dd-16c74bf2c1e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCB0CE1D90>]}
[0m01:12:56.819024 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshots.snap_tags .................................. [[31mERROR[0m in 0.02s]
[0m01:12:56.819024 [debug] [Thread-1 (]: Finished running node snapshot.Slip_Tests.snap_tags
[0m01:12:56.819024 [debug] [Thread-4 (]: Marking all children of 'snapshot.Slip_Tests.snap_tags' to be skipped because of status 'error'.  Reason: Compilation Error in snapshot snap_tags (snapshots\snap_tag.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m01:12:56.819024 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:12:56.819024 [debug] [MainThread]: Connection 'list_MOVIELENS' was left open.
[0m01:12:56.819024 [debug] [MainThread]: On list_MOVIELENS: Close
[0m01:12:57.180820 [debug] [MainThread]: Connection 'list_MOVIELENS_snapshots' was left open.
[0m01:12:57.180820 [debug] [MainThread]: On list_MOVIELENS_snapshots: Close
[0m01:12:57.555099 [debug] [MainThread]: Connection 'snapshot.Slip_Tests.snap_tags' was properly closed.
[0m01:12:57.555099 [info ] [MainThread]: 
[0m01:12:57.555099 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 5.36 seconds (5.36s).
[0m01:12:57.555099 [debug] [MainThread]: Command end result
[0m01:12:57.586315 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m01:12:57.586315 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m01:12:57.586315 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\dbt_workspace\Slip_Tests\target\run_results.json
[0m01:12:57.601829 [info ] [MainThread]: 
[0m01:12:57.603018 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:12:57.604030 [info ] [MainThread]: 
[0m01:12:57.604650 [error] [MainThread]: [31mFailure in snapshot snap_tags (snapshots\snap_tag.sql)[0m
[0m01:12:57.604650 [error] [MainThread]:   Compilation Error in snapshot snap_tags (snapshots\snap_tag.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m01:12:57.606337 [info ] [MainThread]: 
[0m01:12:57.607276 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m01:12:57.608523 [debug] [MainThread]: Command `dbt snapshot` failed at 01:12:57.608523 after 7.07 seconds
[0m01:12:57.608523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCB1261BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCB1803CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCB1803D70>]}
[0m01:12:57.608523 [debug] [MainThread]: Flushing usage events
[0m01:12:58.683619 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:16:35.075236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261E05A8CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261E2127950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261E3C22C30>]}


============================== 01:16:35.075236 | f9d82b65-7dde-4b65-a7c5-d1d3fe7ee90c ==============================
[0m01:16:35.075236 [info ] [MainThread]: Running with dbt=1.10.1
[0m01:16:35.075236 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ThembaniFaleni\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\dbt_workspace\\Slip_Tests\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m01:16:35.339883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f9d82b65-7dde-4b65-a7c5-d1d3fe7ee90c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261E39C0050>]}
[0m01:16:35.355505 [debug] [MainThread]: Set downloads directory='C:\Users\THEMBA~1\AppData\Local\Temp\dbt-downloads-pkdskppa'
[0m01:16:35.355505 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m01:16:36.208662 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m01:16:36.209280 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m01:16:36.891106 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m01:16:36.906724 [info ] [MainThread]: Updating lock file in file path: C:\dbt_workspace\Slip_Tests/package-lock.yml
[0m01:16:36.906724 [debug] [MainThread]: Set downloads directory='C:\Users\THEMBA~1\AppData\Local\Temp\dbt-downloads-b94moabp'
[0m01:16:36.906724 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m01:16:37.908343 [info ] [MainThread]: Installed from version 1.3.0
[0m01:16:37.908343 [info ] [MainThread]: Up to date!
[0m01:16:37.908343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f9d82b65-7dde-4b65-a7c5-d1d3fe7ee90c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261E577BD40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261E457F6B0>]}
[0m01:16:37.908343 [debug] [MainThread]: Command `dbt deps` succeeded at 01:16:37.908343 after 3.09 seconds
[0m01:16:37.914063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261E1EE6570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261E405F6E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261E405D2B0>]}
[0m01:16:37.914063 [debug] [MainThread]: Flushing usage events
[0m01:16:39.070004 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:16:47.643289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001680BBC9280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001680A0959D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001680A0971D0>]}


============================== 01:16:47.659772 | b053c98f-2a15-4d15-9b20-bbf46760a389 ==============================
[0m01:16:47.659772 [info ] [MainThread]: Running with dbt=1.10.1
[0m01:16:47.659772 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ThembaniFaleni\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\dbt_workspace\\Slip_Tests\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:16:48.317009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b053c98f-2a15-4d15-9b20-bbf46760a389', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001680BBC9130>]}
[0m01:16:48.472788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b053c98f-2a15-4d15-9b20-bbf46760a389', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001680DB69130>]}
[0m01:16:48.472788 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m01:16:48.654257 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m01:16:48.779752 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m01:16:48.779752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b053c98f-2a15-4d15-9b20-bbf46760a389', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001680C20CCB0>]}
[0m01:16:48.779752 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'tests' in "<unicode string>", line 71, column 5 in file
`models\staging\schema.yml`
[0m01:16:48.779752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b053c98f-2a15-4d15-9b20-bbf46760a389', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001680ED17680>]}
[0m01:16:50.540958 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'fct_rating' in the 'models' section of file 'models\staging\schema.yml'
[0m01:16:51.089334 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.Slip_Tests.not_null_fct_rating_user_id.140768c4a8' (models\staging\schema.yml) depends on a node named 'fct_rating' in package '' which was not found
[0m01:16:51.089334 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.Slip_Tests.not_null_fct_rating_movie_id.e7004ba604' (models\staging\schema.yml) depends on a node named 'fct_rating' in package '' which was not found
[0m01:16:51.089334 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.Slip_Tests.not_null_fct_rating_rating.2f45ab1d54' (models\staging\schema.yml) depends on a node named 'fct_rating' in package '' which was not found
[0m01:16:51.089334 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.Slip_Tests.dbt_utils_expression_is_true_fct_rating__select_sum_rating_from_ref_src_ratings_select_sum_rating_from_ref_fct_rating_.f8623932f1' (models\staging\schema.yml) depends on a node named 'fct_rating' in package '' which was not found
[0m01:16:51.089334 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.Slip_Tests.dbt_utils_expression_is_true_fct_rating__select_sum_rating_from_ref_src_ratings_select_sum_rating_from_ref_fct_rating_.f8623932f1' (models\staging\schema.yml) depends on a node named 'fct_rating' in package '' which was not found
[0m01:16:51.192451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b053c98f-2a15-4d15-9b20-bbf46760a389', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001680EF4CC20>]}
[0m01:16:51.318203 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m01:16:51.333826 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m01:16:51.349855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b053c98f-2a15-4d15-9b20-bbf46760a389', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001680EF2BB30>]}
[0m01:16:51.349855 [info ] [MainThread]: Found 12 models, 1 snapshot, 12 data tests, 6 sources, 592 macros
[0m01:16:51.365495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b053c98f-2a15-4d15-9b20-bbf46760a389', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001680EF4D550>]}
[0m01:16:51.365495 [info ] [MainThread]: 
[0m01:16:51.365495 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:16:51.365495 [info ] [MainThread]: 
[0m01:16:51.372256 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:16:51.373372 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MOVIELENS'
[0m01:16:51.442034 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS"
[0m01:16:51.443040 [debug] [ThreadPool]: On list_MOVIELENS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS"} */
show terse schemas in database MOVIELENS
    limit 10000
[0m01:16:51.443040 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:16:52.719600 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.291 seconds
[0m01:16:52.735220 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MOVIELENS_snapshots'
[0m01:16:52.751435 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m01:16:52.751435 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
alter session set quoted_identifiers_ignore_case = false;
[0m01:16:52.751435 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:16:53.895238 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.140 seconds
[0m01:16:53.895238 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m01:16:53.906367 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
show objects in MOVIELENS.snapshots
    limit 10000
    
;
[0m01:16:54.130450 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.239 seconds
[0m01:16:54.146076 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m01:16:54.146076 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
alter session unset quoted_identifiers_ignore_case;
[0m01:16:54.382198 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.233 seconds
[0m01:16:54.382198 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MOVIELENS_snapshots, now list_MOVIELENS_DEV)
[0m01:16:54.382198 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m01:16:54.382198 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session set quoted_identifiers_ignore_case = false;
[0m01:16:54.617660 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.235 seconds
[0m01:16:54.617660 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m01:16:54.617660 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
show objects in MOVIELENS.DEV
    limit 10000
    
;
[0m01:16:54.866788 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.246 seconds
[0m01:16:54.866788 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m01:16:54.866788 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session unset quoted_identifiers_ignore_case;
[0m01:16:55.086771 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.211 seconds
[0m01:16:55.086771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b053c98f-2a15-4d15-9b20-bbf46760a389', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001680F1F4BC0>]}
[0m01:16:55.102290 [debug] [Thread-1 (]: Began running node snapshot.Slip_Tests.snap_tags
[0m01:16:55.102290 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.snap_tags ...................................... [RUN]
[0m01:16:55.102290 [debug] [Thread-1 (]: Acquiring new snowflake connection 'snapshot.Slip_Tests.snap_tags'
[0m01:16:55.102290 [debug] [Thread-1 (]: Began compiling node snapshot.Slip_Tests.snap_tags
[0m01:16:55.102290 [debug] [Thread-1 (]: Began executing node snapshot.Slip_Tests.snap_tags
[0m01:16:55.192573 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m01:16:55.192573 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
/* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(user_id as varchar ), '')
         || '|' || coalesce(cast(movie_id as varchar ), '')
         || '|' || coalesce(cast(tag as varchar ), '')
         || '|' || coalesce(cast(tag_timestamp as varchar ), '')
        ) as dbt_scd_id,
        tag_timestamp as dbt_updated_at,
        tag_timestamp as dbt_valid_from,
        
  
  coalesce(nullif(tag_timestamp, tag_timestamp), null)
  as dbt_valid_to
from (
        



SELECT
    md5(cast(coalesce(cast(user_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(movie_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tag as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS id,
    user_id,
    movie_id,
    tag,
    tag_timestamp  AS tag_timestamp
FROM MOVIELENS.DEV.src_tags
-- LIMIT 100

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m01:16:55.192573 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:16:56.528666 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.337 seconds
[0m01:16:56.528666 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m01:16:56.528666 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
/* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m01:16:56.733121 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.203 seconds
[0m01:16:56.733121 [warn ] [Thread-1 (]: Data type of snapshot table timestamp columns (TIMESTAMP_NTZ) doesn't match derived column 'updated_at' (TIMESTAMP_LTZ). Please update snapshot config 'updated_at'.
[0m01:16:56.733121 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.Slip_Tests.snap_tags"
[0m01:16:56.733121 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m01:16:56.733121 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
create or replace transient table MOVIELENS.snapshots.snap_tags
    

    
    as (
    

    select *,
        md5(coalesce(cast(user_id as varchar ), '')
         || '|' || coalesce(cast(movie_id as varchar ), '')
         || '|' || coalesce(cast(tag as varchar ), '')
         || '|' || coalesce(cast(tag_timestamp as varchar ), '')
        ) as dbt_scd_id,
        tag_timestamp as dbt_updated_at,
        tag_timestamp as dbt_valid_from,
        
  
  coalesce(nullif(tag_timestamp, tag_timestamp), null)
  as dbt_valid_to
from (
        



SELECT
    md5(cast(coalesce(cast(user_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(movie_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tag as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS id,
    user_id,
    movie_id,
    tag,
    tag_timestamp  AS tag_timestamp
FROM MOVIELENS.DEV.src_tags
-- LIMIT 100

    ) sbq



    )
;
[0m01:17:00.808656 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.070 seconds
[0m01:17:00.824104 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b053c98f-2a15-4d15-9b20-bbf46760a389', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168097E9250>]}
[0m01:17:00.824104 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.snap_tags ...................................... [[32mSUCCESS 1[0m in 5.72s]
[0m01:17:00.839728 [debug] [Thread-1 (]: Finished running node snapshot.Slip_Tests.snap_tags
[0m01:17:00.839728 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:17:00.839728 [debug] [MainThread]: Connection 'list_MOVIELENS' was left open.
[0m01:17:00.839728 [debug] [MainThread]: On list_MOVIELENS: Close
[0m01:17:01.198858 [debug] [MainThread]: Connection 'list_MOVIELENS_DEV' was left open.
[0m01:17:01.198858 [debug] [MainThread]: On list_MOVIELENS_DEV: Close
[0m01:17:01.544040 [debug] [MainThread]: Connection 'snapshot.Slip_Tests.snap_tags' was left open.
[0m01:17:01.544040 [debug] [MainThread]: On snapshot.Slip_Tests.snap_tags: Close
[0m01:17:01.936966 [info ] [MainThread]: 
[0m01:17:01.936966 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 10.57 seconds (10.57s).
[0m01:17:01.936966 [debug] [MainThread]: Command end result
[0m01:17:01.973301 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m01:17:01.975051 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m01:17:01.985957 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\dbt_workspace\Slip_Tests\target\run_results.json
[0m01:17:01.985957 [info ] [MainThread]: 
[0m01:17:01.985957 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:17:01.985957 [info ] [MainThread]: 
[0m01:17:01.985957 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m01:17:01.985957 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m01:17:01.985957 [debug] [MainThread]: Command `dbt snapshot` succeeded at 01:17:01.985957 after 14.57 seconds
[0m01:17:01.985957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016808DF1BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001680BF13EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001680BF12870>]}
[0m01:17:01.985957 [debug] [MainThread]: Flushing usage events
[0m01:17:02.955663 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:18:02.075195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001052EBDCF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001052C35E0C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001052EBDFBC0>]}


============================== 01:18:02.090804 | 8cecd117-55f8-4528-9bdc-fb279a0152cb ==============================
[0m01:18:02.090804 [info ] [MainThread]: Running with dbt=1.10.1
[0m01:18:02.090804 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ThembaniFaleni\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\dbt_workspace\\Slip_Tests\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt test', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:18:02.766217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8cecd117-55f8-4528-9bdc-fb279a0152cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001052C1BA240>]}
[0m01:18:02.920863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8cecd117-55f8-4528-9bdc-fb279a0152cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010530DEEDE0>]}
[0m01:18:02.922878 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m01:18:03.107855 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m01:18:03.289708 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:18:03.289708 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:18:03.352338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8cecd117-55f8-4528-9bdc-fb279a0152cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010531365220>]}
[0m01:18:03.500953 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m01:18:03.508510 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m01:18:03.548327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8cecd117-55f8-4528-9bdc-fb279a0152cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010531777E60>]}
[0m01:18:03.548327 [info ] [MainThread]: Found 12 models, 1 snapshot, 12 data tests, 6 sources, 592 macros
[0m01:18:03.548327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8cecd117-55f8-4528-9bdc-fb279a0152cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010531316F00>]}
[0m01:18:03.548327 [info ] [MainThread]: 
[0m01:18:03.548327 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:18:03.548327 [info ] [MainThread]: 
[0m01:18:03.561767 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:18:03.566936 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MOVIELENS_DEV'
[0m01:18:03.637286 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m01:18:03.638382 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session set quoted_identifiers_ignore_case = false;
[0m01:18:03.638382 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:18:05.463733 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.833 seconds
[0m01:18:05.463733 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m01:18:05.463733 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
show objects in MOVIELENS.DEV
    limit 10000
    
;
[0m01:18:05.695931 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.230 seconds
[0m01:18:05.711470 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m01:18:05.711470 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session unset quoted_identifiers_ignore_case;
[0m01:18:05.916315 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.219 seconds
[0m01:18:05.931973 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MOVIELENS_DEV, now list_MOVIELENS_snapshots)
[0m01:18:05.931973 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m01:18:05.931973 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
alter session set quoted_identifiers_ignore_case = false;
[0m01:18:06.149741 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.209 seconds
[0m01:18:06.149741 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m01:18:06.149741 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
show objects in MOVIELENS.snapshots
    limit 10000
    
;
[0m01:18:06.371258 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.216 seconds
[0m01:18:06.371258 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m01:18:06.371258 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
alter session unset quoted_identifiers_ignore_case;
[0m01:18:06.619468 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.244 seconds
[0m01:18:06.623507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8cecd117-55f8-4528-9bdc-fb279a0152cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000105312A5250>]}
[0m01:18:06.629352 [debug] [Thread-1 (]: Began running node test.Slip_Tests.dbt_utils_equal_rowcount_fct_genome_score_ref_src_genome_score_.c5d70ca0d7
[0m01:18:06.629352 [info ] [Thread-1 (]: 1 of 12 START test dbt_utils_equal_rowcount_fct_genome_score_ref_src_genome_score_  [RUN]
[0m01:18:06.630449 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.Slip_Tests.dbt_utils_equal_rowcount_fct_genome_score_ref_src_genome_score_.c5d70ca0d7'
[0m01:18:06.631354 [debug] [Thread-1 (]: Began compiling node test.Slip_Tests.dbt_utils_equal_rowcount_fct_genome_score_ref_src_genome_score_.c5d70ca0d7
[0m01:18:06.635735 [debug] [Thread-1 (]: Writing injected SQL for node "test.Slip_Tests.dbt_utils_equal_rowcount_fct_genome_score_ref_src_genome_score_.c5d70ca0d7"
[0m01:18:06.651477 [debug] [Thread-1 (]: Began executing node test.Slip_Tests.dbt_utils_equal_rowcount_fct_genome_score_ref_src_genome_score_.c5d70ca0d7
[0m01:18:06.670761 [debug] [Thread-1 (]: Writing runtime sql for node "test.Slip_Tests.dbt_utils_equal_rowcount_fct_genome_score_ref_src_genome_score_.c5d70ca0d7"
[0m01:18:06.670761 [debug] [Thread-1 (]: Using snowflake connection "test.Slip_Tests.dbt_utils_equal_rowcount_fct_genome_score_ref_src_genome_score_.c5d70ca0d7"
[0m01:18:06.670761 [debug] [Thread-1 (]: On test.Slip_Tests.dbt_utils_equal_rowcount_fct_genome_score_ref_src_genome_score_.c5d70ca0d7: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "test.Slip_Tests.dbt_utils_equal_rowcount_fct_genome_score_ref_src_genome_score_.c5d70ca0d7"} */
select
      sum(coalesce(diff_count, 0)) as failures,
      sum(coalesce(diff_count, 0)) != 0 as should_warn,
      sum(coalesce(diff_count, 0)) != 0 as should_error
    from (
      
    
  




with a as (

    select 
      
      1 as id_dbtutils_test_equal_rowcount,
      count(*) as count_a 
    from MOVIELENS.DEV.fct_genome_score
    group by id_dbtutils_test_equal_rowcount


),
b as (

    select 
      
      1 as id_dbtutils_test_equal_rowcount,
      count(*) as count_b 
    from MOVIELENS.DEV.src_genome_score
    group by id_dbtutils_test_equal_rowcount

),
final as (

    select
    
        a.id_dbtutils_test_equal_rowcount as id_dbtutils_test_equal_rowcount_a,
          b.id_dbtutils_test_equal_rowcount as id_dbtutils_test_equal_rowcount_b,
        

        count_a,
        count_b,
        abs(count_a - count_b) as diff_count

    from a
    full join b
    on
    a.id_dbtutils_test_equal_rowcount = b.id_dbtutils_test_equal_rowcount
    


)

select * from final


  
  
      
    ) dbt_internal_test
[0m01:18:06.670761 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:18:08.282223 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.609 seconds
[0m01:18:08.297706 [info ] [Thread-1 (]: 1 of 12 PASS dbt_utils_equal_rowcount_fct_genome_score_ref_src_genome_score_ ... [[32mPASS[0m in 1.67s]
[0m01:18:08.297706 [debug] [Thread-1 (]: Finished running node test.Slip_Tests.dbt_utils_equal_rowcount_fct_genome_score_ref_src_genome_score_.c5d70ca0d7
[0m01:18:08.297706 [debug] [Thread-1 (]: Began running node test.Slip_Tests.dbt_utils_equal_rowcount_snap_tags_ref_src_tags_.78963607ce
[0m01:18:08.297706 [info ] [Thread-1 (]: 2 of 12 START test dbt_utils_equal_rowcount_snap_tags_ref_src_tags_ ............ [RUN]
[0m01:18:08.297706 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Slip_Tests.dbt_utils_equal_rowcount_fct_genome_score_ref_src_genome_score_.c5d70ca0d7, now test.Slip_Tests.dbt_utils_equal_rowcount_snap_tags_ref_src_tags_.78963607ce)
[0m01:18:08.297706 [debug] [Thread-1 (]: Began compiling node test.Slip_Tests.dbt_utils_equal_rowcount_snap_tags_ref_src_tags_.78963607ce
[0m01:18:08.297706 [debug] [Thread-1 (]: Writing injected SQL for node "test.Slip_Tests.dbt_utils_equal_rowcount_snap_tags_ref_src_tags_.78963607ce"
[0m01:18:08.297706 [debug] [Thread-1 (]: Began executing node test.Slip_Tests.dbt_utils_equal_rowcount_snap_tags_ref_src_tags_.78963607ce
[0m01:18:08.313316 [debug] [Thread-1 (]: Writing runtime sql for node "test.Slip_Tests.dbt_utils_equal_rowcount_snap_tags_ref_src_tags_.78963607ce"
[0m01:18:08.316251 [debug] [Thread-1 (]: Using snowflake connection "test.Slip_Tests.dbt_utils_equal_rowcount_snap_tags_ref_src_tags_.78963607ce"
[0m01:18:08.316251 [debug] [Thread-1 (]: On test.Slip_Tests.dbt_utils_equal_rowcount_snap_tags_ref_src_tags_.78963607ce: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "test.Slip_Tests.dbt_utils_equal_rowcount_snap_tags_ref_src_tags_.78963607ce"} */
select
      sum(coalesce(diff_count, 0)) as failures,
      sum(coalesce(diff_count, 0)) != 0 as should_warn,
      sum(coalesce(diff_count, 0)) != 0 as should_error
    from (
      
    
  




with a as (

    select 
      
      1 as id_dbtutils_test_equal_rowcount,
      count(*) as count_a 
    from MOVIELENS.snapshots.snap_tags
    group by id_dbtutils_test_equal_rowcount


),
b as (

    select 
      
      1 as id_dbtutils_test_equal_rowcount,
      count(*) as count_b 
    from MOVIELENS.DEV.src_tags
    group by id_dbtutils_test_equal_rowcount

),
final as (

    select
    
        a.id_dbtutils_test_equal_rowcount as id_dbtutils_test_equal_rowcount_a,
          b.id_dbtutils_test_equal_rowcount as id_dbtutils_test_equal_rowcount_b,
        

        count_a,
        count_b,
        abs(count_a - count_b) as diff_count

    from a
    full join b
    on
    a.id_dbtutils_test_equal_rowcount = b.id_dbtutils_test_equal_rowcount
    


)

select * from final


  
  
      
    ) dbt_internal_test
[0m01:18:08.641295 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.331 seconds
[0m01:18:08.641295 [info ] [Thread-1 (]: 2 of 12 PASS dbt_utils_equal_rowcount_snap_tags_ref_src_tags_ .................. [[32mPASS[0m in 0.34s]
[0m01:18:08.641295 [debug] [Thread-1 (]: Finished running node test.Slip_Tests.dbt_utils_equal_rowcount_snap_tags_ref_src_tags_.78963607ce
[0m01:18:08.641295 [debug] [Thread-1 (]: Began running node test.Slip_Tests.not_null_dim_movies_movie_id.0f96ca970d
[0m01:18:08.641295 [info ] [Thread-1 (]: 3 of 12 START test not_null_dim_movies_movie_id ................................ [RUN]
[0m01:18:08.641295 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Slip_Tests.dbt_utils_equal_rowcount_snap_tags_ref_src_tags_.78963607ce, now test.Slip_Tests.not_null_dim_movies_movie_id.0f96ca970d)
[0m01:18:08.656801 [debug] [Thread-1 (]: Began compiling node test.Slip_Tests.not_null_dim_movies_movie_id.0f96ca970d
[0m01:18:08.657540 [debug] [Thread-1 (]: Writing injected SQL for node "test.Slip_Tests.not_null_dim_movies_movie_id.0f96ca970d"
[0m01:18:08.657540 [debug] [Thread-1 (]: Began executing node test.Slip_Tests.not_null_dim_movies_movie_id.0f96ca970d
[0m01:18:08.657540 [debug] [Thread-1 (]: Writing runtime sql for node "test.Slip_Tests.not_null_dim_movies_movie_id.0f96ca970d"
[0m01:18:08.657540 [debug] [Thread-1 (]: Using snowflake connection "test.Slip_Tests.not_null_dim_movies_movie_id.0f96ca970d"
[0m01:18:08.657540 [debug] [Thread-1 (]: On test.Slip_Tests.not_null_dim_movies_movie_id.0f96ca970d: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "test.Slip_Tests.not_null_dim_movies_movie_id.0f96ca970d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select movie_id
from MOVIELENS.DEV.dim_movies
where movie_id is null



  
  
      
    ) dbt_internal_test
[0m01:18:08.908031 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.239 seconds
[0m01:18:08.908031 [info ] [Thread-1 (]: 3 of 12 PASS not_null_dim_movies_movie_id ...................................... [[32mPASS[0m in 0.27s]
[0m01:18:08.908031 [debug] [Thread-1 (]: Finished running node test.Slip_Tests.not_null_dim_movies_movie_id.0f96ca970d
[0m01:18:08.908031 [debug] [Thread-1 (]: Began running node test.Slip_Tests.not_null_dim_movies_movie_title.0206534c81
[0m01:18:08.908031 [info ] [Thread-1 (]: 4 of 12 START test not_null_dim_movies_movie_title ............................. [RUN]
[0m01:18:08.908031 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Slip_Tests.not_null_dim_movies_movie_id.0f96ca970d, now test.Slip_Tests.not_null_dim_movies_movie_title.0206534c81)
[0m01:18:08.908031 [debug] [Thread-1 (]: Began compiling node test.Slip_Tests.not_null_dim_movies_movie_title.0206534c81
[0m01:18:08.926260 [debug] [Thread-1 (]: Writing injected SQL for node "test.Slip_Tests.not_null_dim_movies_movie_title.0206534c81"
[0m01:18:08.928595 [debug] [Thread-1 (]: Began executing node test.Slip_Tests.not_null_dim_movies_movie_title.0206534c81
[0m01:18:08.933707 [debug] [Thread-1 (]: Writing runtime sql for node "test.Slip_Tests.not_null_dim_movies_movie_title.0206534c81"
[0m01:18:08.936081 [debug] [Thread-1 (]: Using snowflake connection "test.Slip_Tests.not_null_dim_movies_movie_title.0206534c81"
[0m01:18:08.937307 [debug] [Thread-1 (]: On test.Slip_Tests.not_null_dim_movies_movie_title.0206534c81: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "test.Slip_Tests.not_null_dim_movies_movie_title.0206534c81"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select movie_title
from MOVIELENS.DEV.dim_movies
where movie_title is null



  
  
      
    ) dbt_internal_test
[0m01:18:09.206730 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.271 seconds
[0m01:18:09.206730 [info ] [Thread-1 (]: 4 of 12 PASS not_null_dim_movies_movie_title ................................... [[32mPASS[0m in 0.30s]
[0m01:18:09.206730 [debug] [Thread-1 (]: Finished running node test.Slip_Tests.not_null_dim_movies_movie_title.0206534c81
[0m01:18:09.206730 [debug] [Thread-1 (]: Began running node test.Slip_Tests.not_null_fct_genome_score_movie_id.a06a45d2b3
[0m01:18:09.206730 [info ] [Thread-1 (]: 5 of 12 START test not_null_fct_genome_score_movie_id .......................... [RUN]
[0m01:18:09.206730 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Slip_Tests.not_null_dim_movies_movie_title.0206534c81, now test.Slip_Tests.not_null_fct_genome_score_movie_id.a06a45d2b3)
[0m01:18:09.206730 [debug] [Thread-1 (]: Began compiling node test.Slip_Tests.not_null_fct_genome_score_movie_id.a06a45d2b3
[0m01:18:09.224854 [debug] [Thread-1 (]: Writing injected SQL for node "test.Slip_Tests.not_null_fct_genome_score_movie_id.a06a45d2b3"
[0m01:18:09.225630 [debug] [Thread-1 (]: Began executing node test.Slip_Tests.not_null_fct_genome_score_movie_id.a06a45d2b3
[0m01:18:09.228544 [debug] [Thread-1 (]: Writing runtime sql for node "test.Slip_Tests.not_null_fct_genome_score_movie_id.a06a45d2b3"
[0m01:18:09.228544 [debug] [Thread-1 (]: Using snowflake connection "test.Slip_Tests.not_null_fct_genome_score_movie_id.a06a45d2b3"
[0m01:18:09.228544 [debug] [Thread-1 (]: On test.Slip_Tests.not_null_fct_genome_score_movie_id.a06a45d2b3: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "test.Slip_Tests.not_null_fct_genome_score_movie_id.a06a45d2b3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select movie_id
from MOVIELENS.DEV.fct_genome_score
where movie_id is null



  
  
      
    ) dbt_internal_test
[0m01:18:09.442913 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.226 seconds
[0m01:18:09.458491 [info ] [Thread-1 (]: 5 of 12 PASS not_null_fct_genome_score_movie_id ................................ [[32mPASS[0m in 0.25s]
[0m01:18:09.458491 [debug] [Thread-1 (]: Finished running node test.Slip_Tests.not_null_fct_genome_score_movie_id.a06a45d2b3
[0m01:18:09.458491 [debug] [Thread-1 (]: Began running node test.Slip_Tests.not_null_fct_genome_score_relevance_score.c1509905ec
[0m01:18:09.458491 [info ] [Thread-1 (]: 6 of 12 START test not_null_fct_genome_score_relevance_score ................... [RUN]
[0m01:18:09.458491 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Slip_Tests.not_null_fct_genome_score_movie_id.a06a45d2b3, now test.Slip_Tests.not_null_fct_genome_score_relevance_score.c1509905ec)
[0m01:18:09.458491 [debug] [Thread-1 (]: Began compiling node test.Slip_Tests.not_null_fct_genome_score_relevance_score.c1509905ec
[0m01:18:09.458491 [debug] [Thread-1 (]: Writing injected SQL for node "test.Slip_Tests.not_null_fct_genome_score_relevance_score.c1509905ec"
[0m01:18:09.458491 [debug] [Thread-1 (]: Began executing node test.Slip_Tests.not_null_fct_genome_score_relevance_score.c1509905ec
[0m01:18:09.475247 [debug] [Thread-1 (]: Writing runtime sql for node "test.Slip_Tests.not_null_fct_genome_score_relevance_score.c1509905ec"
[0m01:18:09.476455 [debug] [Thread-1 (]: Using snowflake connection "test.Slip_Tests.not_null_fct_genome_score_relevance_score.c1509905ec"
[0m01:18:09.477494 [debug] [Thread-1 (]: On test.Slip_Tests.not_null_fct_genome_score_relevance_score.c1509905ec: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "test.Slip_Tests.not_null_fct_genome_score_relevance_score.c1509905ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select relevance_score
from MOVIELENS.DEV.fct_genome_score
where relevance_score is null



  
  
      
    ) dbt_internal_test
[0m01:18:09.677370 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.209 seconds
[0m01:18:09.677370 [info ] [Thread-1 (]: 6 of 12 PASS not_null_fct_genome_score_relevance_score ......................... [[32mPASS[0m in 0.22s]
[0m01:18:09.677370 [debug] [Thread-1 (]: Finished running node test.Slip_Tests.not_null_fct_genome_score_relevance_score.c1509905ec
[0m01:18:09.692893 [debug] [Thread-1 (]: Began running node test.Slip_Tests.not_null_fct_genome_score_tag_id.5d40275b2b
[0m01:18:09.692893 [info ] [Thread-1 (]: 7 of 12 START test not_null_fct_genome_score_tag_id ............................ [RUN]
[0m01:18:09.692893 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Slip_Tests.not_null_fct_genome_score_relevance_score.c1509905ec, now test.Slip_Tests.not_null_fct_genome_score_tag_id.5d40275b2b)
[0m01:18:09.692893 [debug] [Thread-1 (]: Began compiling node test.Slip_Tests.not_null_fct_genome_score_tag_id.5d40275b2b
[0m01:18:09.692893 [debug] [Thread-1 (]: Writing injected SQL for node "test.Slip_Tests.not_null_fct_genome_score_tag_id.5d40275b2b"
[0m01:18:09.692893 [debug] [Thread-1 (]: Began executing node test.Slip_Tests.not_null_fct_genome_score_tag_id.5d40275b2b
[0m01:18:09.692893 [debug] [Thread-1 (]: Writing runtime sql for node "test.Slip_Tests.not_null_fct_genome_score_tag_id.5d40275b2b"
[0m01:18:09.692893 [debug] [Thread-1 (]: Using snowflake connection "test.Slip_Tests.not_null_fct_genome_score_tag_id.5d40275b2b"
[0m01:18:09.692893 [debug] [Thread-1 (]: On test.Slip_Tests.not_null_fct_genome_score_tag_id.5d40275b2b: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "test.Slip_Tests.not_null_fct_genome_score_tag_id.5d40275b2b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select tag_id
from MOVIELENS.DEV.fct_genome_score
where tag_id is null



  
  
      
    ) dbt_internal_test
[0m01:18:09.927487 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.233 seconds
[0m01:18:09.927487 [info ] [Thread-1 (]: 7 of 12 PASS not_null_fct_genome_score_tag_id .................................. [[32mPASS[0m in 0.23s]
[0m01:18:09.943130 [debug] [Thread-1 (]: Finished running node test.Slip_Tests.not_null_fct_genome_score_tag_id.5d40275b2b
[0m01:18:09.943130 [debug] [Thread-1 (]: Began running node test.Slip_Tests.not_null_snap_tags_id.015a2066c2
[0m01:18:09.943130 [info ] [Thread-1 (]: 8 of 12 START test not_null_snap_tags_id ....................................... [RUN]
[0m01:18:09.943130 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Slip_Tests.not_null_fct_genome_score_tag_id.5d40275b2b, now test.Slip_Tests.not_null_snap_tags_id.015a2066c2)
[0m01:18:09.943130 [debug] [Thread-1 (]: Began compiling node test.Slip_Tests.not_null_snap_tags_id.015a2066c2
[0m01:18:09.943130 [debug] [Thread-1 (]: Writing injected SQL for node "test.Slip_Tests.not_null_snap_tags_id.015a2066c2"
[0m01:18:09.943130 [debug] [Thread-1 (]: Began executing node test.Slip_Tests.not_null_snap_tags_id.015a2066c2
[0m01:18:09.943130 [debug] [Thread-1 (]: Writing runtime sql for node "test.Slip_Tests.not_null_snap_tags_id.015a2066c2"
[0m01:18:09.943130 [debug] [Thread-1 (]: Using snowflake connection "test.Slip_Tests.not_null_snap_tags_id.015a2066c2"
[0m01:18:09.943130 [debug] [Thread-1 (]: On test.Slip_Tests.not_null_snap_tags_id.015a2066c2: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "test.Slip_Tests.not_null_snap_tags_id.015a2066c2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from MOVIELENS.snapshots.snap_tags
where id is null



  
  
      
    ) dbt_internal_test
[0m01:18:10.254752 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.306 seconds
[0m01:18:10.254752 [info ] [Thread-1 (]: 8 of 12 PASS not_null_snap_tags_id ............................................. [[32mPASS[0m in 0.31s]
[0m01:18:10.254752 [debug] [Thread-1 (]: Finished running node test.Slip_Tests.not_null_snap_tags_id.015a2066c2
[0m01:18:10.254752 [debug] [Thread-1 (]: Began running node test.Slip_Tests.not_null_snap_tags_movie_id.fb9962de5f
[0m01:18:10.254752 [info ] [Thread-1 (]: 9 of 12 START test not_null_snap_tags_movie_id ................................. [RUN]
[0m01:18:10.254752 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Slip_Tests.not_null_snap_tags_id.015a2066c2, now test.Slip_Tests.not_null_snap_tags_movie_id.fb9962de5f)
[0m01:18:10.254752 [debug] [Thread-1 (]: Began compiling node test.Slip_Tests.not_null_snap_tags_movie_id.fb9962de5f
[0m01:18:10.273827 [debug] [Thread-1 (]: Writing injected SQL for node "test.Slip_Tests.not_null_snap_tags_movie_id.fb9962de5f"
[0m01:18:10.274608 [debug] [Thread-1 (]: Began executing node test.Slip_Tests.not_null_snap_tags_movie_id.fb9962de5f
[0m01:18:10.277716 [debug] [Thread-1 (]: Writing runtime sql for node "test.Slip_Tests.not_null_snap_tags_movie_id.fb9962de5f"
[0m01:18:10.277716 [debug] [Thread-1 (]: Using snowflake connection "test.Slip_Tests.not_null_snap_tags_movie_id.fb9962de5f"
[0m01:18:10.277716 [debug] [Thread-1 (]: On test.Slip_Tests.not_null_snap_tags_movie_id.fb9962de5f: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "test.Slip_Tests.not_null_snap_tags_movie_id.fb9962de5f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select movie_id
from MOVIELENS.snapshots.snap_tags
where movie_id is null



  
  
      
    ) dbt_internal_test
[0m01:18:10.557456 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.287 seconds
[0m01:18:10.557456 [info ] [Thread-1 (]: 9 of 12 PASS not_null_snap_tags_movie_id ....................................... [[32mPASS[0m in 0.30s]
[0m01:18:10.572928 [debug] [Thread-1 (]: Finished running node test.Slip_Tests.not_null_snap_tags_movie_id.fb9962de5f
[0m01:18:10.572928 [debug] [Thread-1 (]: Began running node test.Slip_Tests.not_null_snap_tags_tag.b66ecb49f3
[0m01:18:10.572928 [info ] [Thread-1 (]: 10 of 12 START test not_null_snap_tags_tag ..................................... [RUN]
[0m01:18:10.572928 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Slip_Tests.not_null_snap_tags_movie_id.fb9962de5f, now test.Slip_Tests.not_null_snap_tags_tag.b66ecb49f3)
[0m01:18:10.572928 [debug] [Thread-1 (]: Began compiling node test.Slip_Tests.not_null_snap_tags_tag.b66ecb49f3
[0m01:18:10.572928 [debug] [Thread-1 (]: Writing injected SQL for node "test.Slip_Tests.not_null_snap_tags_tag.b66ecb49f3"
[0m01:18:10.572928 [debug] [Thread-1 (]: Began executing node test.Slip_Tests.not_null_snap_tags_tag.b66ecb49f3
[0m01:18:10.572928 [debug] [Thread-1 (]: Writing runtime sql for node "test.Slip_Tests.not_null_snap_tags_tag.b66ecb49f3"
[0m01:18:10.572928 [debug] [Thread-1 (]: Using snowflake connection "test.Slip_Tests.not_null_snap_tags_tag.b66ecb49f3"
[0m01:18:10.572928 [debug] [Thread-1 (]: On test.Slip_Tests.not_null_snap_tags_tag.b66ecb49f3: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "test.Slip_Tests.not_null_snap_tags_tag.b66ecb49f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select tag
from MOVIELENS.snapshots.snap_tags
where tag is null



  
  
      
    ) dbt_internal_test
[0m01:18:10.883767 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.312 seconds
[0m01:18:10.899438 [info ] [Thread-1 (]: 10 of 12 PASS not_null_snap_tags_tag ........................................... [[32mPASS[0m in 0.33s]
[0m01:18:10.899438 [debug] [Thread-1 (]: Finished running node test.Slip_Tests.not_null_snap_tags_tag.b66ecb49f3
[0m01:18:10.899438 [debug] [Thread-1 (]: Began running node test.Slip_Tests.not_null_snap_tags_user_id.a9aef7cace
[0m01:18:10.899438 [info ] [Thread-1 (]: 11 of 12 START test not_null_snap_tags_user_id ................................. [RUN]
[0m01:18:10.899438 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Slip_Tests.not_null_snap_tags_tag.b66ecb49f3, now test.Slip_Tests.not_null_snap_tags_user_id.a9aef7cace)
[0m01:18:10.899438 [debug] [Thread-1 (]: Began compiling node test.Slip_Tests.not_null_snap_tags_user_id.a9aef7cace
[0m01:18:10.899438 [debug] [Thread-1 (]: Writing injected SQL for node "test.Slip_Tests.not_null_snap_tags_user_id.a9aef7cace"
[0m01:18:10.899438 [debug] [Thread-1 (]: Began executing node test.Slip_Tests.not_null_snap_tags_user_id.a9aef7cace
[0m01:18:10.899438 [debug] [Thread-1 (]: Writing runtime sql for node "test.Slip_Tests.not_null_snap_tags_user_id.a9aef7cace"
[0m01:18:10.899438 [debug] [Thread-1 (]: Using snowflake connection "test.Slip_Tests.not_null_snap_tags_user_id.a9aef7cace"
[0m01:18:10.899438 [debug] [Thread-1 (]: On test.Slip_Tests.not_null_snap_tags_user_id.a9aef7cace: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "test.Slip_Tests.not_null_snap_tags_user_id.a9aef7cace"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from MOVIELENS.snapshots.snap_tags
where user_id is null



  
  
      
    ) dbt_internal_test
[0m01:18:11.204542 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.296 seconds
[0m01:18:11.204542 [info ] [Thread-1 (]: 11 of 12 PASS not_null_snap_tags_user_id ....................................... [[32mPASS[0m in 0.31s]
[0m01:18:11.204542 [debug] [Thread-1 (]: Finished running node test.Slip_Tests.not_null_snap_tags_user_id.a9aef7cace
[0m01:18:11.204542 [debug] [Thread-1 (]: Began running node test.Slip_Tests.unique_snap_tags_id.4ac4f44417
[0m01:18:11.204542 [info ] [Thread-1 (]: 12 of 12 START test unique_snap_tags_id ........................................ [RUN]
[0m01:18:11.204542 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Slip_Tests.not_null_snap_tags_user_id.a9aef7cace, now test.Slip_Tests.unique_snap_tags_id.4ac4f44417)
[0m01:18:11.204542 [debug] [Thread-1 (]: Began compiling node test.Slip_Tests.unique_snap_tags_id.4ac4f44417
[0m01:18:11.225070 [debug] [Thread-1 (]: Writing injected SQL for node "test.Slip_Tests.unique_snap_tags_id.4ac4f44417"
[0m01:18:11.228586 [debug] [Thread-1 (]: Began executing node test.Slip_Tests.unique_snap_tags_id.4ac4f44417
[0m01:18:11.228586 [debug] [Thread-1 (]: Writing runtime sql for node "test.Slip_Tests.unique_snap_tags_id.4ac4f44417"
[0m01:18:11.228586 [debug] [Thread-1 (]: Using snowflake connection "test.Slip_Tests.unique_snap_tags_id.4ac4f44417"
[0m01:18:11.233190 [debug] [Thread-1 (]: On test.Slip_Tests.unique_snap_tags_id.4ac4f44417: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "test.Slip_Tests.unique_snap_tags_id.4ac4f44417"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from MOVIELENS.snapshots.snap_tags
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:18:11.573038 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.351 seconds
[0m01:18:11.588596 [info ] [Thread-1 (]: 12 of 12 PASS unique_snap_tags_id .............................................. [[32mPASS[0m in 0.37s]
[0m01:18:11.588596 [debug] [Thread-1 (]: Finished running node test.Slip_Tests.unique_snap_tags_id.4ac4f44417
[0m01:18:11.588596 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:18:11.588596 [debug] [MainThread]: Connection 'list_MOVIELENS_snapshots' was left open.
[0m01:18:11.588596 [debug] [MainThread]: On list_MOVIELENS_snapshots: Close
[0m01:18:12.042831 [debug] [MainThread]: Connection 'test.Slip_Tests.unique_snap_tags_id.4ac4f44417' was left open.
[0m01:18:12.042831 [debug] [MainThread]: On test.Slip_Tests.unique_snap_tags_id.4ac4f44417: Close
[0m01:18:12.937155 [info ] [MainThread]: 
[0m01:18:12.952810 [info ] [MainThread]: Finished running 12 data tests in 0 hours 0 minutes and 9.38 seconds (9.38s).
[0m01:18:12.952810 [debug] [MainThread]: Command end result
[0m01:18:12.976238 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m01:18:12.982641 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m01:18:12.991656 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\dbt_workspace\Slip_Tests\target\run_results.json
[0m01:18:12.991656 [info ] [MainThread]: 
[0m01:18:12.999061 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:18:13.000153 [info ] [MainThread]: 
[0m01:18:13.001125 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=12
[0m01:18:13.001125 [debug] [MainThread]: Command `dbt test` succeeded at 01:18:13.001125 after 11.16 seconds
[0m01:18:13.001125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001052E6D4740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001052EC50CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000105316722D0>]}
[0m01:18:13.001125 [debug] [MainThread]: Flushing usage events
[0m01:18:13.972156 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:22:08.465592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002736C1429C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002736B914860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002736B917920>]}


============================== 01:22:08.465592 | e225fca3-d8d2-415e-af53-cab95c3ea685 ==============================
[0m01:22:08.465592 [info ] [MainThread]: Running with dbt=1.10.1
[0m01:22:08.481333 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\ThembaniFaleni\\.dbt', 'log_path': 'C:\\dbt_workspace\\Slip_Tests\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m01:22:09.178072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e225fca3-d8d2-415e-af53-cab95c3ea685', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002736E92A0F0>]}
[0m01:22:09.321438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e225fca3-d8d2-415e-af53-cab95c3ea685', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002736EE0AC30>]}
[0m01:22:09.321438 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m01:22:09.521794 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m01:22:09.651309 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'tests' in "<unicode string>", line 71, column 5 in file
`models\schema.yml`
[0m01:22:09.651309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e225fca3-d8d2-415e-af53-cab95c3ea685', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002736EEA58B0>]}
[0m01:22:09.700225 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m01:22:09.700225 [debug] [MainThread]: Partial parsing: added file: Slip_Tests://models\schema.yml
[0m01:22:09.700225 [debug] [MainThread]: Partial parsing: added file: Slip_Tests://models\sources.yaml
[0m01:22:09.841852 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two schema.yml entries for the same resource named dim_movies. Resources and their associated columns may only be described a single time. To fix this, remove the resource entry for dim_movies in one of these files:
   - models\schema.yml
  models\staging\schema.yml
[0m01:22:09.841852 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m01:22:09.841852 [debug] [MainThread]: Command `dbt test` failed at 01:22:09.841852 after 1.65 seconds
[0m01:22:09.841852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002736B914860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002736CC43050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002736F39B2F0>]}
[0m01:22:09.841852 [debug] [MainThread]: Flushing usage events
[0m01:22:10.931022 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:26:14.310895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A10C938CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A110375E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A110374D70>]}


============================== 01:26:14.318405 | 858beea3-7450-4200-90fd-24604eae9bcf ==============================
[0m01:26:14.318405 [info ] [MainThread]: Running with dbt=1.10.1
[0m01:26:14.318405 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ThembaniFaleni\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\dbt_workspace\\Slip_Tests\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m01:26:15.024014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '858beea3-7450-4200-90fd-24604eae9bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A10FD25490>]}
[0m01:26:15.197001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '858beea3-7450-4200-90fd-24604eae9bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A112358470>]}
[0m01:26:15.197001 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m01:26:15.387228 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m01:26:15.513097 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'tests' in "<unicode string>", line 71, column 5 in file
`models\schema.yml`
[0m01:26:15.513097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '858beea3-7450-4200-90fd-24604eae9bcf', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A112E41640>]}
[0m01:26:15.577161 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 2 files added, 0 files changed.
[0m01:26:15.577161 [debug] [MainThread]: Partial parsing: added file: Slip_Tests://models\schema.yml
[0m01:26:15.578161 [debug] [MainThread]: Partial parsing: added file: Slip_Tests://models\sources.yaml
[0m01:26:16.623305 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'fct_rating' in the 'models' section of file 'models\schema.yml'
[0m01:26:17.172294 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.Slip_Tests.not_null_fct_rating_user_id.140768c4a8' (models\schema.yml) depends on a node named 'fct_rating' in package '' which was not found
[0m01:26:17.172294 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.Slip_Tests.not_null_fct_rating_movie_id.e7004ba604' (models\schema.yml) depends on a node named 'fct_rating' in package '' which was not found
[0m01:26:17.172294 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.Slip_Tests.not_null_fct_rating_rating.2f45ab1d54' (models\schema.yml) depends on a node named 'fct_rating' in package '' which was not found
[0m01:26:17.184940 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.Slip_Tests.dbt_utils_expression_is_true_fct_rating__select_sum_rating_from_ref_src_ratings_select_sum_rating_from_ref_fct_rating_.f8623932f1' (models\schema.yml) depends on a node named 'fct_rating' in package '' which was not found
[0m01:26:17.184940 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.Slip_Tests.dbt_utils_expression_is_true_fct_rating__select_sum_rating_from_ref_src_ratings_select_sum_rating_from_ref_fct_rating_.f8623932f1' (models\schema.yml) depends on a node named 'fct_rating' in package '' which was not found
[0m01:26:17.272969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '858beea3-7450-4200-90fd-24604eae9bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1130FC1A0>]}
[0m01:26:17.355328 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m01:26:17.373404 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m01:26:17.406343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '858beea3-7450-4200-90fd-24604eae9bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A11324E8D0>]}
[0m01:26:17.406343 [info ] [MainThread]: Found 12 models, 1 snapshot, 12 data tests, 6 sources, 592 macros
[0m01:26:17.406343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '858beea3-7450-4200-90fd-24604eae9bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1133559A0>]}
[0m01:26:17.406343 [info ] [MainThread]: 
[0m01:26:17.406343 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:26:17.416709 [info ] [MainThread]: 
[0m01:26:17.417258 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:26:17.425089 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MOVIELENS_snapshots'
[0m01:26:17.488565 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m01:26:17.489558 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
alter session set quoted_identifiers_ignore_case = false;
[0m01:26:17.489558 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:26:19.122515 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.635 seconds
[0m01:26:19.129033 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m01:26:19.129033 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
show objects in MOVIELENS.snapshots
    limit 10000
    
;
[0m01:26:19.378701 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.251 seconds
[0m01:26:19.378701 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m01:26:19.378701 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
alter session unset quoted_identifiers_ignore_case;
[0m01:26:19.662037 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.276 seconds
[0m01:26:19.662037 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MOVIELENS_snapshots, now list_MOVIELENS_DEV)
[0m01:26:19.662037 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m01:26:19.662037 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session set quoted_identifiers_ignore_case = false;
[0m01:26:19.913331 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.251 seconds
[0m01:26:19.913331 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m01:26:19.923845 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
show objects in MOVIELENS.DEV
    limit 10000
    
;
[0m01:26:20.147369 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.233 seconds
[0m01:26:20.147369 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m01:26:20.147369 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session unset quoted_identifiers_ignore_case;
[0m01:26:20.350830 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.202 seconds
[0m01:26:20.366266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '858beea3-7450-4200-90fd-24604eae9bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A113214E30>]}
[0m01:26:20.366266 [debug] [Thread-1 (]: Began running node test.Slip_Tests.dbt_utils_equal_rowcount_fct_genome_score_ref_src_genome_score_.c5d70ca0d7
[0m01:26:20.366266 [info ] [Thread-1 (]: 1 of 12 START test dbt_utils_equal_rowcount_fct_genome_score_ref_src_genome_score_  [RUN]
[0m01:26:20.366266 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.Slip_Tests.dbt_utils_equal_rowcount_fct_genome_score_ref_src_genome_score_.c5d70ca0d7'
[0m01:26:20.366266 [debug] [Thread-1 (]: Began compiling node test.Slip_Tests.dbt_utils_equal_rowcount_fct_genome_score_ref_src_genome_score_.c5d70ca0d7
[0m01:26:20.381993 [debug] [Thread-1 (]: Writing injected SQL for node "test.Slip_Tests.dbt_utils_equal_rowcount_fct_genome_score_ref_src_genome_score_.c5d70ca0d7"
[0m01:26:20.381993 [debug] [Thread-1 (]: Began executing node test.Slip_Tests.dbt_utils_equal_rowcount_fct_genome_score_ref_src_genome_score_.c5d70ca0d7
[0m01:26:20.413139 [debug] [Thread-1 (]: Writing runtime sql for node "test.Slip_Tests.dbt_utils_equal_rowcount_fct_genome_score_ref_src_genome_score_.c5d70ca0d7"
[0m01:26:20.413139 [debug] [Thread-1 (]: Using snowflake connection "test.Slip_Tests.dbt_utils_equal_rowcount_fct_genome_score_ref_src_genome_score_.c5d70ca0d7"
[0m01:26:20.413139 [debug] [Thread-1 (]: On test.Slip_Tests.dbt_utils_equal_rowcount_fct_genome_score_ref_src_genome_score_.c5d70ca0d7: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "test.Slip_Tests.dbt_utils_equal_rowcount_fct_genome_score_ref_src_genome_score_.c5d70ca0d7"} */
select
      sum(coalesce(diff_count, 0)) as failures,
      sum(coalesce(diff_count, 0)) != 0 as should_warn,
      sum(coalesce(diff_count, 0)) != 0 as should_error
    from (
      
    
  




with a as (

    select 
      
      1 as id_dbtutils_test_equal_rowcount,
      count(*) as count_a 
    from MOVIELENS.DEV.fct_genome_score
    group by id_dbtutils_test_equal_rowcount


),
b as (

    select 
      
      1 as id_dbtutils_test_equal_rowcount,
      count(*) as count_b 
    from MOVIELENS.DEV.src_genome_score
    group by id_dbtutils_test_equal_rowcount

),
final as (

    select
    
        a.id_dbtutils_test_equal_rowcount as id_dbtutils_test_equal_rowcount_a,
          b.id_dbtutils_test_equal_rowcount as id_dbtutils_test_equal_rowcount_b,
        

        count_a,
        count_b,
        abs(count_a - count_b) as diff_count

    from a
    full join b
    on
    a.id_dbtutils_test_equal_rowcount = b.id_dbtutils_test_equal_rowcount
    


)

select * from final


  
  
      
    ) dbt_internal_test
[0m01:26:20.413139 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:26:21.464071 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.049 seconds
[0m01:26:21.464071 [info ] [Thread-1 (]: 1 of 12 PASS dbt_utils_equal_rowcount_fct_genome_score_ref_src_genome_score_ ... [[32mPASS[0m in 1.10s]
[0m01:26:21.464071 [debug] [Thread-1 (]: Finished running node test.Slip_Tests.dbt_utils_equal_rowcount_fct_genome_score_ref_src_genome_score_.c5d70ca0d7
[0m01:26:21.464071 [debug] [Thread-1 (]: Began running node test.Slip_Tests.dbt_utils_equal_rowcount_snap_tags_ref_src_tags_.78963607ce
[0m01:26:21.464071 [info ] [Thread-1 (]: 2 of 12 START test dbt_utils_equal_rowcount_snap_tags_ref_src_tags_ ............ [RUN]
[0m01:26:21.464071 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Slip_Tests.dbt_utils_equal_rowcount_fct_genome_score_ref_src_genome_score_.c5d70ca0d7, now test.Slip_Tests.dbt_utils_equal_rowcount_snap_tags_ref_src_tags_.78963607ce)
[0m01:26:21.464071 [debug] [Thread-1 (]: Began compiling node test.Slip_Tests.dbt_utils_equal_rowcount_snap_tags_ref_src_tags_.78963607ce
[0m01:26:21.479649 [debug] [Thread-1 (]: Writing injected SQL for node "test.Slip_Tests.dbt_utils_equal_rowcount_snap_tags_ref_src_tags_.78963607ce"
[0m01:26:21.479649 [debug] [Thread-1 (]: Began executing node test.Slip_Tests.dbt_utils_equal_rowcount_snap_tags_ref_src_tags_.78963607ce
[0m01:26:21.479649 [debug] [Thread-1 (]: Writing runtime sql for node "test.Slip_Tests.dbt_utils_equal_rowcount_snap_tags_ref_src_tags_.78963607ce"
[0m01:26:21.479649 [debug] [Thread-1 (]: Using snowflake connection "test.Slip_Tests.dbt_utils_equal_rowcount_snap_tags_ref_src_tags_.78963607ce"
[0m01:26:21.479649 [debug] [Thread-1 (]: On test.Slip_Tests.dbt_utils_equal_rowcount_snap_tags_ref_src_tags_.78963607ce: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "test.Slip_Tests.dbt_utils_equal_rowcount_snap_tags_ref_src_tags_.78963607ce"} */
select
      sum(coalesce(diff_count, 0)) as failures,
      sum(coalesce(diff_count, 0)) != 0 as should_warn,
      sum(coalesce(diff_count, 0)) != 0 as should_error
    from (
      
    
  




with a as (

    select 
      
      1 as id_dbtutils_test_equal_rowcount,
      count(*) as count_a 
    from MOVIELENS.snapshots.snap_tags
    group by id_dbtutils_test_equal_rowcount


),
b as (

    select 
      
      1 as id_dbtutils_test_equal_rowcount,
      count(*) as count_b 
    from MOVIELENS.DEV.src_tags
    group by id_dbtutils_test_equal_rowcount

),
final as (

    select
    
        a.id_dbtutils_test_equal_rowcount as id_dbtutils_test_equal_rowcount_a,
          b.id_dbtutils_test_equal_rowcount as id_dbtutils_test_equal_rowcount_b,
        

        count_a,
        count_b,
        abs(count_a - count_b) as diff_count

    from a
    full join b
    on
    a.id_dbtutils_test_equal_rowcount = b.id_dbtutils_test_equal_rowcount
    


)

select * from final


  
  
      
    ) dbt_internal_test
[0m01:26:21.714538 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.235 seconds
[0m01:26:21.714538 [info ] [Thread-1 (]: 2 of 12 PASS dbt_utils_equal_rowcount_snap_tags_ref_src_tags_ .................. [[32mPASS[0m in 0.25s]
[0m01:26:21.730224 [debug] [Thread-1 (]: Finished running node test.Slip_Tests.dbt_utils_equal_rowcount_snap_tags_ref_src_tags_.78963607ce
[0m01:26:21.730224 [debug] [Thread-1 (]: Began running node test.Slip_Tests.not_null_dim_movies_movie_id.0f96ca970d
[0m01:26:21.730224 [info ] [Thread-1 (]: 3 of 12 START test not_null_dim_movies_movie_id ................................ [RUN]
[0m01:26:21.730224 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Slip_Tests.dbt_utils_equal_rowcount_snap_tags_ref_src_tags_.78963607ce, now test.Slip_Tests.not_null_dim_movies_movie_id.0f96ca970d)
[0m01:26:21.730224 [debug] [Thread-1 (]: Began compiling node test.Slip_Tests.not_null_dim_movies_movie_id.0f96ca970d
[0m01:26:21.730224 [debug] [Thread-1 (]: Writing injected SQL for node "test.Slip_Tests.not_null_dim_movies_movie_id.0f96ca970d"
[0m01:26:21.730224 [debug] [Thread-1 (]: Began executing node test.Slip_Tests.not_null_dim_movies_movie_id.0f96ca970d
[0m01:26:21.745948 [debug] [Thread-1 (]: Writing runtime sql for node "test.Slip_Tests.not_null_dim_movies_movie_id.0f96ca970d"
[0m01:26:21.748616 [debug] [Thread-1 (]: Using snowflake connection "test.Slip_Tests.not_null_dim_movies_movie_id.0f96ca970d"
[0m01:26:21.749110 [debug] [Thread-1 (]: On test.Slip_Tests.not_null_dim_movies_movie_id.0f96ca970d: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "test.Slip_Tests.not_null_dim_movies_movie_id.0f96ca970d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select movie_id
from MOVIELENS.DEV.dim_movies
where movie_id is null



  
  
      
    ) dbt_internal_test
[0m01:26:21.980323 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.233 seconds
[0m01:26:21.980323 [info ] [Thread-1 (]: 3 of 12 PASS not_null_dim_movies_movie_id ...................................... [[32mPASS[0m in 0.25s]
[0m01:26:21.980323 [debug] [Thread-1 (]: Finished running node test.Slip_Tests.not_null_dim_movies_movie_id.0f96ca970d
[0m01:26:21.980323 [debug] [Thread-1 (]: Began running node test.Slip_Tests.not_null_dim_movies_movie_title.0206534c81
[0m01:26:21.980323 [info ] [Thread-1 (]: 4 of 12 START test not_null_dim_movies_movie_title ............................. [RUN]
[0m01:26:21.980323 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Slip_Tests.not_null_dim_movies_movie_id.0f96ca970d, now test.Slip_Tests.not_null_dim_movies_movie_title.0206534c81)
[0m01:26:21.980323 [debug] [Thread-1 (]: Began compiling node test.Slip_Tests.not_null_dim_movies_movie_title.0206534c81
[0m01:26:21.995794 [debug] [Thread-1 (]: Writing injected SQL for node "test.Slip_Tests.not_null_dim_movies_movie_title.0206534c81"
[0m01:26:21.996852 [debug] [Thread-1 (]: Began executing node test.Slip_Tests.not_null_dim_movies_movie_title.0206534c81
[0m01:26:21.999672 [debug] [Thread-1 (]: Writing runtime sql for node "test.Slip_Tests.not_null_dim_movies_movie_title.0206534c81"
[0m01:26:22.001999 [debug] [Thread-1 (]: Using snowflake connection "test.Slip_Tests.not_null_dim_movies_movie_title.0206534c81"
[0m01:26:22.004059 [debug] [Thread-1 (]: On test.Slip_Tests.not_null_dim_movies_movie_title.0206534c81: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "test.Slip_Tests.not_null_dim_movies_movie_title.0206534c81"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select movie_title
from MOVIELENS.DEV.dim_movies
where movie_title is null



  
  
      
    ) dbt_internal_test
[0m01:26:22.229510 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.225 seconds
[0m01:26:22.232521 [info ] [Thread-1 (]: 4 of 12 PASS not_null_dim_movies_movie_title ................................... [[32mPASS[0m in 0.25s]
[0m01:26:22.233517 [debug] [Thread-1 (]: Finished running node test.Slip_Tests.not_null_dim_movies_movie_title.0206534c81
[0m01:26:22.233517 [debug] [Thread-1 (]: Began running node test.Slip_Tests.not_null_fct_genome_score_movie_id.a06a45d2b3
[0m01:26:22.234566 [info ] [Thread-1 (]: 5 of 12 START test not_null_fct_genome_score_movie_id .......................... [RUN]
[0m01:26:22.234566 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Slip_Tests.not_null_dim_movies_movie_title.0206534c81, now test.Slip_Tests.not_null_fct_genome_score_movie_id.a06a45d2b3)
[0m01:26:22.235521 [debug] [Thread-1 (]: Began compiling node test.Slip_Tests.not_null_fct_genome_score_movie_id.a06a45d2b3
[0m01:26:22.240098 [debug] [Thread-1 (]: Writing injected SQL for node "test.Slip_Tests.not_null_fct_genome_score_movie_id.a06a45d2b3"
[0m01:26:22.241098 [debug] [Thread-1 (]: Began executing node test.Slip_Tests.not_null_fct_genome_score_movie_id.a06a45d2b3
[0m01:26:22.244098 [debug] [Thread-1 (]: Writing runtime sql for node "test.Slip_Tests.not_null_fct_genome_score_movie_id.a06a45d2b3"
[0m01:26:22.247079 [debug] [Thread-1 (]: Using snowflake connection "test.Slip_Tests.not_null_fct_genome_score_movie_id.a06a45d2b3"
[0m01:26:22.248085 [debug] [Thread-1 (]: On test.Slip_Tests.not_null_fct_genome_score_movie_id.a06a45d2b3: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "test.Slip_Tests.not_null_fct_genome_score_movie_id.a06a45d2b3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select movie_id
from MOVIELENS.DEV.fct_genome_score
where movie_id is null



  
  
      
    ) dbt_internal_test
[0m01:26:22.444472 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.196 seconds
[0m01:26:22.446571 [info ] [Thread-1 (]: 5 of 12 PASS not_null_fct_genome_score_movie_id ................................ [[32mPASS[0m in 0.21s]
[0m01:26:22.448477 [debug] [Thread-1 (]: Finished running node test.Slip_Tests.not_null_fct_genome_score_movie_id.a06a45d2b3
[0m01:26:22.448477 [debug] [Thread-1 (]: Began running node test.Slip_Tests.not_null_fct_genome_score_relevance_score.c1509905ec
[0m01:26:22.449476 [info ] [Thread-1 (]: 6 of 12 START test not_null_fct_genome_score_relevance_score ................... [RUN]
[0m01:26:22.450666 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Slip_Tests.not_null_fct_genome_score_movie_id.a06a45d2b3, now test.Slip_Tests.not_null_fct_genome_score_relevance_score.c1509905ec)
[0m01:26:22.450761 [debug] [Thread-1 (]: Began compiling node test.Slip_Tests.not_null_fct_genome_score_relevance_score.c1509905ec
[0m01:26:22.454863 [debug] [Thread-1 (]: Writing injected SQL for node "test.Slip_Tests.not_null_fct_genome_score_relevance_score.c1509905ec"
[0m01:26:22.456769 [debug] [Thread-1 (]: Began executing node test.Slip_Tests.not_null_fct_genome_score_relevance_score.c1509905ec
[0m01:26:22.458878 [debug] [Thread-1 (]: Writing runtime sql for node "test.Slip_Tests.not_null_fct_genome_score_relevance_score.c1509905ec"
[0m01:26:22.459792 [debug] [Thread-1 (]: Using snowflake connection "test.Slip_Tests.not_null_fct_genome_score_relevance_score.c1509905ec"
[0m01:26:22.460775 [debug] [Thread-1 (]: On test.Slip_Tests.not_null_fct_genome_score_relevance_score.c1509905ec: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "test.Slip_Tests.not_null_fct_genome_score_relevance_score.c1509905ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select relevance_score
from MOVIELENS.DEV.fct_genome_score
where relevance_score is null



  
  
      
    ) dbt_internal_test
[0m01:26:22.661410 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.200 seconds
[0m01:26:22.665401 [info ] [Thread-1 (]: 6 of 12 PASS not_null_fct_genome_score_relevance_score ......................... [[32mPASS[0m in 0.21s]
[0m01:26:22.667437 [debug] [Thread-1 (]: Finished running node test.Slip_Tests.not_null_fct_genome_score_relevance_score.c1509905ec
[0m01:26:22.667437 [debug] [Thread-1 (]: Began running node test.Slip_Tests.not_null_fct_genome_score_tag_id.5d40275b2b
[0m01:26:22.668436 [info ] [Thread-1 (]: 7 of 12 START test not_null_fct_genome_score_tag_id ............................ [RUN]
[0m01:26:22.668436 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Slip_Tests.not_null_fct_genome_score_relevance_score.c1509905ec, now test.Slip_Tests.not_null_fct_genome_score_tag_id.5d40275b2b)
[0m01:26:22.669437 [debug] [Thread-1 (]: Began compiling node test.Slip_Tests.not_null_fct_genome_score_tag_id.5d40275b2b
[0m01:26:22.670533 [debug] [Thread-1 (]: Writing injected SQL for node "test.Slip_Tests.not_null_fct_genome_score_tag_id.5d40275b2b"
[0m01:26:22.670533 [debug] [Thread-1 (]: Began executing node test.Slip_Tests.not_null_fct_genome_score_tag_id.5d40275b2b
[0m01:26:22.670533 [debug] [Thread-1 (]: Writing runtime sql for node "test.Slip_Tests.not_null_fct_genome_score_tag_id.5d40275b2b"
[0m01:26:22.670533 [debug] [Thread-1 (]: Using snowflake connection "test.Slip_Tests.not_null_fct_genome_score_tag_id.5d40275b2b"
[0m01:26:22.670533 [debug] [Thread-1 (]: On test.Slip_Tests.not_null_fct_genome_score_tag_id.5d40275b2b: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "test.Slip_Tests.not_null_fct_genome_score_tag_id.5d40275b2b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select tag_id
from MOVIELENS.DEV.fct_genome_score
where tag_id is null



  
  
      
    ) dbt_internal_test
[0m01:26:22.896928 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.231 seconds
[0m01:26:22.912550 [info ] [Thread-1 (]: 7 of 12 PASS not_null_fct_genome_score_tag_id .................................. [[32mPASS[0m in 0.24s]
[0m01:26:22.912550 [debug] [Thread-1 (]: Finished running node test.Slip_Tests.not_null_fct_genome_score_tag_id.5d40275b2b
[0m01:26:22.912550 [debug] [Thread-1 (]: Began running node test.Slip_Tests.not_null_snap_tags_id.015a2066c2
[0m01:26:22.912550 [info ] [Thread-1 (]: 8 of 12 START test not_null_snap_tags_id ....................................... [RUN]
[0m01:26:22.912550 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Slip_Tests.not_null_fct_genome_score_tag_id.5d40275b2b, now test.Slip_Tests.not_null_snap_tags_id.015a2066c2)
[0m01:26:22.912550 [debug] [Thread-1 (]: Began compiling node test.Slip_Tests.not_null_snap_tags_id.015a2066c2
[0m01:26:22.912550 [debug] [Thread-1 (]: Writing injected SQL for node "test.Slip_Tests.not_null_snap_tags_id.015a2066c2"
[0m01:26:22.912550 [debug] [Thread-1 (]: Began executing node test.Slip_Tests.not_null_snap_tags_id.015a2066c2
[0m01:26:22.929309 [debug] [Thread-1 (]: Writing runtime sql for node "test.Slip_Tests.not_null_snap_tags_id.015a2066c2"
[0m01:26:22.930836 [debug] [Thread-1 (]: Using snowflake connection "test.Slip_Tests.not_null_snap_tags_id.015a2066c2"
[0m01:26:22.931862 [debug] [Thread-1 (]: On test.Slip_Tests.not_null_snap_tags_id.015a2066c2: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "test.Slip_Tests.not_null_snap_tags_id.015a2066c2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from MOVIELENS.snapshots.snap_tags
where id is null



  
  
      
    ) dbt_internal_test
[0m01:26:23.130807 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.208 seconds
[0m01:26:23.130807 [info ] [Thread-1 (]: 8 of 12 PASS not_null_snap_tags_id ............................................. [[32mPASS[0m in 0.22s]
[0m01:26:23.144871 [debug] [Thread-1 (]: Finished running node test.Slip_Tests.not_null_snap_tags_id.015a2066c2
[0m01:26:23.144871 [debug] [Thread-1 (]: Began running node test.Slip_Tests.not_null_snap_tags_movie_id.fb9962de5f
[0m01:26:23.144871 [info ] [Thread-1 (]: 9 of 12 START test not_null_snap_tags_movie_id ................................. [RUN]
[0m01:26:23.144871 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Slip_Tests.not_null_snap_tags_id.015a2066c2, now test.Slip_Tests.not_null_snap_tags_movie_id.fb9962de5f)
[0m01:26:23.144871 [debug] [Thread-1 (]: Began compiling node test.Slip_Tests.not_null_snap_tags_movie_id.fb9962de5f
[0m01:26:23.144871 [debug] [Thread-1 (]: Writing injected SQL for node "test.Slip_Tests.not_null_snap_tags_movie_id.fb9962de5f"
[0m01:26:23.144871 [debug] [Thread-1 (]: Began executing node test.Slip_Tests.not_null_snap_tags_movie_id.fb9962de5f
[0m01:26:23.144871 [debug] [Thread-1 (]: Writing runtime sql for node "test.Slip_Tests.not_null_snap_tags_movie_id.fb9962de5f"
[0m01:26:23.162248 [debug] [Thread-1 (]: Using snowflake connection "test.Slip_Tests.not_null_snap_tags_movie_id.fb9962de5f"
[0m01:26:23.162431 [debug] [Thread-1 (]: On test.Slip_Tests.not_null_snap_tags_movie_id.fb9962de5f: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "test.Slip_Tests.not_null_snap_tags_movie_id.fb9962de5f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select movie_id
from MOVIELENS.snapshots.snap_tags
where movie_id is null



  
  
      
    ) dbt_internal_test
[0m01:26:23.395136 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.236 seconds
[0m01:26:23.395136 [info ] [Thread-1 (]: 9 of 12 PASS not_null_snap_tags_movie_id ....................................... [[32mPASS[0m in 0.25s]
[0m01:26:23.395136 [debug] [Thread-1 (]: Finished running node test.Slip_Tests.not_null_snap_tags_movie_id.fb9962de5f
[0m01:26:23.395136 [debug] [Thread-1 (]: Began running node test.Slip_Tests.not_null_snap_tags_tag.b66ecb49f3
[0m01:26:23.395136 [info ] [Thread-1 (]: 10 of 12 START test not_null_snap_tags_tag ..................................... [RUN]
[0m01:26:23.395136 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Slip_Tests.not_null_snap_tags_movie_id.fb9962de5f, now test.Slip_Tests.not_null_snap_tags_tag.b66ecb49f3)
[0m01:26:23.411752 [debug] [Thread-1 (]: Began compiling node test.Slip_Tests.not_null_snap_tags_tag.b66ecb49f3
[0m01:26:23.424164 [debug] [Thread-1 (]: Writing injected SQL for node "test.Slip_Tests.not_null_snap_tags_tag.b66ecb49f3"
[0m01:26:23.428175 [debug] [Thread-1 (]: Began executing node test.Slip_Tests.not_null_snap_tags_tag.b66ecb49f3
[0m01:26:23.489389 [debug] [Thread-1 (]: Writing runtime sql for node "test.Slip_Tests.not_null_snap_tags_tag.b66ecb49f3"
[0m01:26:23.490384 [debug] [Thread-1 (]: Using snowflake connection "test.Slip_Tests.not_null_snap_tags_tag.b66ecb49f3"
[0m01:26:23.491278 [debug] [Thread-1 (]: On test.Slip_Tests.not_null_snap_tags_tag.b66ecb49f3: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "test.Slip_Tests.not_null_snap_tags_tag.b66ecb49f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select tag
from MOVIELENS.snapshots.snap_tags
where tag is null



  
  
      
    ) dbt_internal_test
[0m01:26:23.706137 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.214 seconds
[0m01:26:23.709855 [info ] [Thread-1 (]: 10 of 12 PASS not_null_snap_tags_tag ........................................... [[32mPASS[0m in 0.31s]
[0m01:26:23.711334 [debug] [Thread-1 (]: Finished running node test.Slip_Tests.not_null_snap_tags_tag.b66ecb49f3
[0m01:26:23.711920 [debug] [Thread-1 (]: Began running node test.Slip_Tests.not_null_snap_tags_user_id.a9aef7cace
[0m01:26:23.712426 [info ] [Thread-1 (]: 11 of 12 START test not_null_snap_tags_user_id ................................. [RUN]
[0m01:26:23.713549 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Slip_Tests.not_null_snap_tags_tag.b66ecb49f3, now test.Slip_Tests.not_null_snap_tags_user_id.a9aef7cace)
[0m01:26:23.714117 [debug] [Thread-1 (]: Began compiling node test.Slip_Tests.not_null_snap_tags_user_id.a9aef7cace
[0m01:26:23.719922 [debug] [Thread-1 (]: Writing injected SQL for node "test.Slip_Tests.not_null_snap_tags_user_id.a9aef7cace"
[0m01:26:23.721617 [debug] [Thread-1 (]: Began executing node test.Slip_Tests.not_null_snap_tags_user_id.a9aef7cace
[0m01:26:23.724526 [debug] [Thread-1 (]: Writing runtime sql for node "test.Slip_Tests.not_null_snap_tags_user_id.a9aef7cace"
[0m01:26:23.726303 [debug] [Thread-1 (]: Using snowflake connection "test.Slip_Tests.not_null_snap_tags_user_id.a9aef7cace"
[0m01:26:23.726885 [debug] [Thread-1 (]: On test.Slip_Tests.not_null_snap_tags_user_id.a9aef7cace: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "test.Slip_Tests.not_null_snap_tags_user_id.a9aef7cace"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from MOVIELENS.snapshots.snap_tags
where user_id is null



  
  
      
    ) dbt_internal_test
[0m01:26:23.932943 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.209 seconds
[0m01:26:23.932943 [info ] [Thread-1 (]: 11 of 12 PASS not_null_snap_tags_user_id ....................................... [[32mPASS[0m in 0.22s]
[0m01:26:23.932943 [debug] [Thread-1 (]: Finished running node test.Slip_Tests.not_null_snap_tags_user_id.a9aef7cace
[0m01:26:23.932943 [debug] [Thread-1 (]: Began running node test.Slip_Tests.unique_snap_tags_id.4ac4f44417
[0m01:26:23.932943 [info ] [Thread-1 (]: 12 of 12 START test unique_snap_tags_id ........................................ [RUN]
[0m01:26:23.932943 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Slip_Tests.not_null_snap_tags_user_id.a9aef7cace, now test.Slip_Tests.unique_snap_tags_id.4ac4f44417)
[0m01:26:23.932943 [debug] [Thread-1 (]: Began compiling node test.Slip_Tests.unique_snap_tags_id.4ac4f44417
[0m01:26:23.957130 [debug] [Thread-1 (]: Writing injected SQL for node "test.Slip_Tests.unique_snap_tags_id.4ac4f44417"
[0m01:26:23.957130 [debug] [Thread-1 (]: Began executing node test.Slip_Tests.unique_snap_tags_id.4ac4f44417
[0m01:26:23.973336 [debug] [Thread-1 (]: Writing runtime sql for node "test.Slip_Tests.unique_snap_tags_id.4ac4f44417"
[0m01:26:23.977396 [debug] [Thread-1 (]: Using snowflake connection "test.Slip_Tests.unique_snap_tags_id.4ac4f44417"
[0m01:26:23.977706 [debug] [Thread-1 (]: On test.Slip_Tests.unique_snap_tags_id.4ac4f44417: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "test.Slip_Tests.unique_snap_tags_id.4ac4f44417"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from MOVIELENS.snapshots.snap_tags
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:26:24.179713 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.210 seconds
[0m01:26:24.179713 [info ] [Thread-1 (]: 12 of 12 PASS unique_snap_tags_id .............................................. [[32mPASS[0m in 0.25s]
[0m01:26:24.179713 [debug] [Thread-1 (]: Finished running node test.Slip_Tests.unique_snap_tags_id.4ac4f44417
[0m01:26:24.195184 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:26:24.195184 [debug] [MainThread]: Connection 'list_MOVIELENS_DEV' was left open.
[0m01:26:24.195184 [debug] [MainThread]: On list_MOVIELENS_DEV: Close
[0m01:26:24.538322 [debug] [MainThread]: Connection 'test.Slip_Tests.unique_snap_tags_id.4ac4f44417' was left open.
[0m01:26:24.553969 [debug] [MainThread]: On test.Slip_Tests.unique_snap_tags_id.4ac4f44417: Close
[0m01:26:24.912529 [info ] [MainThread]: 
[0m01:26:24.912529 [info ] [MainThread]: Finished running 12 data tests in 0 hours 0 minutes and 7.50 seconds (7.50s).
[0m01:26:24.912529 [debug] [MainThread]: Command end result
[0m01:26:24.940096 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m01:26:24.940096 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m01:26:24.959095 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\dbt_workspace\Slip_Tests\target\run_results.json
[0m01:26:24.959095 [info ] [MainThread]: 
[0m01:26:24.959095 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:26:24.959095 [info ] [MainThread]: 
[0m01:26:24.959095 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=12
[0m01:26:24.959095 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m01:26:24.970270 [debug] [MainThread]: Command `dbt test` succeeded at 01:26:24.970270 after 10.90 seconds
[0m01:26:24.970270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1104D9E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A10F4C4080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A10F4C4860>]}
[0m01:26:24.971272 [debug] [MainThread]: Flushing usage events
[0m01:26:26.025112 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:26:36.603909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9BBFF52B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9BEAAFA70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9BEAAF980>]}


============================== 01:26:36.620231 | 64b3df1d-9a33-4d9d-acbe-3838a1e3f69a ==============================
[0m01:26:36.620231 [info ] [MainThread]: Running with dbt=1.10.1
[0m01:26:36.620231 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ThembaniFaleni\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\dbt_workspace\\Slip_Tests\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt test', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:26:37.310355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '64b3df1d-9a33-4d9d-acbe-3838a1e3f69a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9BEE71880>]}
[0m01:26:37.467161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '64b3df1d-9a33-4d9d-acbe-3838a1e3f69a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9BC0FA180>]}
[0m01:26:37.467161 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m01:26:37.659140 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m01:26:37.832325 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:26:37.832325 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:26:37.895587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '64b3df1d-9a33-4d9d-acbe-3838a1e3f69a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9C1424E60>]}
[0m01:26:38.029593 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m01:26:38.045215 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m01:26:38.077080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '64b3df1d-9a33-4d9d-acbe-3838a1e3f69a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9BEF852B0>]}
[0m01:26:38.077080 [info ] [MainThread]: Found 12 models, 1 snapshot, 12 data tests, 6 sources, 592 macros
[0m01:26:38.077080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64b3df1d-9a33-4d9d-acbe-3838a1e3f69a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9C11D20C0>]}
[0m01:26:38.077080 [info ] [MainThread]: 
[0m01:26:38.077080 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:26:38.077080 [info ] [MainThread]: 
[0m01:26:38.077080 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:26:38.092824 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MOVIELENS_DEV'
[0m01:26:38.170402 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m01:26:38.170402 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session set quoted_identifiers_ignore_case = false;
[0m01:26:38.171403 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:26:39.269503 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.104 seconds
[0m01:26:39.269503 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m01:26:39.269503 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
show objects in MOVIELENS.DEV
    limit 10000
    
;
[0m01:26:39.505401 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.238 seconds
[0m01:26:39.521157 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m01:26:39.521157 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session unset quoted_identifiers_ignore_case;
[0m01:26:39.722886 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.204 seconds
[0m01:26:39.722886 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MOVIELENS_DEV, now list_MOVIELENS_snapshots)
[0m01:26:39.722886 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m01:26:39.722886 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
alter session set quoted_identifiers_ignore_case = false;
[0m01:26:39.943077 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.210 seconds
[0m01:26:39.943077 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m01:26:39.943077 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
show objects in MOVIELENS.snapshots
    limit 10000
    
;
[0m01:26:40.168167 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.216 seconds
[0m01:26:40.168167 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m01:26:40.168167 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
alter session unset quoted_identifiers_ignore_case;
[0m01:26:40.382455 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.215 seconds
[0m01:26:40.382455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64b3df1d-9a33-4d9d-acbe-3838a1e3f69a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9C1273200>]}
[0m01:26:40.382455 [debug] [Thread-1 (]: Began running node test.Slip_Tests.dbt_utils_equal_rowcount_fct_genome_score_ref_src_genome_score_.c5d70ca0d7
[0m01:26:40.382455 [info ] [Thread-1 (]: 1 of 12 START test dbt_utils_equal_rowcount_fct_genome_score_ref_src_genome_score_  [RUN]
[0m01:26:40.398095 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.Slip_Tests.dbt_utils_equal_rowcount_fct_genome_score_ref_src_genome_score_.c5d70ca0d7'
[0m01:26:40.398095 [debug] [Thread-1 (]: Began compiling node test.Slip_Tests.dbt_utils_equal_rowcount_fct_genome_score_ref_src_genome_score_.c5d70ca0d7
[0m01:26:40.413727 [debug] [Thread-1 (]: Writing injected SQL for node "test.Slip_Tests.dbt_utils_equal_rowcount_fct_genome_score_ref_src_genome_score_.c5d70ca0d7"
[0m01:26:40.413727 [debug] [Thread-1 (]: Began executing node test.Slip_Tests.dbt_utils_equal_rowcount_fct_genome_score_ref_src_genome_score_.c5d70ca0d7
[0m01:26:40.446327 [debug] [Thread-1 (]: Writing runtime sql for node "test.Slip_Tests.dbt_utils_equal_rowcount_fct_genome_score_ref_src_genome_score_.c5d70ca0d7"
[0m01:26:40.446327 [debug] [Thread-1 (]: Using snowflake connection "test.Slip_Tests.dbt_utils_equal_rowcount_fct_genome_score_ref_src_genome_score_.c5d70ca0d7"
[0m01:26:40.446327 [debug] [Thread-1 (]: On test.Slip_Tests.dbt_utils_equal_rowcount_fct_genome_score_ref_src_genome_score_.c5d70ca0d7: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "test.Slip_Tests.dbt_utils_equal_rowcount_fct_genome_score_ref_src_genome_score_.c5d70ca0d7"} */
select
      sum(coalesce(diff_count, 0)) as failures,
      sum(coalesce(diff_count, 0)) != 0 as should_warn,
      sum(coalesce(diff_count, 0)) != 0 as should_error
    from (
      
    
  




with a as (

    select 
      
      1 as id_dbtutils_test_equal_rowcount,
      count(*) as count_a 
    from MOVIELENS.DEV.fct_genome_score
    group by id_dbtutils_test_equal_rowcount


),
b as (

    select 
      
      1 as id_dbtutils_test_equal_rowcount,
      count(*) as count_b 
    from MOVIELENS.DEV.src_genome_score
    group by id_dbtutils_test_equal_rowcount

),
final as (

    select
    
        a.id_dbtutils_test_equal_rowcount as id_dbtutils_test_equal_rowcount_a,
          b.id_dbtutils_test_equal_rowcount as id_dbtutils_test_equal_rowcount_b,
        

        count_a,
        count_b,
        abs(count_a - count_b) as diff_count

    from a
    full join b
    on
    a.id_dbtutils_test_equal_rowcount = b.id_dbtutils_test_equal_rowcount
    


)

select * from final


  
  
      
    ) dbt_internal_test
[0m01:26:40.446327 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:26:41.541557 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.089 seconds
[0m01:26:41.541557 [info ] [Thread-1 (]: 1 of 12 PASS dbt_utils_equal_rowcount_fct_genome_score_ref_src_genome_score_ ... [[32mPASS[0m in 1.14s]
[0m01:26:41.541557 [debug] [Thread-1 (]: Finished running node test.Slip_Tests.dbt_utils_equal_rowcount_fct_genome_score_ref_src_genome_score_.c5d70ca0d7
[0m01:26:41.541557 [debug] [Thread-1 (]: Began running node test.Slip_Tests.dbt_utils_equal_rowcount_snap_tags_ref_src_tags_.78963607ce
[0m01:26:41.541557 [info ] [Thread-1 (]: 2 of 12 START test dbt_utils_equal_rowcount_snap_tags_ref_src_tags_ ............ [RUN]
[0m01:26:41.557200 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Slip_Tests.dbt_utils_equal_rowcount_fct_genome_score_ref_src_genome_score_.c5d70ca0d7, now test.Slip_Tests.dbt_utils_equal_rowcount_snap_tags_ref_src_tags_.78963607ce)
[0m01:26:41.557200 [debug] [Thread-1 (]: Began compiling node test.Slip_Tests.dbt_utils_equal_rowcount_snap_tags_ref_src_tags_.78963607ce
[0m01:26:41.557200 [debug] [Thread-1 (]: Writing injected SQL for node "test.Slip_Tests.dbt_utils_equal_rowcount_snap_tags_ref_src_tags_.78963607ce"
[0m01:26:41.557200 [debug] [Thread-1 (]: Began executing node test.Slip_Tests.dbt_utils_equal_rowcount_snap_tags_ref_src_tags_.78963607ce
[0m01:26:41.557200 [debug] [Thread-1 (]: Writing runtime sql for node "test.Slip_Tests.dbt_utils_equal_rowcount_snap_tags_ref_src_tags_.78963607ce"
[0m01:26:41.557200 [debug] [Thread-1 (]: Using snowflake connection "test.Slip_Tests.dbt_utils_equal_rowcount_snap_tags_ref_src_tags_.78963607ce"
[0m01:26:41.557200 [debug] [Thread-1 (]: On test.Slip_Tests.dbt_utils_equal_rowcount_snap_tags_ref_src_tags_.78963607ce: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "test.Slip_Tests.dbt_utils_equal_rowcount_snap_tags_ref_src_tags_.78963607ce"} */
select
      sum(coalesce(diff_count, 0)) as failures,
      sum(coalesce(diff_count, 0)) != 0 as should_warn,
      sum(coalesce(diff_count, 0)) != 0 as should_error
    from (
      
    
  




with a as (

    select 
      
      1 as id_dbtutils_test_equal_rowcount,
      count(*) as count_a 
    from MOVIELENS.snapshots.snap_tags
    group by id_dbtutils_test_equal_rowcount


),
b as (

    select 
      
      1 as id_dbtutils_test_equal_rowcount,
      count(*) as count_b 
    from MOVIELENS.DEV.src_tags
    group by id_dbtutils_test_equal_rowcount

),
final as (

    select
    
        a.id_dbtutils_test_equal_rowcount as id_dbtutils_test_equal_rowcount_a,
          b.id_dbtutils_test_equal_rowcount as id_dbtutils_test_equal_rowcount_b,
        

        count_a,
        count_b,
        abs(count_a - count_b) as diff_count

    from a
    full join b
    on
    a.id_dbtutils_test_equal_rowcount = b.id_dbtutils_test_equal_rowcount
    


)

select * from final


  
  
      
    ) dbt_internal_test
[0m01:26:41.792507 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.228 seconds
[0m01:26:41.792507 [info ] [Thread-1 (]: 2 of 12 PASS dbt_utils_equal_rowcount_snap_tags_ref_src_tags_ .................. [[32mPASS[0m in 0.24s]
[0m01:26:41.792507 [debug] [Thread-1 (]: Finished running node test.Slip_Tests.dbt_utils_equal_rowcount_snap_tags_ref_src_tags_.78963607ce
[0m01:26:41.792507 [debug] [Thread-1 (]: Began running node test.Slip_Tests.not_null_dim_movies_movie_id.0f96ca970d
[0m01:26:41.792507 [info ] [Thread-1 (]: 3 of 12 START test not_null_dim_movies_movie_id ................................ [RUN]
[0m01:26:41.808092 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Slip_Tests.dbt_utils_equal_rowcount_snap_tags_ref_src_tags_.78963607ce, now test.Slip_Tests.not_null_dim_movies_movie_id.0f96ca970d)
[0m01:26:41.808092 [debug] [Thread-1 (]: Began compiling node test.Slip_Tests.not_null_dim_movies_movie_id.0f96ca970d
[0m01:26:41.808092 [debug] [Thread-1 (]: Writing injected SQL for node "test.Slip_Tests.not_null_dim_movies_movie_id.0f96ca970d"
[0m01:26:41.808092 [debug] [Thread-1 (]: Began executing node test.Slip_Tests.not_null_dim_movies_movie_id.0f96ca970d
[0m01:26:41.808092 [debug] [Thread-1 (]: Writing runtime sql for node "test.Slip_Tests.not_null_dim_movies_movie_id.0f96ca970d"
[0m01:26:41.823713 [debug] [Thread-1 (]: Using snowflake connection "test.Slip_Tests.not_null_dim_movies_movie_id.0f96ca970d"
[0m01:26:41.823713 [debug] [Thread-1 (]: On test.Slip_Tests.not_null_dim_movies_movie_id.0f96ca970d: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "test.Slip_Tests.not_null_dim_movies_movie_id.0f96ca970d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select movie_id
from MOVIELENS.DEV.dim_movies
where movie_id is null



  
  
      
    ) dbt_internal_test
[0m01:26:42.036603 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.219 seconds
[0m01:26:42.036603 [info ] [Thread-1 (]: 3 of 12 PASS not_null_dim_movies_movie_id ...................................... [[32mPASS[0m in 0.23s]
[0m01:26:42.036603 [debug] [Thread-1 (]: Finished running node test.Slip_Tests.not_null_dim_movies_movie_id.0f96ca970d
[0m01:26:42.036603 [debug] [Thread-1 (]: Began running node test.Slip_Tests.not_null_dim_movies_movie_title.0206534c81
[0m01:26:42.052190 [info ] [Thread-1 (]: 4 of 12 START test not_null_dim_movies_movie_title ............................. [RUN]
[0m01:26:42.052190 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Slip_Tests.not_null_dim_movies_movie_id.0f96ca970d, now test.Slip_Tests.not_null_dim_movies_movie_title.0206534c81)
[0m01:26:42.052190 [debug] [Thread-1 (]: Began compiling node test.Slip_Tests.not_null_dim_movies_movie_title.0206534c81
[0m01:26:42.052190 [debug] [Thread-1 (]: Writing injected SQL for node "test.Slip_Tests.not_null_dim_movies_movie_title.0206534c81"
[0m01:26:42.052190 [debug] [Thread-1 (]: Began executing node test.Slip_Tests.not_null_dim_movies_movie_title.0206534c81
[0m01:26:42.052190 [debug] [Thread-1 (]: Writing runtime sql for node "test.Slip_Tests.not_null_dim_movies_movie_title.0206534c81"
[0m01:26:42.052190 [debug] [Thread-1 (]: Using snowflake connection "test.Slip_Tests.not_null_dim_movies_movie_title.0206534c81"
[0m01:26:42.052190 [debug] [Thread-1 (]: On test.Slip_Tests.not_null_dim_movies_movie_title.0206534c81: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "test.Slip_Tests.not_null_dim_movies_movie_title.0206534c81"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select movie_title
from MOVIELENS.DEV.dim_movies
where movie_title is null



  
  
      
    ) dbt_internal_test
[0m01:26:42.292167 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.239 seconds
[0m01:26:42.292167 [info ] [Thread-1 (]: 4 of 12 PASS not_null_dim_movies_movie_title ................................... [[32mPASS[0m in 0.24s]
[0m01:26:42.307788 [debug] [Thread-1 (]: Finished running node test.Slip_Tests.not_null_dim_movies_movie_title.0206534c81
[0m01:26:42.307788 [debug] [Thread-1 (]: Began running node test.Slip_Tests.not_null_fct_genome_score_movie_id.a06a45d2b3
[0m01:26:42.307788 [info ] [Thread-1 (]: 5 of 12 START test not_null_fct_genome_score_movie_id .......................... [RUN]
[0m01:26:42.307788 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Slip_Tests.not_null_dim_movies_movie_title.0206534c81, now test.Slip_Tests.not_null_fct_genome_score_movie_id.a06a45d2b3)
[0m01:26:42.307788 [debug] [Thread-1 (]: Began compiling node test.Slip_Tests.not_null_fct_genome_score_movie_id.a06a45d2b3
[0m01:26:42.307788 [debug] [Thread-1 (]: Writing injected SQL for node "test.Slip_Tests.not_null_fct_genome_score_movie_id.a06a45d2b3"
[0m01:26:42.307788 [debug] [Thread-1 (]: Began executing node test.Slip_Tests.not_null_fct_genome_score_movie_id.a06a45d2b3
[0m01:26:42.307788 [debug] [Thread-1 (]: Writing runtime sql for node "test.Slip_Tests.not_null_fct_genome_score_movie_id.a06a45d2b3"
[0m01:26:42.307788 [debug] [Thread-1 (]: Using snowflake connection "test.Slip_Tests.not_null_fct_genome_score_movie_id.a06a45d2b3"
[0m01:26:42.323412 [debug] [Thread-1 (]: On test.Slip_Tests.not_null_fct_genome_score_movie_id.a06a45d2b3: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "test.Slip_Tests.not_null_fct_genome_score_movie_id.a06a45d2b3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select movie_id
from MOVIELENS.DEV.fct_genome_score
where movie_id is null



  
  
      
    ) dbt_internal_test
[0m01:26:42.521651 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.199 seconds
[0m01:26:42.521651 [info ] [Thread-1 (]: 5 of 12 PASS not_null_fct_genome_score_movie_id ................................ [[32mPASS[0m in 0.21s]
[0m01:26:42.521651 [debug] [Thread-1 (]: Finished running node test.Slip_Tests.not_null_fct_genome_score_movie_id.a06a45d2b3
[0m01:26:42.521651 [debug] [Thread-1 (]: Began running node test.Slip_Tests.not_null_fct_genome_score_relevance_score.c1509905ec
[0m01:26:42.521651 [info ] [Thread-1 (]: 6 of 12 START test not_null_fct_genome_score_relevance_score ................... [RUN]
[0m01:26:42.521651 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Slip_Tests.not_null_fct_genome_score_movie_id.a06a45d2b3, now test.Slip_Tests.not_null_fct_genome_score_relevance_score.c1509905ec)
[0m01:26:42.521651 [debug] [Thread-1 (]: Began compiling node test.Slip_Tests.not_null_fct_genome_score_relevance_score.c1509905ec
[0m01:26:42.521651 [debug] [Thread-1 (]: Writing injected SQL for node "test.Slip_Tests.not_null_fct_genome_score_relevance_score.c1509905ec"
[0m01:26:42.521651 [debug] [Thread-1 (]: Began executing node test.Slip_Tests.not_null_fct_genome_score_relevance_score.c1509905ec
[0m01:26:42.541455 [debug] [Thread-1 (]: Writing runtime sql for node "test.Slip_Tests.not_null_fct_genome_score_relevance_score.c1509905ec"
[0m01:26:42.542532 [debug] [Thread-1 (]: Using snowflake connection "test.Slip_Tests.not_null_fct_genome_score_relevance_score.c1509905ec"
[0m01:26:42.545005 [debug] [Thread-1 (]: On test.Slip_Tests.not_null_fct_genome_score_relevance_score.c1509905ec: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "test.Slip_Tests.not_null_fct_genome_score_relevance_score.c1509905ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select relevance_score
from MOVIELENS.DEV.fct_genome_score
where relevance_score is null



  
  
      
    ) dbt_internal_test
[0m01:26:42.738213 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.198 seconds
[0m01:26:42.738213 [info ] [Thread-1 (]: 6 of 12 PASS not_null_fct_genome_score_relevance_score ......................... [[32mPASS[0m in 0.22s]
[0m01:26:42.738213 [debug] [Thread-1 (]: Finished running node test.Slip_Tests.not_null_fct_genome_score_relevance_score.c1509905ec
[0m01:26:42.738213 [debug] [Thread-1 (]: Began running node test.Slip_Tests.not_null_fct_genome_score_tag_id.5d40275b2b
[0m01:26:42.738213 [info ] [Thread-1 (]: 7 of 12 START test not_null_fct_genome_score_tag_id ............................ [RUN]
[0m01:26:42.738213 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Slip_Tests.not_null_fct_genome_score_relevance_score.c1509905ec, now test.Slip_Tests.not_null_fct_genome_score_tag_id.5d40275b2b)
[0m01:26:42.738213 [debug] [Thread-1 (]: Began compiling node test.Slip_Tests.not_null_fct_genome_score_tag_id.5d40275b2b
[0m01:26:42.758016 [debug] [Thread-1 (]: Writing injected SQL for node "test.Slip_Tests.not_null_fct_genome_score_tag_id.5d40275b2b"
[0m01:26:42.759059 [debug] [Thread-1 (]: Began executing node test.Slip_Tests.not_null_fct_genome_score_tag_id.5d40275b2b
[0m01:26:42.762323 [debug] [Thread-1 (]: Writing runtime sql for node "test.Slip_Tests.not_null_fct_genome_score_tag_id.5d40275b2b"
[0m01:26:42.762323 [debug] [Thread-1 (]: Using snowflake connection "test.Slip_Tests.not_null_fct_genome_score_tag_id.5d40275b2b"
[0m01:26:42.762323 [debug] [Thread-1 (]: On test.Slip_Tests.not_null_fct_genome_score_tag_id.5d40275b2b: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "test.Slip_Tests.not_null_fct_genome_score_tag_id.5d40275b2b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select tag_id
from MOVIELENS.DEV.fct_genome_score
where tag_id is null



  
  
      
    ) dbt_internal_test
[0m01:26:43.003413 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.246 seconds
[0m01:26:43.003413 [info ] [Thread-1 (]: 7 of 12 PASS not_null_fct_genome_score_tag_id .................................. [[32mPASS[0m in 0.27s]
[0m01:26:43.003413 [debug] [Thread-1 (]: Finished running node test.Slip_Tests.not_null_fct_genome_score_tag_id.5d40275b2b
[0m01:26:43.003413 [debug] [Thread-1 (]: Began running node test.Slip_Tests.not_null_snap_tags_id.015a2066c2
[0m01:26:43.018979 [info ] [Thread-1 (]: 8 of 12 START test not_null_snap_tags_id ....................................... [RUN]
[0m01:26:43.019651 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Slip_Tests.not_null_fct_genome_score_tag_id.5d40275b2b, now test.Slip_Tests.not_null_snap_tags_id.015a2066c2)
[0m01:26:43.019651 [debug] [Thread-1 (]: Began compiling node test.Slip_Tests.not_null_snap_tags_id.015a2066c2
[0m01:26:43.019651 [debug] [Thread-1 (]: Writing injected SQL for node "test.Slip_Tests.not_null_snap_tags_id.015a2066c2"
[0m01:26:43.019651 [debug] [Thread-1 (]: Began executing node test.Slip_Tests.not_null_snap_tags_id.015a2066c2
[0m01:26:43.019651 [debug] [Thread-1 (]: Writing runtime sql for node "test.Slip_Tests.not_null_snap_tags_id.015a2066c2"
[0m01:26:43.034724 [debug] [Thread-1 (]: Using snowflake connection "test.Slip_Tests.not_null_snap_tags_id.015a2066c2"
[0m01:26:43.036508 [debug] [Thread-1 (]: On test.Slip_Tests.not_null_snap_tags_id.015a2066c2: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "test.Slip_Tests.not_null_snap_tags_id.015a2066c2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from MOVIELENS.snapshots.snap_tags
where id is null



  
  
      
    ) dbt_internal_test
[0m01:26:43.251772 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.216 seconds
[0m01:26:43.251772 [info ] [Thread-1 (]: 8 of 12 PASS not_null_snap_tags_id ............................................. [[32mPASS[0m in 0.23s]
[0m01:26:43.251772 [debug] [Thread-1 (]: Finished running node test.Slip_Tests.not_null_snap_tags_id.015a2066c2
[0m01:26:43.251772 [debug] [Thread-1 (]: Began running node test.Slip_Tests.not_null_snap_tags_movie_id.fb9962de5f
[0m01:26:43.251772 [info ] [Thread-1 (]: 9 of 12 START test not_null_snap_tags_movie_id ................................. [RUN]
[0m01:26:43.251772 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Slip_Tests.not_null_snap_tags_id.015a2066c2, now test.Slip_Tests.not_null_snap_tags_movie_id.fb9962de5f)
[0m01:26:43.251772 [debug] [Thread-1 (]: Began compiling node test.Slip_Tests.not_null_snap_tags_movie_id.fb9962de5f
[0m01:26:43.251772 [debug] [Thread-1 (]: Writing injected SQL for node "test.Slip_Tests.not_null_snap_tags_movie_id.fb9962de5f"
[0m01:26:43.251772 [debug] [Thread-1 (]: Began executing node test.Slip_Tests.not_null_snap_tags_movie_id.fb9962de5f
[0m01:26:43.269966 [debug] [Thread-1 (]: Writing runtime sql for node "test.Slip_Tests.not_null_snap_tags_movie_id.fb9962de5f"
[0m01:26:43.271011 [debug] [Thread-1 (]: Using snowflake connection "test.Slip_Tests.not_null_snap_tags_movie_id.fb9962de5f"
[0m01:26:43.272037 [debug] [Thread-1 (]: On test.Slip_Tests.not_null_snap_tags_movie_id.fb9962de5f: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "test.Slip_Tests.not_null_snap_tags_movie_id.fb9962de5f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select movie_id
from MOVIELENS.snapshots.snap_tags
where movie_id is null



  
  
      
    ) dbt_internal_test
[0m01:26:43.470294 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.203 seconds
[0m01:26:43.470294 [info ] [Thread-1 (]: 9 of 12 PASS not_null_snap_tags_movie_id ....................................... [[32mPASS[0m in 0.22s]
[0m01:26:43.476927 [debug] [Thread-1 (]: Finished running node test.Slip_Tests.not_null_snap_tags_movie_id.fb9962de5f
[0m01:26:43.476927 [debug] [Thread-1 (]: Began running node test.Slip_Tests.not_null_snap_tags_tag.b66ecb49f3
[0m01:26:43.476927 [info ] [Thread-1 (]: 10 of 12 START test not_null_snap_tags_tag ..................................... [RUN]
[0m01:26:43.476927 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Slip_Tests.not_null_snap_tags_movie_id.fb9962de5f, now test.Slip_Tests.not_null_snap_tags_tag.b66ecb49f3)
[0m01:26:43.476927 [debug] [Thread-1 (]: Began compiling node test.Slip_Tests.not_null_snap_tags_tag.b66ecb49f3
[0m01:26:43.476927 [debug] [Thread-1 (]: Writing injected SQL for node "test.Slip_Tests.not_null_snap_tags_tag.b66ecb49f3"
[0m01:26:43.476927 [debug] [Thread-1 (]: Began executing node test.Slip_Tests.not_null_snap_tags_tag.b66ecb49f3
[0m01:26:43.485532 [debug] [Thread-1 (]: Writing runtime sql for node "test.Slip_Tests.not_null_snap_tags_tag.b66ecb49f3"
[0m01:26:43.487712 [debug] [Thread-1 (]: Using snowflake connection "test.Slip_Tests.not_null_snap_tags_tag.b66ecb49f3"
[0m01:26:43.487712 [debug] [Thread-1 (]: On test.Slip_Tests.not_null_snap_tags_tag.b66ecb49f3: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "test.Slip_Tests.not_null_snap_tags_tag.b66ecb49f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select tag
from MOVIELENS.snapshots.snap_tags
where tag is null



  
  
      
    ) dbt_internal_test
[0m01:26:43.702522 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.224 seconds
[0m01:26:43.702522 [info ] [Thread-1 (]: 10 of 12 PASS not_null_snap_tags_tag ........................................... [[32mPASS[0m in 0.23s]
[0m01:26:43.718001 [debug] [Thread-1 (]: Finished running node test.Slip_Tests.not_null_snap_tags_tag.b66ecb49f3
[0m01:26:43.718001 [debug] [Thread-1 (]: Began running node test.Slip_Tests.not_null_snap_tags_user_id.a9aef7cace
[0m01:26:43.718001 [info ] [Thread-1 (]: 11 of 12 START test not_null_snap_tags_user_id ................................. [RUN]
[0m01:26:43.718001 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Slip_Tests.not_null_snap_tags_tag.b66ecb49f3, now test.Slip_Tests.not_null_snap_tags_user_id.a9aef7cace)
[0m01:26:43.718001 [debug] [Thread-1 (]: Began compiling node test.Slip_Tests.not_null_snap_tags_user_id.a9aef7cace
[0m01:26:43.718001 [debug] [Thread-1 (]: Writing injected SQL for node "test.Slip_Tests.not_null_snap_tags_user_id.a9aef7cace"
[0m01:26:43.718001 [debug] [Thread-1 (]: Began executing node test.Slip_Tests.not_null_snap_tags_user_id.a9aef7cace
[0m01:26:43.718001 [debug] [Thread-1 (]: Writing runtime sql for node "test.Slip_Tests.not_null_snap_tags_user_id.a9aef7cace"
[0m01:26:43.718001 [debug] [Thread-1 (]: Using snowflake connection "test.Slip_Tests.not_null_snap_tags_user_id.a9aef7cace"
[0m01:26:43.718001 [debug] [Thread-1 (]: On test.Slip_Tests.not_null_snap_tags_user_id.a9aef7cace: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "test.Slip_Tests.not_null_snap_tags_user_id.a9aef7cace"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from MOVIELENS.snapshots.snap_tags
where user_id is null



  
  
      
    ) dbt_internal_test
[0m01:26:43.924912 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.196 seconds
[0m01:26:43.924912 [info ] [Thread-1 (]: 11 of 12 PASS not_null_snap_tags_user_id ....................................... [[32mPASS[0m in 0.21s]
[0m01:26:43.924912 [debug] [Thread-1 (]: Finished running node test.Slip_Tests.not_null_snap_tags_user_id.a9aef7cace
[0m01:26:43.924912 [debug] [Thread-1 (]: Began running node test.Slip_Tests.unique_snap_tags_id.4ac4f44417
[0m01:26:43.924912 [info ] [Thread-1 (]: 12 of 12 START test unique_snap_tags_id ........................................ [RUN]
[0m01:26:43.924912 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Slip_Tests.not_null_snap_tags_user_id.a9aef7cace, now test.Slip_Tests.unique_snap_tags_id.4ac4f44417)
[0m01:26:43.924912 [debug] [Thread-1 (]: Began compiling node test.Slip_Tests.unique_snap_tags_id.4ac4f44417
[0m01:26:43.940513 [debug] [Thread-1 (]: Writing injected SQL for node "test.Slip_Tests.unique_snap_tags_id.4ac4f44417"
[0m01:26:43.941575 [debug] [Thread-1 (]: Began executing node test.Slip_Tests.unique_snap_tags_id.4ac4f44417
[0m01:26:43.944827 [debug] [Thread-1 (]: Writing runtime sql for node "test.Slip_Tests.unique_snap_tags_id.4ac4f44417"
[0m01:26:43.946600 [debug] [Thread-1 (]: Using snowflake connection "test.Slip_Tests.unique_snap_tags_id.4ac4f44417"
[0m01:26:43.947685 [debug] [Thread-1 (]: On test.Slip_Tests.unique_snap_tags_id.4ac4f44417: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "test.Slip_Tests.unique_snap_tags_id.4ac4f44417"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from MOVIELENS.snapshots.snap_tags
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:26:44.233481 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.290 seconds
[0m01:26:44.233481 [info ] [Thread-1 (]: 12 of 12 PASS unique_snap_tags_id .............................................. [[32mPASS[0m in 0.31s]
[0m01:26:44.233481 [debug] [Thread-1 (]: Finished running node test.Slip_Tests.unique_snap_tags_id.4ac4f44417
[0m01:26:44.233481 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:26:44.233481 [debug] [MainThread]: Connection 'list_MOVIELENS_snapshots' was left open.
[0m01:26:44.233481 [debug] [MainThread]: On list_MOVIELENS_snapshots: Close
[0m01:26:44.596927 [debug] [MainThread]: Connection 'test.Slip_Tests.unique_snap_tags_id.4ac4f44417' was left open.
[0m01:26:44.596927 [debug] [MainThread]: On test.Slip_Tests.unique_snap_tags_id.4ac4f44417: Close
[0m01:26:44.957825 [info ] [MainThread]: 
[0m01:26:44.957825 [info ] [MainThread]: Finished running 12 data tests in 0 hours 0 minutes and 6.88 seconds (6.88s).
[0m01:26:44.957825 [debug] [MainThread]: Command end result
[0m01:26:44.989571 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m01:26:44.992571 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m01:26:45.009365 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\dbt_workspace\Slip_Tests\target\run_results.json
[0m01:26:45.010396 [info ] [MainThread]: 
[0m01:26:45.011416 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:26:45.012402 [info ] [MainThread]: 
[0m01:26:45.012402 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=12
[0m01:26:45.013779 [debug] [MainThread]: Command `dbt test` succeeded at 01:26:45.013779 after 8.63 seconds
[0m01:26:45.014788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9BED00B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9BE8E2C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9BE8E0BC0>]}
[0m01:26:45.014788 [debug] [MainThread]: Flushing usage events
[0m01:26:45.951259 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:01:00.925199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233D2E64320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233D882C9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233D8E2EDE0>]}


============================== 02:01:00.925199 | f8d413dd-6f3b-4f1c-900b-f96373920301 ==============================
[0m02:01:00.925199 [info ] [MainThread]: Running with dbt=1.10.1
[0m02:01:00.925199 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ThembaniFaleni\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\dbt_workspace\\Slip_Tests\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --model fct_rating', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:01:00.925199 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of
`--resource-type model --select`
[0m02:01:00.925199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f8d413dd-6f3b-4f1c-900b-f96373920301', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233D2E64320>]}
[0m02:01:01.611262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f8d413dd-6f3b-4f1c-900b-f96373920301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233DB5EFB60>]}
[0m02:01:01.754734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f8d413dd-6f3b-4f1c-900b-f96373920301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233DB466A80>]}
[0m02:01:01.754734 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m02:01:01.941760 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m02:01:02.130520 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:01:02.130520 [debug] [MainThread]: Partial parsing: updated file: Slip_Tests://snapshots\snap_tag.sql
[0m02:01:03.028853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f8d413dd-6f3b-4f1c-900b-f96373920301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233DBBBA060>]}
[0m02:01:03.114787 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m02:01:03.130302 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m02:01:03.161689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f8d413dd-6f3b-4f1c-900b-f96373920301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233DBC10740>]}
[0m02:01:03.161689 [info ] [MainThread]: Found 12 models, 12 data tests, 1 snapshot, 6 sources, 592 macros
[0m02:01:03.161689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8d413dd-6f3b-4f1c-900b-f96373920301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233DA8395B0>]}
[0m02:01:03.161689 [warn ] [MainThread]: The selection criterion 'fct_rating' does not match any enabled nodes
[0m02:01:03.161689 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m02:01:03.161689 [debug] [MainThread]: Command end result
[0m02:01:03.198300 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m02:01:03.200298 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m02:01:03.207255 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\dbt_workspace\Slip_Tests\target\run_results.json
[0m02:01:03.208644 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m02:01:03.210653 [debug] [MainThread]: Command `dbt run` succeeded at 02:01:03.209661 after 2.52 seconds
[0m02:01:03.210653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233D2E64320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233DAD78BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233D8778890>]}
[0m02:01:03.210653 [debug] [MainThread]: Flushing usage events
[0m02:01:04.195960 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:01:21.467448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA9C1AFE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA9C1AED80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA9C1AFD70>]}


============================== 02:01:21.473554 | 774f5da3-b19a-4bcc-8d61-777709a4a8ef ==============================
[0m02:01:21.473554 [info ] [MainThread]: Running with dbt=1.10.1
[0m02:01:21.473554 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\ThembaniFaleni\\.dbt', 'log_path': 'C:\\dbt_workspace\\Slip_Tests\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --model fct_rating', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:01:21.473554 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of
`--resource-type model --select`
[0m02:01:21.473554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '774f5da3-b19a-4bcc-8d61-777709a4a8ef', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA9C39CEF0>]}
[0m02:01:22.136957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '774f5da3-b19a-4bcc-8d61-777709a4a8ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA9BB537D0>]}
[0m02:01:22.283480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '774f5da3-b19a-4bcc-8d61-777709a4a8ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA9E3FE4E0>]}
[0m02:01:22.283480 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m02:01:22.484193 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m02:01:22.658303 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:01:22.658303 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:01:22.705823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '774f5da3-b19a-4bcc-8d61-777709a4a8ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA9BBD9790>]}
[0m02:01:22.847112 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m02:01:22.847112 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m02:01:22.876323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '774f5da3-b19a-4bcc-8d61-777709a4a8ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA9EE3FCE0>]}
[0m02:01:22.878901 [info ] [MainThread]: Found 12 models, 12 data tests, 1 snapshot, 6 sources, 592 macros
[0m02:01:22.878901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '774f5da3-b19a-4bcc-8d61-777709a4a8ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA9EBD6780>]}
[0m02:01:22.878901 [warn ] [MainThread]: The selection criterion 'fct_rating' does not match any enabled nodes
[0m02:01:22.878901 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m02:01:22.889035 [debug] [MainThread]: Command end result
[0m02:01:22.909680 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m02:01:22.909680 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m02:01:22.918755 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\dbt_workspace\Slip_Tests\target\run_results.json
[0m02:01:22.919821 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m02:01:22.920827 [debug] [MainThread]: Command `dbt run` succeeded at 02:01:22.920827 after 1.68 seconds
[0m02:01:22.920827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA9EA14680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA99AEF770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA9C16CD10>]}
[0m02:01:22.921894 [debug] [MainThread]: Flushing usage events
[0m02:01:23.834912 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:02:29.151506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDC9B634A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDC9BE9280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDC9B33080>]}


============================== 02:02:29.166986 | a899168d-6510-45cd-9ea9-3e5f36aef7b7 ==============================
[0m02:02:29.166986 [info ] [MainThread]: Running with dbt=1.10.1
[0m02:02:29.166986 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\dbt_workspace\\Slip_Tests\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\ThembaniFaleni\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run --models fct_rating', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:02:29.166986 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of
`--resource-type model --select`
[0m02:02:29.166986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a899168d-6510-45cd-9ea9-3e5f36aef7b7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDCA1BD7C0>]}
[0m02:02:29.860065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a899168d-6510-45cd-9ea9-3e5f36aef7b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDC782A480>]}
[0m02:02:30.025559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a899168d-6510-45cd-9ea9-3e5f36aef7b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDCC6CE480>]}
[0m02:02:30.025559 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m02:02:30.217474 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m02:02:30.390540 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:02:30.390540 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:02:30.453605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a899168d-6510-45cd-9ea9-3e5f36aef7b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDCC912120>]}
[0m02:02:30.595025 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m02:02:30.595025 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m02:02:30.626773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a899168d-6510-45cd-9ea9-3e5f36aef7b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDCCE6FB60>]}
[0m02:02:30.626773 [info ] [MainThread]: Found 12 models, 12 data tests, 1 snapshot, 6 sources, 592 macros
[0m02:02:30.626773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a899168d-6510-45cd-9ea9-3e5f36aef7b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDCCA272F0>]}
[0m02:02:30.626773 [warn ] [MainThread]: The selection criterion 'fct_rating' does not match any enabled nodes
[0m02:02:30.632987 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m02:02:30.632987 [debug] [MainThread]: Command end result
[0m02:02:30.659237 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m02:02:30.659237 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m02:02:30.669199 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\dbt_workspace\Slip_Tests\target\run_results.json
[0m02:02:30.670207 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m02:02:30.672211 [debug] [MainThread]: Command `dbt run` succeeded at 02:02:30.671207 after 1.75 seconds
[0m02:02:30.672211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDC7CBD190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDCCA48BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDC9D75970>]}
[0m02:02:30.672879 [debug] [MainThread]: Flushing usage events
[0m02:02:31.777430 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:02:47.302006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284A1CB5400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284A47DA1B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284A47D9430>]}


============================== 02:02:47.317628 | 63eed7b8-c0e3-4ff5-95ee-475c792a7dd5 ==============================
[0m02:02:47.317628 [info ] [MainThread]: Running with dbt=1.10.1
[0m02:02:47.317628 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\dbt_workspace\\Slip_Tests\\logs', 'profiles_dir': 'C:\\Users\\ThembaniFaleni\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select fct_rating', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:02:48.007364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63eed7b8-c0e3-4ff5-95ee-475c792a7dd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284A6DE5490>]}
[0m02:02:48.166655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '63eed7b8-c0e3-4ff5-95ee-475c792a7dd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284A419A690>]}
[0m02:02:48.166655 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m02:02:48.340111 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m02:02:48.528897 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:02:48.528897 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:02:48.592540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63eed7b8-c0e3-4ff5-95ee-475c792a7dd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284A6E32C00>]}
[0m02:02:48.739123 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m02:02:48.742601 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m02:02:48.767723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '63eed7b8-c0e3-4ff5-95ee-475c792a7dd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284A70C41A0>]}
[0m02:02:48.767723 [info ] [MainThread]: Found 12 models, 12 data tests, 1 snapshot, 6 sources, 592 macros
[0m02:02:48.767723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63eed7b8-c0e3-4ff5-95ee-475c792a7dd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284A738FBF0>]}
[0m02:02:48.767723 [warn ] [MainThread]: The selection criterion 'fct_rating' does not match any enabled nodes
[0m02:02:48.767723 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m02:02:48.775736 [debug] [MainThread]: Command end result
[0m02:02:48.798394 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m02:02:48.800398 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m02:02:48.802524 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\dbt_workspace\Slip_Tests\target\run_results.json
[0m02:02:48.802524 [debug] [MainThread]: Command `dbt run` succeeded at 02:02:48.802524 after 1.73 seconds
[0m02:02:48.802524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284A2780200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284A4997A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284A7366810>]}
[0m02:02:48.809130 [debug] [MainThread]: Flushing usage events
[0m02:02:49.779025 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:03:19.935399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002439AAE7500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002439AE79DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002439AE38CE0>]}


============================== 02:03:19.935399 | 0065672e-c28d-4ee3-b49a-9aa30f0b2932 ==============================
[0m02:03:19.935399 [info ] [MainThread]: Running with dbt=1.10.1
[0m02:03:19.947938 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\dbt_workspace\\Slip_Tests\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\ThembaniFaleni\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --model fct_ratings', 'send_anonymous_usage_stats': 'True'}
[0m02:03:19.947938 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of
`--resource-type model --select`
[0m02:03:19.947938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0065672e-c28d-4ee3-b49a-9aa30f0b2932', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002439A741370>]}
[0m02:03:20.621506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0065672e-c28d-4ee3-b49a-9aa30f0b2932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002439D1FB0B0>]}
[0m02:03:20.775555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0065672e-c28d-4ee3-b49a-9aa30f0b2932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002439D282660>]}
[0m02:03:20.778561 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m02:03:20.971187 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m02:03:21.154709 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:03:21.154709 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:03:21.217218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0065672e-c28d-4ee3-b49a-9aa30f0b2932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002439D26BC50>]}
[0m02:03:21.358806 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m02:03:21.358806 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m02:03:21.390544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0065672e-c28d-4ee3-b49a-9aa30f0b2932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002439D79F9E0>]}
[0m02:03:21.390544 [info ] [MainThread]: Found 12 models, 12 data tests, 1 snapshot, 6 sources, 592 macros
[0m02:03:21.390544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0065672e-c28d-4ee3-b49a-9aa30f0b2932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002439D5A97C0>]}
[0m02:03:21.390544 [info ] [MainThread]: 
[0m02:03:21.390544 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:03:21.390544 [info ] [MainThread]: 
[0m02:03:21.398896 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:03:21.400218 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MOVIELENS'
[0m02:03:21.468500 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS"
[0m02:03:21.468500 [debug] [ThreadPool]: On list_MOVIELENS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS"} */
show terse schemas in database MOVIELENS
    limit 10000
[0m02:03:21.469494 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:03:23.427071 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.972 seconds
[0m02:03:23.442555 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MOVIELENS_snapshots'
[0m02:03:23.458679 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m02:03:23.458679 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
alter session set quoted_identifiers_ignore_case = false;
[0m02:03:23.458679 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:03:24.635768 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.174 seconds
[0m02:03:24.635768 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m02:03:24.635768 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
show objects in MOVIELENS.snapshots
    limit 10000
    
;
[0m02:03:25.104622 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.462 seconds
[0m02:03:25.104622 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m02:03:25.104622 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
alter session unset quoted_identifiers_ignore_case;
[0m02:03:25.387276 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.284 seconds
[0m02:03:25.387276 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MOVIELENS_snapshots, now list_MOVIELENS_DEV)
[0m02:03:25.387276 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m02:03:25.387276 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session set quoted_identifiers_ignore_case = false;
[0m02:03:25.733482 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.334 seconds
[0m02:03:25.733482 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m02:03:25.733482 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
show objects in MOVIELENS.DEV
    limit 10000
    
;
[0m02:03:25.982383 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.247 seconds
[0m02:03:25.982383 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m02:03:25.982383 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session unset quoted_identifiers_ignore_case;
[0m02:03:26.233802 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.252 seconds
[0m02:03:26.249251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0065672e-c28d-4ee3-b49a-9aa30f0b2932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002439C53C530>]}
[0m02:03:26.249251 [debug] [Thread-1 (]: Began running node model.Slip_Tests.fct_ratings
[0m02:03:26.249251 [info ] [Thread-1 (]: 1 of 1 START sql incremental model DEV.fct_ratings ............................. [RUN]
[0m02:03:26.249251 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Slip_Tests.fct_ratings'
[0m02:03:26.249251 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.fct_ratings
[0m02:03:26.268986 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.fct_ratings"
[0m02:03:26.271254 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.fct_ratings
[0m02:03:26.308897 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m02:03:26.308897 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
create or replace  temporary view MOVIELENS.DEV.fct_ratings__dbt_tmp
  
   as (
    

WITH src_ratings AS (
    SELECT * FROM MOVIELENS.DEV.src_ratings
)

SELECT
    user_id,
    movie_id,
    rating,
    rating_timestamp
FROM src_ratings
WHERE rating IS NOT NULL

    AND rating_timestamp > (
        SELECT MAX(rating_timestamp) FROM MOVIELENS.DEV.fct_ratings
    )

  );
[0m02:03:26.308897 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:03:27.597289 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.279 seconds
[0m02:03:27.597289 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m02:03:27.597289 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
describe table MOVIELENS.DEV.fct_ratings__dbt_tmp
[0m02:03:27.817152 [debug] [Thread-1 (]: SQL status: SUCCESS 4 in 0.213 seconds
[0m02:03:27.817152 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m02:03:27.817152 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
describe table MOVIELENS.DEV.fct_ratings
[0m02:03:28.020017 [debug] [Thread-1 (]: SQL status: SUCCESS 4 in 0.197 seconds
[0m02:03:28.035578 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m02:03:28.035578 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
describe table MOVIELENS.DEV.fct_ratings__dbt_tmp
[0m02:03:28.414613 [debug] [Thread-1 (]: SQL status: SUCCESS 4 in 0.384 seconds
[0m02:03:28.414613 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m02:03:28.414613 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
describe table "MOVIELENS"."DEV"."FCT_RATINGS"
[0m02:03:28.630636 [debug] [Thread-1 (]: SQL status: SUCCESS 4 in 0.213 seconds
[0m02:03:28.646276 [debug] [Thread-1 (]: 
    In "MOVIELENS"."DEV"."FCT_RATINGS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m02:03:28.661819 [debug] [Thread-1 (]: Writing runtime sql for node "model.Slip_Tests.fct_ratings"
[0m02:03:28.661819 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m02:03:28.661819 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
-- back compat for old kwarg name
  
  begin;
[0m02:03:28.913957 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.249 seconds
[0m02:03:28.913957 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m02:03:28.913957 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
insert into MOVIELENS.DEV.fct_ratings ("USER_ID", "MOVIE_ID", "RATING", "RATING_TIMESTAMP")
        (
            select "USER_ID", "MOVIE_ID", "RATING", "RATING_TIMESTAMP"
            from MOVIELENS.DEV.fct_ratings__dbt_tmp
        );
[0m02:03:29.822466 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.911 seconds
[0m02:03:29.822466 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m02:03:29.822466 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
COMMIT
[0m02:03:30.277310 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.451 seconds
[0m02:03:30.292944 [debug] [Thread-1 (]: Applying DROP to: MOVIELENS.DEV.fct_ratings__dbt_tmp
[0m02:03:30.292944 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m02:03:30.292944 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
drop view if exists MOVIELENS.DEV.fct_ratings__dbt_tmp cascade
[0m02:03:30.574678 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.273 seconds
[0m02:03:30.593784 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0065672e-c28d-4ee3-b49a-9aa30f0b2932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002439DB8ABA0>]}
[0m02:03:30.593784 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model DEV.fct_ratings ........................ [[32mSUCCESS 1[0m in 4.34s]
[0m02:03:30.593784 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.fct_ratings
[0m02:03:30.593784 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:03:30.593784 [debug] [MainThread]: Connection 'list_MOVIELENS' was left open.
[0m02:03:30.593784 [debug] [MainThread]: On list_MOVIELENS: Close
[0m02:03:30.956724 [debug] [MainThread]: Connection 'list_MOVIELENS_DEV' was left open.
[0m02:03:30.956724 [debug] [MainThread]: On list_MOVIELENS_DEV: Close
[0m02:03:31.342010 [debug] [MainThread]: Connection 'model.Slip_Tests.fct_ratings' was left open.
[0m02:03:31.342010 [debug] [MainThread]: On model.Slip_Tests.fct_ratings: Close
[0m02:03:31.702612 [info ] [MainThread]: 
[0m02:03:31.702612 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 10.30 seconds (10.30s).
[0m02:03:31.718299 [debug] [MainThread]: Command end result
[0m02:03:31.740056 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m02:03:31.743748 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m02:03:31.754520 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\dbt_workspace\Slip_Tests\target\run_results.json
[0m02:03:31.754520 [info ] [MainThread]: 
[0m02:03:31.754520 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:03:31.754520 [info ] [MainThread]: 
[0m02:03:31.754520 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m02:03:31.754520 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m02:03:31.754520 [debug] [MainThread]: Command `dbt run` succeeded at 02:03:31.754520 after 12.04 seconds
[0m02:03:31.754520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243977BA0C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002439D60D880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002439A510C20>]}
[0m02:03:31.754520 [debug] [MainThread]: Flushing usage events
[0m02:03:32.752895 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:04:19.154366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F360745310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F362C294F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3635990A0>]}


============================== 02:04:19.154366 | 4d45dac4-6edb-4486-91eb-e0a1c2c1dff0 ==============================
[0m02:04:19.154366 [info ] [MainThread]: Running with dbt=1.10.1
[0m02:04:19.154366 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\dbt_workspace\\Slip_Tests\\logs', 'profiles_dir': 'C:\\Users\\ThembaniFaleni\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --model fct_ratings', 'send_anonymous_usage_stats': 'True'}
[0m02:04:19.154366 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of
`--resource-type model --select`
[0m02:04:19.170017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4d45dac4-6edb-4486-91eb-e0a1c2c1dff0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F362D1F2C0>]}
[0m02:04:19.829323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d45dac4-6edb-4486-91eb-e0a1c2c1dff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F365318350>]}
[0m02:04:19.995229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d45dac4-6edb-4486-91eb-e0a1c2c1dff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F36312E2A0>]}
[0m02:04:19.995229 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m02:04:20.191807 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m02:04:20.365172 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:04:20.365172 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:04:20.427408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d45dac4-6edb-4486-91eb-e0a1c2c1dff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3659D40E0>]}
[0m02:04:20.568298 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m02:04:20.577426 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m02:04:20.595950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d45dac4-6edb-4486-91eb-e0a1c2c1dff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F365E1F650>]}
[0m02:04:20.595950 [info ] [MainThread]: Found 12 models, 12 data tests, 1 snapshot, 6 sources, 592 macros
[0m02:04:20.595950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d45dac4-6edb-4486-91eb-e0a1c2c1dff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F365B6CE00>]}
[0m02:04:20.595950 [info ] [MainThread]: 
[0m02:04:20.595950 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:04:20.595950 [info ] [MainThread]: 
[0m02:04:20.595950 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:04:20.595950 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MOVIELENS'
[0m02:04:20.663629 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS"
[0m02:04:20.663629 [debug] [ThreadPool]: On list_MOVIELENS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS"} */
show terse schemas in database MOVIELENS
    limit 10000
[0m02:04:20.663629 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:04:21.882104 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.220 seconds
[0m02:04:21.898790 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MOVIELENS_snapshots'
[0m02:04:21.913804 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m02:04:21.913804 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
alter session set quoted_identifiers_ignore_case = false;
[0m02:04:21.913804 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:04:23.120468 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.215 seconds
[0m02:04:23.120468 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m02:04:23.120468 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
show objects in MOVIELENS.snapshots
    limit 10000
    
;
[0m02:04:23.370414 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.248 seconds
[0m02:04:23.385903 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m02:04:23.385903 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
alter session unset quoted_identifiers_ignore_case;
[0m02:04:23.622218 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.238 seconds
[0m02:04:23.622218 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MOVIELENS_snapshots, now list_MOVIELENS_DEV)
[0m02:04:23.622218 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m02:04:23.622218 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session set quoted_identifiers_ignore_case = false;
[0m02:04:23.841014 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.212 seconds
[0m02:04:23.841014 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m02:04:23.841014 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
show objects in MOVIELENS.DEV
    limit 10000
    
;
[0m02:04:24.105692 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.255 seconds
[0m02:04:24.109249 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m02:04:24.109249 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session unset quoted_identifiers_ignore_case;
[0m02:04:24.310628 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.211 seconds
[0m02:04:24.326369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d45dac4-6edb-4486-91eb-e0a1c2c1dff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F36329AB40>]}
[0m02:04:24.326369 [debug] [Thread-1 (]: Began running node model.Slip_Tests.fct_ratings
[0m02:04:24.326369 [info ] [Thread-1 (]: 1 of 1 START sql incremental model DEV.fct_ratings ............................. [RUN]
[0m02:04:24.326369 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Slip_Tests.fct_ratings'
[0m02:04:24.326369 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.fct_ratings
[0m02:04:24.341988 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.fct_ratings"
[0m02:04:24.341988 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.fct_ratings
[0m02:04:24.394972 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m02:04:24.394972 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
create or replace  temporary view MOVIELENS.DEV.fct_ratings__dbt_tmp
  
   as (
    

WITH src_ratings AS (
    SELECT * FROM MOVIELENS.DEV.src_ratings
)

SELECT
    user_id,
    movie_id,
    rating,
    rating_timestamp
FROM src_ratings
WHERE rating IS NOT NULL

    AND rating_timestamp > (
        SELECT MAX(rating_timestamp) FROM MOVIELENS.DEV.fct_ratings
    )

  );
[0m02:04:24.394972 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:04:25.832295 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.441 seconds
[0m02:04:25.832295 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m02:04:25.847804 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
describe table MOVIELENS.DEV.fct_ratings__dbt_tmp
[0m02:04:26.072837 [debug] [Thread-1 (]: SQL status: SUCCESS 4 in 0.234 seconds
[0m02:04:26.082886 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m02:04:26.082886 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
describe table MOVIELENS.DEV.fct_ratings
[0m02:04:26.302563 [debug] [Thread-1 (]: SQL status: SUCCESS 4 in 0.218 seconds
[0m02:04:26.311078 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m02:04:26.311078 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
describe table MOVIELENS.DEV.fct_ratings__dbt_tmp
[0m02:04:26.536801 [debug] [Thread-1 (]: SQL status: SUCCESS 4 in 0.223 seconds
[0m02:04:26.536801 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m02:04:26.536801 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
describe table "MOVIELENS"."DEV"."FCT_RATINGS"
[0m02:04:26.756246 [debug] [Thread-1 (]: SQL status: SUCCESS 4 in 0.225 seconds
[0m02:04:26.772666 [debug] [Thread-1 (]: 
    In "MOVIELENS"."DEV"."FCT_RATINGS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m02:04:26.788513 [debug] [Thread-1 (]: Writing runtime sql for node "model.Slip_Tests.fct_ratings"
[0m02:04:26.788513 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m02:04:26.788513 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
-- back compat for old kwarg name
  
  begin;
[0m02:04:27.021927 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.232 seconds
[0m02:04:27.021927 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m02:04:27.021927 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
insert into MOVIELENS.DEV.fct_ratings ("USER_ID", "MOVIE_ID", "RATING", "RATING_TIMESTAMP")
        (
            select "USER_ID", "MOVIE_ID", "RATING", "RATING_TIMESTAMP"
            from MOVIELENS.DEV.fct_ratings__dbt_tmp
        );
[0m02:04:27.816358 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.785 seconds
[0m02:04:27.816358 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m02:04:27.816358 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
COMMIT
[0m02:04:28.071844 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.257 seconds
[0m02:04:28.071844 [debug] [Thread-1 (]: Applying DROP to: MOVIELENS.DEV.fct_ratings__dbt_tmp
[0m02:04:28.087367 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m02:04:28.087367 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
drop view if exists MOVIELENS.DEV.fct_ratings__dbt_tmp cascade
[0m02:04:28.355592 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.268 seconds
[0m02:04:28.371102 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d45dac4-6edb-4486-91eb-e0a1c2c1dff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F360849250>]}
[0m02:04:28.386729 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model DEV.fct_ratings ........................ [[32mSUCCESS 0[0m in 4.04s]
[0m02:04:28.386729 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.fct_ratings
[0m02:04:28.386729 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:04:28.386729 [debug] [MainThread]: Connection 'list_MOVIELENS' was left open.
[0m02:04:28.386729 [debug] [MainThread]: On list_MOVIELENS: Close
[0m02:04:28.747947 [debug] [MainThread]: Connection 'list_MOVIELENS_DEV' was left open.
[0m02:04:28.747947 [debug] [MainThread]: On list_MOVIELENS_DEV: Close
[0m02:04:29.106203 [debug] [MainThread]: Connection 'model.Slip_Tests.fct_ratings' was left open.
[0m02:04:29.106203 [debug] [MainThread]: On model.Slip_Tests.fct_ratings: Close
[0m02:04:29.482988 [info ] [MainThread]: 
[0m02:04:29.482988 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 8.89 seconds (8.89s).
[0m02:04:29.482988 [debug] [MainThread]: Command end result
[0m02:04:29.514080 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m02:04:29.514080 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m02:04:29.533463 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\dbt_workspace\Slip_Tests\target\run_results.json
[0m02:04:29.534245 [info ] [MainThread]: 
[0m02:04:29.534860 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:04:29.535688 [info ] [MainThread]: 
[0m02:04:29.536842 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m02:04:29.536842 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m02:04:29.536842 [debug] [MainThread]: Command `dbt run` succeeded at 02:04:29.536842 after 10.64 seconds
[0m02:04:29.536842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F35FE49D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F362BA06B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F362BA01A0>]}
[0m02:04:29.536842 [debug] [MainThread]: Flushing usage events
[0m02:04:30.471092 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:04:46.847886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E279F3FDA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E279BE9D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E27A1D6930>]}


============================== 02:04:46.860989 | 12767f5a-c177-419b-a1d0-fbdc8be4d94a ==============================
[0m02:04:46.860989 [info ] [MainThread]: Running with dbt=1.10.1
[0m02:04:46.864008 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ThembaniFaleni\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\dbt_workspace\\Slip_Tests\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select fct_ratings', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:04:47.533473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12767f5a-c177-419b-a1d0-fbdc8be4d94a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E27C6EC260>]}
[0m02:04:47.700236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '12767f5a-c177-419b-a1d0-fbdc8be4d94a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E27BECEDE0>]}
[0m02:04:47.700236 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m02:04:47.898051 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m02:04:48.069417 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:04:48.069417 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:04:48.143008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '12767f5a-c177-419b-a1d0-fbdc8be4d94a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E27C755A60>]}
[0m02:04:48.283245 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m02:04:48.299909 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m02:04:48.316730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '12767f5a-c177-419b-a1d0-fbdc8be4d94a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E27CB76090>]}
[0m02:04:48.316730 [info ] [MainThread]: Found 12 models, 12 data tests, 1 snapshot, 6 sources, 592 macros
[0m02:04:48.316730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12767f5a-c177-419b-a1d0-fbdc8be4d94a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E27CB803E0>]}
[0m02:04:48.316730 [info ] [MainThread]: 
[0m02:04:48.316730 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:04:48.316730 [info ] [MainThread]: 
[0m02:04:48.328040 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:04:48.329074 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MOVIELENS'
[0m02:04:48.395704 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS"
[0m02:04:48.395704 [debug] [ThreadPool]: On list_MOVIELENS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS"} */
show terse schemas in database MOVIELENS
    limit 10000
[0m02:04:48.395704 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:04:49.697774 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.308 seconds
[0m02:04:49.713367 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MOVIELENS_DEV'
[0m02:04:49.723870 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m02:04:49.723870 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session set quoted_identifiers_ignore_case = false;
[0m02:04:49.723870 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:04:50.752170 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.033 seconds
[0m02:04:50.752170 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m02:04:50.752170 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
show objects in MOVIELENS.DEV
    limit 10000
    
;
[0m02:04:51.018685 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.264 seconds
[0m02:04:51.018685 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m02:04:51.018685 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session unset quoted_identifiers_ignore_case;
[0m02:04:51.238352 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.211 seconds
[0m02:04:51.238352 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MOVIELENS_DEV, now list_MOVIELENS_snapshots)
[0m02:04:51.238352 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m02:04:51.238352 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
alter session set quoted_identifiers_ignore_case = false;
[0m02:04:51.472773 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.221 seconds
[0m02:04:51.472773 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m02:04:51.472773 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
show objects in MOVIELENS.snapshots
    limit 10000
    
;
[0m02:04:51.693194 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.229 seconds
[0m02:04:51.693194 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m02:04:51.708736 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
alter session unset quoted_identifiers_ignore_case;
[0m02:04:51.926767 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.219 seconds
[0m02:04:51.926767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12767f5a-c177-419b-a1d0-fbdc8be4d94a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E27A00D580>]}
[0m02:04:51.926767 [debug] [Thread-1 (]: Began running node model.Slip_Tests.fct_ratings
[0m02:04:51.942337 [info ] [Thread-1 (]: 1 of 1 START sql incremental model DEV.fct_ratings ............................. [RUN]
[0m02:04:51.942337 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Slip_Tests.fct_ratings'
[0m02:04:51.942337 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.fct_ratings
[0m02:04:51.974284 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.fct_ratings"
[0m02:04:51.974284 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.fct_ratings
[0m02:04:52.031157 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m02:04:52.031157 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
create or replace  temporary view MOVIELENS.DEV.fct_ratings__dbt_tmp
  
   as (
    

WITH src_ratings AS (
    SELECT * FROM MOVIELENS.DEV.src_ratings
)

SELECT
    user_id,
    movie_id,
    rating,
    rating_timestamp
FROM src_ratings
WHERE rating IS NOT NULL

    AND rating_timestamp > (
        SELECT MAX(rating_timestamp) FROM MOVIELENS.DEV.fct_ratings
    )

  );
[0m02:04:52.031157 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:04:53.378365 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.343 seconds
[0m02:04:53.391887 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m02:04:53.391887 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
describe table MOVIELENS.DEV.fct_ratings__dbt_tmp
[0m02:04:53.619872 [debug] [Thread-1 (]: SQL status: SUCCESS 4 in 0.229 seconds
[0m02:04:53.619872 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m02:04:53.619872 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
describe table MOVIELENS.DEV.fct_ratings
[0m02:04:53.840064 [debug] [Thread-1 (]: SQL status: SUCCESS 4 in 0.208 seconds
[0m02:04:53.840064 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m02:04:53.840064 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
describe table MOVIELENS.DEV.fct_ratings__dbt_tmp
[0m02:04:54.073891 [debug] [Thread-1 (]: SQL status: SUCCESS 4 in 0.220 seconds
[0m02:04:54.073891 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m02:04:54.073891 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
describe table "MOVIELENS"."DEV"."FCT_RATINGS"
[0m02:04:54.293518 [debug] [Thread-1 (]: SQL status: SUCCESS 4 in 0.230 seconds
[0m02:04:54.309259 [debug] [Thread-1 (]: 
    In "MOVIELENS"."DEV"."FCT_RATINGS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m02:04:54.324892 [debug] [Thread-1 (]: Writing runtime sql for node "model.Slip_Tests.fct_ratings"
[0m02:04:54.324892 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m02:04:54.324892 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
-- back compat for old kwarg name
  
  begin;
[0m02:04:54.592049 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.266 seconds
[0m02:04:54.592049 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m02:04:54.592049 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
insert into MOVIELENS.DEV.fct_ratings ("USER_ID", "MOVIE_ID", "RATING", "RATING_TIMESTAMP")
        (
            select "USER_ID", "MOVIE_ID", "RATING", "RATING_TIMESTAMP"
            from MOVIELENS.DEV.fct_ratings__dbt_tmp
        );
[0m02:04:55.092622 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.506 seconds
[0m02:04:55.092622 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m02:04:55.108355 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
COMMIT
[0m02:04:55.359240 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.264 seconds
[0m02:04:55.381336 [debug] [Thread-1 (]: Applying DROP to: MOVIELENS.DEV.fct_ratings__dbt_tmp
[0m02:04:55.381336 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m02:04:55.381336 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
drop view if exists MOVIELENS.DEV.fct_ratings__dbt_tmp cascade
[0m02:04:55.625752 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.242 seconds
[0m02:04:55.641351 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12767f5a-c177-419b-a1d0-fbdc8be4d94a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E277589430>]}
[0m02:04:55.641351 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model DEV.fct_ratings ........................ [[32mSUCCESS 0[0m in 3.70s]
[0m02:04:55.641351 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.fct_ratings
[0m02:04:55.641351 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:04:55.641351 [debug] [MainThread]: Connection 'list_MOVIELENS' was left open.
[0m02:04:55.641351 [debug] [MainThread]: On list_MOVIELENS: Close
[0m02:04:56.018604 [debug] [MainThread]: Connection 'list_MOVIELENS_snapshots' was left open.
[0m02:04:56.018604 [debug] [MainThread]: On list_MOVIELENS_snapshots: Close
[0m02:04:56.362972 [debug] [MainThread]: Connection 'model.Slip_Tests.fct_ratings' was left open.
[0m02:04:56.362972 [debug] [MainThread]: On model.Slip_Tests.fct_ratings: Close
[0m02:04:56.762272 [info ] [MainThread]: 
[0m02:04:56.762272 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 8.45 seconds (8.45s).
[0m02:04:56.762272 [debug] [MainThread]: Command end result
[0m02:04:56.784821 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m02:04:56.784821 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m02:04:56.804854 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\dbt_workspace\Slip_Tests\target\run_results.json
[0m02:04:56.804854 [info ] [MainThread]: 
[0m02:04:56.804854 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:04:56.804854 [info ] [MainThread]: 
[0m02:04:56.804854 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m02:04:56.804854 [debug] [MainThread]: Command `dbt run` succeeded at 02:04:56.804854 after 10.19 seconds
[0m02:04:56.804854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E27A196060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E27988AD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E279888800>]}
[0m02:04:56.804854 [debug] [MainThread]: Flushing usage events
[0m02:04:57.764256 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:09:28.472691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0144A9130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B016B78860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B016B79280>]}


============================== 02:09:28.472691 | acb3d95d-f628-44b6-b352-b5a5dbd080ee ==============================
[0m02:09:28.472691 [info ] [MainThread]: Running with dbt=1.10.1
[0m02:09:28.472691 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\dbt_workspace\\Slip_Tests\\logs', 'profiles_dir': 'C:\\Users\\ThembaniFaleni\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:09:29.147899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'acb3d95d-f628-44b6-b352-b5a5dbd080ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B017435490>]}
[0m02:09:29.301918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'acb3d95d-f628-44b6-b352-b5a5dbd080ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0195BE870>]}
[0m02:09:29.301918 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m02:09:29.486097 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m02:09:29.643410 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:09:29.643410 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:09:29.716130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'acb3d95d-f628-44b6-b352-b5a5dbd080ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0198C4470>]}
[0m02:09:29.851432 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m02:09:29.851432 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m02:09:29.882642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'acb3d95d-f628-44b6-b352-b5a5dbd080ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0198C4BF0>]}
[0m02:09:29.882642 [info ] [MainThread]: Found 12 models, 12 data tests, 1 snapshot, 6 sources, 592 macros
[0m02:09:29.882642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'acb3d95d-f628-44b6-b352-b5a5dbd080ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B019B36C90>]}
[0m02:09:29.882642 [info ] [MainThread]: 
[0m02:09:29.882642 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:09:29.882642 [info ] [MainThread]: 
[0m02:09:29.882642 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:09:29.882642 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MOVIELENS'
[0m02:09:29.959690 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS"
[0m02:09:29.959690 [debug] [ThreadPool]: On list_MOVIELENS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS"} */
show terse schemas in database MOVIELENS
    limit 10000
[0m02:09:29.960686 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:09:31.591554 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.636 seconds
[0m02:09:31.591554 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MOVIELENS_snapshots'
[0m02:09:31.607042 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m02:09:31.607042 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
alter session set quoted_identifiers_ignore_case = false;
[0m02:09:31.607042 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:09:32.672976 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.058 seconds
[0m02:09:32.672976 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m02:09:32.672976 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
show objects in MOVIELENS.snapshots
    limit 10000
    
;
[0m02:09:32.906941 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.236 seconds
[0m02:09:32.922505 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m02:09:32.922505 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
alter session unset quoted_identifiers_ignore_case;
[0m02:09:33.126617 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.205 seconds
[0m02:09:33.126617 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MOVIELENS_snapshots, now list_MOVIELENS_DEV)
[0m02:09:33.126617 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m02:09:33.126617 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session set quoted_identifiers_ignore_case = false;
[0m02:09:33.369523 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.239 seconds
[0m02:09:33.369523 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m02:09:33.369523 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
show objects in MOVIELENS.DEV
    limit 10000
    
;
[0m02:09:33.636884 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.263 seconds
[0m02:09:33.636884 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m02:09:33.636884 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session unset quoted_identifiers_ignore_case;
[0m02:09:33.856909 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.212 seconds
[0m02:09:33.856909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'acb3d95d-f628-44b6-b352-b5a5dbd080ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0195996A0>]}
[0m02:09:33.856909 [debug] [Thread-1 (]: Began running node snapshot.Slip_Tests.snap_tags
[0m02:09:33.856909 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.snap_tags ...................................... [RUN]
[0m02:09:33.856909 [debug] [Thread-1 (]: Acquiring new snowflake connection 'snapshot.Slip_Tests.snap_tags'
[0m02:09:33.856909 [debug] [Thread-1 (]: Began compiling node snapshot.Slip_Tests.snap_tags
[0m02:09:33.888236 [debug] [Thread-1 (]: Began executing node snapshot.Slip_Tests.snap_tags
[0m02:09:33.940831 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m02:09:33.940831 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
[0m02:09:33.955345 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:09:35.038230 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 1.092 seconds
[0m02:09:35.100748 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m02:09:35.100748 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
create or replace temporary table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS__dbt_tmp"
as (
    
    
    with snapshot_query as (

        



SELECT
    md5(cast(coalesce(cast(user_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(movie_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS id,
    user_id,
    movie_id,
    tag,
    tag_timestamp  AS tag_timestamp
FROM MOVIELENS.DEV.src_tags
-- LIMIT 100


    ),

    snapshotted_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    

        from "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    
,
            tag_timestamp as dbt_updated_at,
            tag_timestamp as dbt_valid_from,
            
  
  coalesce(nullif(tag_timestamp, tag_timestamp), null)
  as dbt_valid_to
,
            md5(coalesce(cast(user_id as varchar ), '')
         || '|' || coalesce(cast(movie_id as varchar ), '')
         || '|' || coalesce(cast(tag as varchar ), '')
         || '|' || coalesce(cast(tag_timestamp as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    
,
            tag_timestamp as dbt_updated_at,
            tag_timestamp as dbt_valid_from,
            tag_timestamp as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

            where 
    
        snapshotted_data.dbt_unique_key_1 is null
    

            or (
    
        snapshotted_data.dbt_unique_key_1 is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.tag_timestamp)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.tag_timestamp)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

            where 
    
        source_data.dbt_unique_key_1 is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    )
;
[0m02:09:37.468747 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.374 seconds
[0m02:09:37.484445 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m02:09:37.484445 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS__dbt_tmp"
[0m02:09:37.738326 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.260 seconds
[0m02:09:37.749887 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m02:09:37.749887 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
[0m02:09:37.956122 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.217 seconds
[0m02:09:37.971190 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m02:09:37.971190 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS__dbt_tmp"
[0m02:09:38.188618 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.213 seconds
[0m02:09:38.197620 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m02:09:38.198620 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
[0m02:09:38.394232 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.209 seconds
[0m02:09:38.409293 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m02:09:38.425067 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS__dbt_tmp"
[0m02:09:38.640701 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.219 seconds
[0m02:09:38.660854 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m02:09:38.660854 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
/* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
select * from (
        
    
    with snapshot_query as (

        



SELECT
    md5(cast(coalesce(cast(user_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(movie_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS id,
    user_id,
    movie_id,
    tag,
    tag_timestamp  AS tag_timestamp
FROM MOVIELENS.DEV.src_tags
-- LIMIT 100


    ),

    snapshotted_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    

        from "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    
,
            tag_timestamp as dbt_updated_at,
            tag_timestamp as dbt_valid_from,
            
  
  coalesce(nullif(tag_timestamp, tag_timestamp), null)
  as dbt_valid_to
,
            md5(coalesce(cast(user_id as varchar ), '')
         || '|' || coalesce(cast(movie_id as varchar ), '')
         || '|' || coalesce(cast(tag as varchar ), '')
         || '|' || coalesce(cast(tag_timestamp as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    
,
            tag_timestamp as dbt_updated_at,
            tag_timestamp as dbt_valid_from,
            tag_timestamp as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

            where 
    
        snapshotted_data.dbt_unique_key_1 is null
    

            or (
    
        snapshotted_data.dbt_unique_key_1 is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.tag_timestamp)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.tag_timestamp)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

            where 
    
        source_data.dbt_unique_key_1 is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m02:09:39.223801 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.564 seconds
[0m02:09:39.223801 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m02:09:39.239429 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
/* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m02:09:39.430722 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.198 seconds
[0m02:09:39.430722 [warn ] [Thread-1 (]: Data type of snapshot table timestamp columns (TIMESTAMP_NTZ) doesn't match derived column 'updated_at' (TIMESTAMP_LTZ). Please update snapshot config 'updated_at'.
[0m02:09:39.430722 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.Slip_Tests.snap_tags"
[0m02:09:39.442743 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m02:09:39.442743 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
BEGIN
[0m02:09:39.694029 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.260 seconds
[0m02:09:39.709657 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m02:09:39.709657 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
merge into "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS" as DBT_INTERNAL_DEST
    using "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("ID", "USER_ID", "MOVIE_ID", "TAG", "TAG_TIMESTAMP", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("ID", "USER_ID", "MOVIE_ID", "TAG", "TAG_TIMESTAMP", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m02:09:42.140123 [debug] [Thread-1 (]: SQL status: SUCCESS 2 in 2.428 seconds
[0m02:09:42.140123 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m02:09:42.140123 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
COMMIT
[0m02:09:42.483954 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.348 seconds
[0m02:09:42.499718 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acb3d95d-f628-44b6-b352-b5a5dbd080ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0145A9310>]}
[0m02:09:42.499718 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.snap_tags ...................................... [[32mSUCCESS 2[0m in 8.64s]
[0m02:09:42.499718 [debug] [Thread-1 (]: Finished running node snapshot.Slip_Tests.snap_tags
[0m02:09:42.515313 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:09:42.515313 [debug] [MainThread]: Connection 'list_MOVIELENS' was left open.
[0m02:09:42.515313 [debug] [MainThread]: On list_MOVIELENS: Close
[0m02:09:42.886159 [debug] [MainThread]: Connection 'list_MOVIELENS_DEV' was left open.
[0m02:09:42.886159 [debug] [MainThread]: On list_MOVIELENS_DEV: Close
[0m02:09:43.266939 [debug] [MainThread]: Connection 'snapshot.Slip_Tests.snap_tags' was left open.
[0m02:09:43.266939 [debug] [MainThread]: On snapshot.Slip_Tests.snap_tags: Close
[0m02:09:43.658641 [info ] [MainThread]: 
[0m02:09:43.658641 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 13.78 seconds (13.78s).
[0m02:09:43.658641 [debug] [MainThread]: Command end result
[0m02:09:43.674284 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m02:09:43.674284 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m02:09:43.701573 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\dbt_workspace\Slip_Tests\target\run_results.json
[0m02:09:43.701573 [info ] [MainThread]: 
[0m02:09:43.702638 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:09:43.702638 [info ] [MainThread]: 
[0m02:09:43.702638 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m02:09:43.702638 [debug] [MainThread]: Command `dbt snapshot` succeeded at 02:09:43.702638 after 15.48 seconds
[0m02:09:43.702638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0144A9130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B019B64260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B019E93740>]}
[0m02:09:43.702638 [debug] [MainThread]: Flushing usage events
[0m02:09:44.724115 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:16:54.793620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C11DEC920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C11779BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C11778830>]}


============================== 02:16:54.809153 | a00ab36d-e66f-454f-b62c-8306751f4e91 ==============================
[0m02:16:54.809153 [info ] [MainThread]: Running with dbt=1.10.1
[0m02:16:54.809153 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\dbt_workspace\\Slip_Tests\\logs', 'profiles_dir': 'C:\\Users\\ThembaniFaleni\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:16:55.547111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a00ab36d-e66f-454f-b62c-8306751f4e91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C121F2ED0>]}
[0m02:16:55.689521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a00ab36d-e66f-454f-b62c-8306751f4e91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C14120C20>]}
[0m02:16:55.689521 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m02:16:55.881337 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m02:16:56.066062 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:16:56.066062 [debug] [MainThread]: Partial parsing: updated file: Slip_Tests://snapshots\snap_tag.sql
[0m02:16:56.975869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a00ab36d-e66f-454f-b62c-8306751f4e91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C14B94F50>]}
[0m02:16:57.069921 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m02:16:57.079915 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m02:16:57.099976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a00ab36d-e66f-454f-b62c-8306751f4e91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C14C67230>]}
[0m02:16:57.099976 [info ] [MainThread]: Found 12 models, 12 data tests, 1 snapshot, 6 sources, 592 macros
[0m02:16:57.099976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a00ab36d-e66f-454f-b62c-8306751f4e91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C14BA0260>]}
[0m02:16:57.099976 [info ] [MainThread]: 
[0m02:16:57.099976 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:16:57.099976 [info ] [MainThread]: 
[0m02:16:57.107732 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:16:57.109640 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MOVIELENS'
[0m02:16:57.169944 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS"
[0m02:16:57.170947 [debug] [ThreadPool]: On list_MOVIELENS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS"} */
show terse schemas in database MOVIELENS
    limit 10000
[0m02:16:57.170947 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:16:58.887340 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.717 seconds
[0m02:16:58.887340 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MOVIELENS_DEV'
[0m02:16:58.903783 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m02:16:58.903783 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session set quoted_identifiers_ignore_case = false;
[0m02:16:58.903783 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:17:00.000263 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.101 seconds
[0m02:17:00.015908 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m02:17:00.015908 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
show objects in MOVIELENS.DEV
    limit 10000
    
;
[0m02:17:00.296953 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.289 seconds
[0m02:17:00.296953 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m02:17:00.312494 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session unset quoted_identifiers_ignore_case;
[0m02:17:00.548382 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.243 seconds
[0m02:17:00.548382 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MOVIELENS_DEV, now list_MOVIELENS_snapshots)
[0m02:17:00.560409 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m02:17:00.560409 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
alter session set quoted_identifiers_ignore_case = false;
[0m02:17:00.799643 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.246 seconds
[0m02:17:00.799643 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m02:17:00.799643 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
show objects in MOVIELENS.snapshots
    limit 10000
    
;
[0m02:17:01.065211 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.262 seconds
[0m02:17:01.065211 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m02:17:01.080957 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
alter session unset quoted_identifiers_ignore_case;
[0m02:17:01.310808 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.230 seconds
[0m02:17:01.315105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a00ab36d-e66f-454f-b62c-8306751f4e91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C14B69790>]}
[0m02:17:01.315835 [debug] [Thread-1 (]: Began running node snapshot.Slip_Tests.snap_tags
[0m02:17:01.315835 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.snap_tags ...................................... [RUN]
[0m02:17:01.315835 [debug] [Thread-1 (]: Acquiring new snowflake connection 'snapshot.Slip_Tests.snap_tags'
[0m02:17:01.315835 [debug] [Thread-1 (]: Began compiling node snapshot.Slip_Tests.snap_tags
[0m02:17:01.331565 [debug] [Thread-1 (]: Began executing node snapshot.Slip_Tests.snap_tags
[0m02:17:01.383795 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m02:17:01.383795 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
[0m02:17:01.383795 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:17:02.491219 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 1.108 seconds
[0m02:17:02.553720 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m02:17:02.553720 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
create or replace temporary table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS__dbt_tmp"
as (
    
    
    with snapshot_query as (

        



SELECT
    md5(cast(coalesce(cast(user_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(movie_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS id,
    user_id,
    movie_id,
    tag,
    TO_TIMESTAMP_LTZ(timestamp) AS tag_timestamp
FROM MOVIELENS.DEV.src_tags
-- LIMIT 100


    ),

    snapshotted_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    

        from "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    
,
            tag_timestamp as dbt_updated_at,
            tag_timestamp as dbt_valid_from,
            
  
  coalesce(nullif(tag_timestamp, tag_timestamp), null)
  as dbt_valid_to
,
            md5(coalesce(cast(user_id as varchar ), '')
         || '|' || coalesce(cast(movie_id as varchar ), '')
         || '|' || coalesce(cast(tag as varchar ), '')
         || '|' || coalesce(cast(tag_timestamp as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    
,
            tag_timestamp as dbt_updated_at,
            tag_timestamp as dbt_valid_from,
            tag_timestamp as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

            where 
    
        snapshotted_data.dbt_unique_key_1 is null
    

            or (
    
        snapshotted_data.dbt_unique_key_1 is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.tag_timestamp)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.tag_timestamp)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

            where 
    
        source_data.dbt_unique_key_1 is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    )
;
[0m02:17:02.868110 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bd1f51-0106-c57f-0002-c72a000462ae
[0m02:17:02.868110 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 16 at position 21
invalid identifier 'TIMESTAMP'
[0m02:17:02.884893 [debug] [Thread-1 (]: Database Error in snapshot snap_tags (snapshots\snap_tag.sql)
  000904 (42000): SQL compilation error: error line 16 at position 21
  invalid identifier 'TIMESTAMP'
[0m02:17:02.884893 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a00ab36d-e66f-454f-b62c-8306751f4e91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C1531AA50>]}
[0m02:17:02.884893 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshots.snap_tags .................................. [[31mERROR[0m in 1.57s]
[0m02:17:02.884893 [debug] [Thread-1 (]: Finished running node snapshot.Slip_Tests.snap_tags
[0m02:17:02.897941 [debug] [Thread-4 (]: Marking all children of 'snapshot.Slip_Tests.snap_tags' to be skipped because of status 'error'.  Reason: Database Error in snapshot snap_tags (snapshots\snap_tag.sql)
  000904 (42000): SQL compilation error: error line 16 at position 21
  invalid identifier 'TIMESTAMP'.
[0m02:17:02.900950 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:17:02.901948 [debug] [MainThread]: Connection 'list_MOVIELENS' was left open.
[0m02:17:02.901948 [debug] [MainThread]: On list_MOVIELENS: Close
[0m02:17:03.266877 [debug] [MainThread]: Connection 'list_MOVIELENS_snapshots' was left open.
[0m02:17:03.266877 [debug] [MainThread]: On list_MOVIELENS_snapshots: Close
[0m02:17:03.651751 [debug] [MainThread]: Connection 'snapshot.Slip_Tests.snap_tags' was left open.
[0m02:17:03.651751 [debug] [MainThread]: On snapshot.Slip_Tests.snap_tags: Close
[0m02:17:04.011271 [info ] [MainThread]: 
[0m02:17:04.026769 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 6.90 seconds (6.90s).
[0m02:17:04.026769 [debug] [MainThread]: Command end result
[0m02:17:04.048011 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m02:17:04.048011 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m02:17:04.068277 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\dbt_workspace\Slip_Tests\target\run_results.json
[0m02:17:04.068277 [info ] [MainThread]: 
[0m02:17:04.068277 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m02:17:04.068277 [info ] [MainThread]: 
[0m02:17:04.068277 [error] [MainThread]: [31mFailure in snapshot snap_tags (snapshots\snap_tag.sql)[0m
[0m02:17:04.068277 [error] [MainThread]:   Database Error in snapshot snap_tags (snapshots\snap_tag.sql)
  000904 (42000): SQL compilation error: error line 16 at position 21
  invalid identifier 'TIMESTAMP'
[0m02:17:04.068277 [info ] [MainThread]: 
[0m02:17:04.068277 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m02:17:04.068277 [debug] [MainThread]: Command `dbt snapshot` failed at 02:17:04.068277 after 9.51 seconds
[0m02:17:04.068277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C11DEC920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C1219B3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C147FA0F0>]}
[0m02:17:04.077069 [debug] [MainThread]: Flushing usage events
[0m02:17:05.124591 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:19:30.949913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1DE330EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1E1A5BA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1E1A5BDA0>]}


============================== 02:19:30.949913 | 5198c763-16d1-4715-831d-595093d9f495 ==============================
[0m02:19:30.949913 [info ] [MainThread]: Running with dbt=1.10.1
[0m02:19:30.949913 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\ThembaniFaleni\\.dbt', 'log_path': 'C:\\dbt_workspace\\Slip_Tests\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt snapshot', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:19:31.639305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5198c763-16d1-4715-831d-595093d9f495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1E1DF4290>]}
[0m02:19:31.780380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5198c763-16d1-4715-831d-595093d9f495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1E410A840>]}
[0m02:19:31.780380 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m02:19:31.966685 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m02:19:32.135971 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:19:32.135971 [debug] [MainThread]: Partial parsing: updated file: Slip_Tests://snapshots\snap_tag.sql
[0m02:19:33.038207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5198c763-16d1-4715-831d-595093d9f495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1E4811EE0>]}
[0m02:19:33.130021 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m02:19:33.138659 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m02:19:33.161558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5198c763-16d1-4715-831d-595093d9f495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1E485C5F0>]}
[0m02:19:33.161558 [info ] [MainThread]: Found 12 models, 12 data tests, 1 snapshot, 6 sources, 592 macros
[0m02:19:33.161558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5198c763-16d1-4715-831d-595093d9f495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1E46AB9E0>]}
[0m02:19:33.161558 [info ] [MainThread]: 
[0m02:19:33.161558 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:19:33.161558 [info ] [MainThread]: 
[0m02:19:33.173348 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:19:33.175134 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MOVIELENS'
[0m02:19:33.224350 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS"
[0m02:19:33.224350 [debug] [ThreadPool]: On list_MOVIELENS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS"} */
show terse schemas in database MOVIELENS
    limit 10000
[0m02:19:33.224350 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:19:34.500146 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.265 seconds
[0m02:19:34.507682 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MOVIELENS_snapshots'
[0m02:19:34.507682 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m02:19:34.507682 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
alter session set quoted_identifiers_ignore_case = false;
[0m02:19:34.507682 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:19:35.558340 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.050 seconds
[0m02:19:35.573969 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m02:19:35.573969 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
show objects in MOVIELENS.snapshots
    limit 10000
    
;
[0m02:19:35.842338 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.266 seconds
[0m02:19:35.843455 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m02:19:35.843455 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
alter session unset quoted_identifiers_ignore_case;
[0m02:19:36.045016 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.204 seconds
[0m02:19:36.045016 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MOVIELENS_snapshots, now list_MOVIELENS_DEV)
[0m02:19:36.045016 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m02:19:36.045016 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session set quoted_identifiers_ignore_case = false;
[0m02:19:36.264583 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.221 seconds
[0m02:19:36.280212 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m02:19:36.280212 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
show objects in MOVIELENS.DEV
    limit 10000
    
;
[0m02:19:36.544579 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.274 seconds
[0m02:19:36.560320 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m02:19:36.560320 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session unset quoted_identifiers_ignore_case;
[0m02:19:36.827653 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.270 seconds
[0m02:19:36.827653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5198c763-16d1-4715-831d-595093d9f495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1E485C620>]}
[0m02:19:36.845138 [debug] [Thread-1 (]: Began running node snapshot.Slip_Tests.snap_tags
[0m02:19:36.845138 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.snap_tags ...................................... [RUN]
[0m02:19:36.845138 [debug] [Thread-1 (]: Acquiring new snowflake connection 'snapshot.Slip_Tests.snap_tags'
[0m02:19:36.845138 [debug] [Thread-1 (]: Began compiling node snapshot.Slip_Tests.snap_tags
[0m02:19:36.845138 [debug] [Thread-1 (]: Began executing node snapshot.Slip_Tests.snap_tags
[0m02:19:36.905124 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m02:19:36.905124 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
[0m02:19:36.906126 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:19:37.892738 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.999 seconds
[0m02:19:37.957306 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m02:19:37.957306 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
create or replace temporary table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS__dbt_tmp"
as (
    
    
    with snapshot_query as (

        



SELECT
    md5(cast(coalesce(cast(user_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(movie_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS id,
    user_id,
    movie_id,
    tag,
    TO_TIMESTAMP_LTZ(tag_timestamp) AS tag_timestamp
FROM MOVIELENS.DEV.src_tags
-- LIMIT 100


    ),

    snapshotted_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    

        from "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    
,
            tag_timestamp as dbt_updated_at,
            tag_timestamp as dbt_valid_from,
            
  
  coalesce(nullif(tag_timestamp, tag_timestamp), null)
  as dbt_valid_to
,
            md5(coalesce(cast(user_id as varchar ), '')
         || '|' || coalesce(cast(movie_id as varchar ), '')
         || '|' || coalesce(cast(tag as varchar ), '')
         || '|' || coalesce(cast(tag_timestamp as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    
,
            tag_timestamp as dbt_updated_at,
            tag_timestamp as dbt_valid_from,
            tag_timestamp as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

            where 
    
        snapshotted_data.dbt_unique_key_1 is null
    

            or (
    
        snapshotted_data.dbt_unique_key_1 is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.tag_timestamp)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.tag_timestamp)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

            where 
    
        source_data.dbt_unique_key_1 is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    )
;
[0m02:19:39.930120 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.975 seconds
[0m02:19:39.930120 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m02:19:39.930120 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS__dbt_tmp"
[0m02:19:40.165988 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.224 seconds
[0m02:19:40.165988 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m02:19:40.165988 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
[0m02:19:40.369925 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.208 seconds
[0m02:19:40.385766 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m02:19:40.385766 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS__dbt_tmp"
[0m02:19:40.590423 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.209 seconds
[0m02:19:40.590423 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m02:19:40.590423 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
[0m02:19:40.792914 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.190 seconds
[0m02:19:40.792914 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m02:19:40.792914 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS__dbt_tmp"
[0m02:19:41.013102 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.214 seconds
[0m02:19:41.028784 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m02:19:41.028784 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
/* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
select * from (
        
    
    with snapshot_query as (

        



SELECT
    md5(cast(coalesce(cast(user_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(movie_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS id,
    user_id,
    movie_id,
    tag,
    TO_TIMESTAMP_LTZ(tag_timestamp) AS tag_timestamp
FROM MOVIELENS.DEV.src_tags
-- LIMIT 100


    ),

    snapshotted_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    

        from "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    
,
            tag_timestamp as dbt_updated_at,
            tag_timestamp as dbt_valid_from,
            
  
  coalesce(nullif(tag_timestamp, tag_timestamp), null)
  as dbt_valid_to
,
            md5(coalesce(cast(user_id as varchar ), '')
         || '|' || coalesce(cast(movie_id as varchar ), '')
         || '|' || coalesce(cast(tag as varchar ), '')
         || '|' || coalesce(cast(tag_timestamp as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    
,
            tag_timestamp as dbt_updated_at,
            tag_timestamp as dbt_valid_from,
            tag_timestamp as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

            where 
    
        snapshotted_data.dbt_unique_key_1 is null
    

            or (
    
        snapshotted_data.dbt_unique_key_1 is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.tag_timestamp)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.tag_timestamp)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

            where 
    
        source_data.dbt_unique_key_1 is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m02:19:41.405000 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.367 seconds
[0m02:19:41.405000 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m02:19:41.405000 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
/* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m02:19:41.641046 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.230 seconds
[0m02:19:41.641046 [warn ] [Thread-1 (]: Data type of snapshot table timestamp columns (TIMESTAMP_NTZ) doesn't match derived column 'updated_at' (TIMESTAMP_LTZ). Please update snapshot config 'updated_at'.
[0m02:19:41.641046 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.Slip_Tests.snap_tags"
[0m02:19:41.641046 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m02:19:41.641046 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
BEGIN
[0m02:19:41.876342 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.230 seconds
[0m02:19:41.876342 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m02:19:41.876342 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
merge into "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS" as DBT_INTERNAL_DEST
    using "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("ID", "USER_ID", "MOVIE_ID", "TAG", "TAG_TIMESTAMP", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("ID", "USER_ID", "MOVIE_ID", "TAG", "TAG_TIMESTAMP", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m02:19:42.532835 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.657 seconds
[0m02:19:42.532835 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m02:19:42.532835 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
COMMIT
[0m02:19:42.924027 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.387 seconds
[0m02:19:42.939551 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5198c763-16d1-4715-831d-595093d9f495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1DF0A9310>]}
[0m02:19:42.939551 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.snap_tags ...................................... [[32mSUCCESS 0[0m in 6.09s]
[0m02:19:42.939551 [debug] [Thread-1 (]: Finished running node snapshot.Slip_Tests.snap_tags
[0m02:19:42.955177 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:19:42.955177 [debug] [MainThread]: Connection 'list_MOVIELENS' was left open.
[0m02:19:42.955177 [debug] [MainThread]: On list_MOVIELENS: Close
[0m02:19:43.315942 [debug] [MainThread]: Connection 'list_MOVIELENS_DEV' was left open.
[0m02:19:43.331704 [debug] [MainThread]: On list_MOVIELENS_DEV: Close
[0m02:19:43.694363 [debug] [MainThread]: Connection 'snapshot.Slip_Tests.snap_tags' was left open.
[0m02:19:43.694363 [debug] [MainThread]: On snapshot.Slip_Tests.snap_tags: Close
[0m02:19:44.054481 [info ] [MainThread]: 
[0m02:19:44.054481 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 10.88 seconds (10.88s).
[0m02:19:44.054481 [debug] [MainThread]: Command end result
[0m02:19:44.094013 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m02:19:44.094013 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m02:19:44.120255 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\dbt_workspace\Slip_Tests\target\run_results.json
[0m02:19:44.120255 [info ] [MainThread]: 
[0m02:19:44.121280 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:19:44.122240 [info ] [MainThread]: 
[0m02:19:44.122240 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m02:19:44.123613 [debug] [MainThread]: Command `dbt snapshot` succeeded at 02:19:44.123613 after 13.41 seconds
[0m02:19:44.124621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1E1F01220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1E1ACBDA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1E14E04A0>]}
[0m02:19:44.124621 [debug] [MainThread]: Flushing usage events
[0m02:19:45.337463 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:23:09.753516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002036D1BB980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002036D1BA510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002036D1BB290>]}


============================== 02:23:09.769141 | b895d465-1779-4d38-b37b-3ec3c4552e59 ==============================
[0m02:23:09.769141 [info ] [MainThread]: Running with dbt=1.10.1
[0m02:23:09.769141 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\ThembaniFaleni\\.dbt', 'log_path': 'C:\\dbt_workspace\\Slip_Tests\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:23:10.407074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b895d465-1779-4d38-b37b-3ec3c4552e59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002036CB78DD0>]}
[0m02:23:10.548680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b895d465-1779-4d38-b37b-3ec3c4552e59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002036CB18650>]}
[0m02:23:10.565103 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m02:23:10.743578 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m02:23:10.916153 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:23:10.916153 [debug] [MainThread]: Partial parsing: updated file: Slip_Tests://snapshots\snap_tag.sql
[0m02:23:11.805629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b895d465-1779-4d38-b37b-3ec3c4552e59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002036FF5BB00>]}
[0m02:23:11.899296 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m02:23:11.914886 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m02:23:11.937107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b895d465-1779-4d38-b37b-3ec3c4552e59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002036FEE82C0>]}
[0m02:23:11.946682 [info ] [MainThread]: Found 12 models, 12 data tests, 1 snapshot, 6 sources, 592 macros
[0m02:23:11.946682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b895d465-1779-4d38-b37b-3ec3c4552e59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002036FD8FB00>]}
[0m02:23:11.946682 [info ] [MainThread]: 
[0m02:23:11.946682 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:23:11.946682 [info ] [MainThread]: 
[0m02:23:11.946682 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:23:11.946682 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MOVIELENS'
[0m02:23:12.014090 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS"
[0m02:23:12.015136 [debug] [ThreadPool]: On list_MOVIELENS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS"} */
show terse schemas in database MOVIELENS
    limit 10000
[0m02:23:12.015136 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:23:13.906018 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.904 seconds
[0m02:23:13.921600 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MOVIELENS_snapshots'
[0m02:23:13.937215 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m02:23:13.937215 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
alter session set quoted_identifiers_ignore_case = false;
[0m02:23:13.937215 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:23:15.080715 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.151 seconds
[0m02:23:15.096262 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m02:23:15.096262 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
show objects in MOVIELENS.snapshots
    limit 10000
    
;
[0m02:23:15.363433 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.265 seconds
[0m02:23:15.367430 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m02:23:15.367430 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
alter session unset quoted_identifiers_ignore_case;
[0m02:23:15.613712 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.250 seconds
[0m02:23:15.613712 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MOVIELENS_snapshots, now list_MOVIELENS_DEV)
[0m02:23:15.622283 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m02:23:15.622913 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session set quoted_identifiers_ignore_case = false;
[0m02:23:15.883363 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.269 seconds
[0m02:23:15.895825 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m02:23:15.896824 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
show objects in MOVIELENS.DEV
    limit 10000
    
;
[0m02:23:16.148883 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.259 seconds
[0m02:23:16.148883 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m02:23:16.148883 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session unset quoted_identifiers_ignore_case;
[0m02:23:16.415378 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.263 seconds
[0m02:23:16.428989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b895d465-1779-4d38-b37b-3ec3c4552e59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002036FEFC2C0>]}
[0m02:23:16.434933 [debug] [Thread-1 (]: Began running node snapshot.Slip_Tests.snap_tags
[0m02:23:16.434933 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.snap_tags ...................................... [RUN]
[0m02:23:16.436885 [debug] [Thread-1 (]: Acquiring new snowflake connection 'snapshot.Slip_Tests.snap_tags'
[0m02:23:16.436885 [debug] [Thread-1 (]: Began compiling node snapshot.Slip_Tests.snap_tags
[0m02:23:16.443916 [debug] [Thread-1 (]: Began executing node snapshot.Slip_Tests.snap_tags
[0m02:23:16.496212 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m02:23:16.496212 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
[0m02:23:16.497224 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:23:17.635939 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 1.144 seconds
[0m02:23:17.683386 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m02:23:17.683386 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
create or replace temporary table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS__dbt_tmp"
as (
    
    
    with snapshot_query as (

        



SELECT
    md5(cast(coalesce(cast(user_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(movie_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS id,
    user_id,
    movie_id,
    tag,
    TO_TIMESTAMP_LTZ(tag_timestamp) AS tag_timestamp
FROM MOVIELENS.DEV.src_tags
-- LIMIT 100


    ),

    snapshotted_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    

        from "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    
,
            CAST(updated_at AS TIMESTAMP_LTZ) as dbt_updated_at,
            CAST(updated_at AS TIMESTAMP_LTZ) as dbt_valid_from,
            
  
  coalesce(nullif(CAST(updated_at AS TIMESTAMP_LTZ), CAST(updated_at AS TIMESTAMP_LTZ)), null)
  as dbt_valid_to
,
            md5(coalesce(cast(user_id as varchar ), '')
         || '|' || coalesce(cast(movie_id as varchar ), '')
         || '|' || coalesce(cast(tag as varchar ), '')
         || '|' || coalesce(cast(CAST(updated_at AS TIMESTAMP_LTZ) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    
,
            CAST(updated_at AS TIMESTAMP_LTZ) as dbt_updated_at,
            CAST(updated_at AS TIMESTAMP_LTZ) as dbt_valid_from,
            CAST(updated_at AS TIMESTAMP_LTZ) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

            where 
    
        snapshotted_data.dbt_unique_key_1 is null
    

            or (
    
        snapshotted_data.dbt_unique_key_1 is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.CAST(updated_at AS TIMESTAMP_LTZ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.CAST(updated_at AS TIMESTAMP_LTZ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

            where 
    
        source_data.dbt_unique_key_1 is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    )
;
[0m02:23:17.918599 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bd1f57-0106-c3d2-0002-c72a0004907a
[0m02:23:17.918599 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 148 at position 67 unexpected 'updated_at'.
syntax error line 153 at position 4 unexpected ')'.
syntax error line 153 at position 5 unexpected ','.
[0m02:23:17.934240 [debug] [Thread-1 (]: Database Error in snapshot snap_tags (snapshots\snap_tag.sql)
  001003 (42000): SQL compilation error:
  syntax error line 148 at position 67 unexpected 'updated_at'.
  syntax error line 153 at position 4 unexpected ')'.
  syntax error line 153 at position 5 unexpected ','.
[0m02:23:17.934240 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b895d465-1779-4d38-b37b-3ec3c4552e59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002037060C920>]}
[0m02:23:17.934240 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshots.snap_tags .................................. [[31mERROR[0m in 1.50s]
[0m02:23:17.934240 [debug] [Thread-1 (]: Finished running node snapshot.Slip_Tests.snap_tags
[0m02:23:17.934240 [debug] [Thread-4 (]: Marking all children of 'snapshot.Slip_Tests.snap_tags' to be skipped because of status 'error'.  Reason: Database Error in snapshot snap_tags (snapshots\snap_tag.sql)
  001003 (42000): SQL compilation error:
  syntax error line 148 at position 67 unexpected 'updated_at'.
  syntax error line 153 at position 4 unexpected ')'.
  syntax error line 153 at position 5 unexpected ','..
[0m02:23:17.934240 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:23:17.934240 [debug] [MainThread]: Connection 'list_MOVIELENS' was left open.
[0m02:23:17.949866 [debug] [MainThread]: On list_MOVIELENS: Close
[0m02:23:18.310204 [debug] [MainThread]: Connection 'list_MOVIELENS_DEV' was left open.
[0m02:23:18.310204 [debug] [MainThread]: On list_MOVIELENS_DEV: Close
[0m02:23:18.685977 [debug] [MainThread]: Connection 'snapshot.Slip_Tests.snap_tags' was left open.
[0m02:23:18.685977 [debug] [MainThread]: On snapshot.Slip_Tests.snap_tags: Close
[0m02:23:19.065263 [info ] [MainThread]: 
[0m02:23:19.065263 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 7.12 seconds (7.12s).
[0m02:23:19.076505 [debug] [MainThread]: Command end result
[0m02:23:19.093007 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m02:23:19.093007 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m02:23:19.113376 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\dbt_workspace\Slip_Tests\target\run_results.json
[0m02:23:19.113990 [info ] [MainThread]: 
[0m02:23:19.115180 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m02:23:19.115180 [info ] [MainThread]: 
[0m02:23:19.115180 [error] [MainThread]: [31mFailure in snapshot snap_tags (snapshots\snap_tag.sql)[0m
[0m02:23:19.115180 [error] [MainThread]:   Database Error in snapshot snap_tags (snapshots\snap_tag.sql)
  001003 (42000): SQL compilation error:
  syntax error line 148 at position 67 unexpected 'updated_at'.
  syntax error line 153 at position 4 unexpected ')'.
  syntax error line 153 at position 5 unexpected ','.
[0m02:23:19.115180 [info ] [MainThread]: 
[0m02:23:19.115180 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m02:23:19.115180 [debug] [MainThread]: Command `dbt snapshot` failed at 02:23:19.115180 after 9.61 seconds
[0m02:23:19.115180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002036CF2C7A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002036CF2CEF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002036C2C4B00>]}
[0m02:23:19.115180 [debug] [MainThread]: Flushing usage events
[0m02:23:20.190625 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:26:10.250582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B74905400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B773BAF60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B773BAF90>]}


============================== 02:26:10.254585 | de750fde-18b7-4308-ad81-9b4d6eac4b71 ==============================
[0m02:26:10.254585 [info ] [MainThread]: Running with dbt=1.10.1
[0m02:26:10.255697 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\ThembaniFaleni\\.dbt', 'log_path': 'C:\\dbt_workspace\\Slip_Tests\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:26:10.931766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de750fde-18b7-4308-ad81-9b4d6eac4b71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B7784B890>]}
[0m02:26:11.074097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'de750fde-18b7-4308-ad81-9b4d6eac4b71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B77896F60>]}
[0m02:26:11.074097 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m02:26:11.269928 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m02:26:11.472790 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:26:11.472790 [debug] [MainThread]: Partial parsing: updated file: Slip_Tests://snapshots\snap_tag.sql
[0m02:26:12.406713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de750fde-18b7-4308-ad81-9b4d6eac4b71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B7A17B1A0>]}
[0m02:26:12.500329 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m02:26:12.517035 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m02:26:12.532076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de750fde-18b7-4308-ad81-9b4d6eac4b71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B7A1D8170>]}
[0m02:26:12.532076 [info ] [MainThread]: Found 12 models, 12 data tests, 1 snapshot, 6 sources, 592 macros
[0m02:26:12.532076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de750fde-18b7-4308-ad81-9b4d6eac4b71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B7A189E50>]}
[0m02:26:12.532076 [info ] [MainThread]: 
[0m02:26:12.532076 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:26:12.532076 [info ] [MainThread]: 
[0m02:26:12.532076 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:26:12.546913 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MOVIELENS'
[0m02:26:12.611500 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS"
[0m02:26:12.612494 [debug] [ThreadPool]: On list_MOVIELENS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS"} */
show terse schemas in database MOVIELENS
    limit 10000
[0m02:26:12.612494 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:26:13.832332 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.223 seconds
[0m02:26:13.832332 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MOVIELENS_snapshots'
[0m02:26:13.847920 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m02:26:13.847920 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
alter session set quoted_identifiers_ignore_case = false;
[0m02:26:13.847920 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:26:15.055148 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.202 seconds
[0m02:26:15.055148 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m02:26:15.055148 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
show objects in MOVIELENS.snapshots
    limit 10000
    
;
[0m02:26:15.306779 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.255 seconds
[0m02:26:15.322282 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m02:26:15.322282 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
alter session unset quoted_identifiers_ignore_case;
[0m02:26:15.569735 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.245 seconds
[0m02:26:15.571599 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MOVIELENS_snapshots, now list_MOVIELENS_DEV)
[0m02:26:15.571599 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m02:26:15.571599 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session set quoted_identifiers_ignore_case = false;
[0m02:26:15.792506 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.224 seconds
[0m02:26:15.792506 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m02:26:15.792506 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
show objects in MOVIELENS.DEV
    limit 10000
    
;
[0m02:26:16.097873 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.293 seconds
[0m02:26:16.101872 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m02:26:16.102871 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session unset quoted_identifiers_ignore_case;
[0m02:26:16.356145 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.261 seconds
[0m02:26:16.356145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de750fde-18b7-4308-ad81-9b4d6eac4b71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B7A24B530>]}
[0m02:26:16.373302 [debug] [Thread-1 (]: Began running node snapshot.Slip_Tests.snap_tags
[0m02:26:16.373302 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.snap_tags ...................................... [RUN]
[0m02:26:16.373302 [debug] [Thread-1 (]: Acquiring new snowflake connection 'snapshot.Slip_Tests.snap_tags'
[0m02:26:16.373302 [debug] [Thread-1 (]: Began compiling node snapshot.Slip_Tests.snap_tags
[0m02:26:16.373302 [debug] [Thread-1 (]: Began executing node snapshot.Slip_Tests.snap_tags
[0m02:26:16.440424 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m02:26:16.440424 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
[0m02:26:16.440424 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:26:17.531592 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 1.091 seconds
[0m02:26:17.578843 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m02:26:17.578843 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
create or replace temporary table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS__dbt_tmp"
as (
    
    
    with snapshot_query as (

        



SELECT
    md5(cast(coalesce(cast(user_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(movie_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS id,
    user_id,
    movie_id,
    tag,
    TO_TIMESTAMP_LTZ(tag_timestamp) AS tag_timestamp
FROM MOVIELENS.DEV.src_tags
-- LIMIT 100


    ),

    snapshotted_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    

        from "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    
,
            tag_timestamp as dbt_updated_at,
            tag_timestamp as dbt_valid_from,
            
  
  coalesce(nullif(tag_timestamp, tag_timestamp), null)
  as dbt_valid_to
,
            md5(coalesce(cast(user_id as varchar ), '')
         || '|' || coalesce(cast(movie_id as varchar ), '')
         || '|' || coalesce(cast(tag as varchar ), '')
         || '|' || coalesce(cast(tag_timestamp as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    
,
            tag_timestamp as dbt_updated_at,
            tag_timestamp as dbt_valid_from,
            tag_timestamp as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

            where 
    
        snapshotted_data.dbt_unique_key_1 is null
    

            or (
    
        snapshotted_data.dbt_unique_key_1 is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.tag_timestamp)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.tag_timestamp)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

            where 
    
        source_data.dbt_unique_key_1 is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    )
;
[0m02:26:19.710027 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.131 seconds
[0m02:26:19.725564 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m02:26:19.725564 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS__dbt_tmp"
[0m02:26:19.967500 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.245 seconds
[0m02:26:19.967500 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m02:26:19.967500 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
[0m02:26:20.196394 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.216 seconds
[0m02:26:20.199442 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m02:26:20.199442 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS__dbt_tmp"
[0m02:26:20.414498 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.220 seconds
[0m02:26:20.414498 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m02:26:20.414498 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
[0m02:26:20.631202 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.207 seconds
[0m02:26:20.649241 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m02:26:20.651248 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS__dbt_tmp"
[0m02:26:20.875184 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.223 seconds
[0m02:26:20.885842 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m02:26:20.885842 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
/* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
select * from (
        
    
    with snapshot_query as (

        



SELECT
    md5(cast(coalesce(cast(user_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(movie_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS id,
    user_id,
    movie_id,
    tag,
    TO_TIMESTAMP_LTZ(tag_timestamp) AS tag_timestamp
FROM MOVIELENS.DEV.src_tags
-- LIMIT 100


    ),

    snapshotted_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    

        from "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    
,
            tag_timestamp as dbt_updated_at,
            tag_timestamp as dbt_valid_from,
            
  
  coalesce(nullif(tag_timestamp, tag_timestamp), null)
  as dbt_valid_to
,
            md5(coalesce(cast(user_id as varchar ), '')
         || '|' || coalesce(cast(movie_id as varchar ), '')
         || '|' || coalesce(cast(tag as varchar ), '')
         || '|' || coalesce(cast(tag_timestamp as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    
,
            tag_timestamp as dbt_updated_at,
            tag_timestamp as dbt_valid_from,
            tag_timestamp as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

            where 
    
        snapshotted_data.dbt_unique_key_1 is null
    

            or (
    
        snapshotted_data.dbt_unique_key_1 is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.tag_timestamp)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.tag_timestamp)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

            where 
    
        source_data.dbt_unique_key_1 is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m02:26:21.191665 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.304 seconds
[0m02:26:21.207400 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m02:26:21.207400 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
/* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m02:26:21.401902 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.201 seconds
[0m02:26:21.401902 [warn ] [Thread-1 (]: Data type of snapshot table timestamp columns (TIMESTAMP_NTZ) doesn't match derived column 'updated_at' (TIMESTAMP_LTZ). Please update snapshot config 'updated_at'.
[0m02:26:21.401902 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.Slip_Tests.snap_tags"
[0m02:26:21.401902 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m02:26:21.401902 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
BEGIN
[0m02:26:21.659720 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.252 seconds
[0m02:26:21.659720 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m02:26:21.659720 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
merge into "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS" as DBT_INTERNAL_DEST
    using "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("ID", "USER_ID", "MOVIE_ID", "TAG", "TAG_TIMESTAMP", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("ID", "USER_ID", "MOVIE_ID", "TAG", "TAG_TIMESTAMP", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m02:26:22.327648 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.660 seconds
[0m02:26:22.327648 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m02:26:22.327648 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
COMMIT
[0m02:26:22.813176 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.481 seconds
[0m02:26:22.828796 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de750fde-18b7-4308-ad81-9b4d6eac4b71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B7A9196A0>]}
[0m02:26:22.828796 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.snap_tags ...................................... [[32mSUCCESS 0[0m in 6.46s]
[0m02:26:22.828796 [debug] [Thread-1 (]: Finished running node snapshot.Slip_Tests.snap_tags
[0m02:26:22.828796 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:26:22.828796 [debug] [MainThread]: Connection 'list_MOVIELENS' was left open.
[0m02:26:22.828796 [debug] [MainThread]: On list_MOVIELENS: Close
[0m02:26:23.191001 [debug] [MainThread]: Connection 'list_MOVIELENS_DEV' was left open.
[0m02:26:23.191001 [debug] [MainThread]: On list_MOVIELENS_DEV: Close
[0m02:26:23.566315 [debug] [MainThread]: Connection 'snapshot.Slip_Tests.snap_tags' was left open.
[0m02:26:23.566315 [debug] [MainThread]: On snapshot.Slip_Tests.snap_tags: Close
[0m02:26:23.942813 [info ] [MainThread]: 
[0m02:26:23.942813 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 11.41 seconds (11.41s).
[0m02:26:23.942813 [debug] [MainThread]: Command end result
[0m02:26:23.984205 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m02:26:23.993821 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m02:26:24.001228 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\dbt_workspace\Slip_Tests\target\run_results.json
[0m02:26:24.001228 [info ] [MainThread]: 
[0m02:26:24.001228 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:26:24.001228 [info ] [MainThread]: 
[0m02:26:24.001228 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m02:26:24.001228 [debug] [MainThread]: Command `dbt snapshot` succeeded at 02:26:24.001228 after 14.02 seconds
[0m02:26:24.001228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B77611280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B76CDFFE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B76D0A810>]}
[0m02:26:24.001228 [debug] [MainThread]: Flushing usage events
[0m02:26:25.070295 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:32:55.851337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7C7AB8CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7CB42B020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7C80F9D00>]}


============================== 02:32:55.866350 | 12ddbcf6-e409-4f30-9398-79c84a6b4858 ==============================
[0m02:32:55.866350 [info ] [MainThread]: Running with dbt=1.10.1
[0m02:32:55.866350 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\dbt_workspace\\Slip_Tests\\logs', 'profiles_dir': 'C:\\Users\\ThembaniFaleni\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt clean', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:32:56.117204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12ddbcf6-e409-4f30-9398-79c84a6b4858', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7CAE86480>]}
[0m02:32:56.188958 [debug] [MainThread]: Command `dbt clean` succeeded at 02:32:56.188958 after 0.57 seconds
[0m02:32:56.188958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7CB980BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7CAA0A600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7CAA0BD70>]}
[0m02:32:56.188958 [debug] [MainThread]: Flushing usage events
[0m02:32:57.254608 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:33:00.554251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB35D48590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB34E54DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB34E54D10>]}


============================== 02:33:00.569858 | 828900f9-6297-4e74-a2c3-7d1a25721530 ==============================
[0m02:33:00.569858 [info ] [MainThread]: Running with dbt=1.10.1
[0m02:33:00.569858 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\dbt_workspace\\Slip_Tests\\logs', 'profiles_dir': 'C:\\Users\\ThembaniFaleni\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:33:00.834376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '828900f9-6297-4e74-a2c3-7d1a25721530', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB361739E0>]}
[0m02:33:00.850017 [debug] [MainThread]: Set downloads directory='C:\Users\THEMBA~1\AppData\Local\Temp\dbt-downloads-x6s_22ck'
[0m02:33:00.850017 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m02:33:02.067904 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m02:33:02.067904 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m02:33:02.753924 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m02:33:02.753924 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m02:33:03.381181 [info ] [MainThread]: Installed from version 1.3.0
[0m02:33:03.381181 [info ] [MainThread]: Up to date!
[0m02:33:03.381181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '828900f9-6297-4e74-a2c3-7d1a25721530', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB37354AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB361D6090>]}
[0m02:33:03.381181 [debug] [MainThread]: Command `dbt deps` succeeded at 02:33:03.381181 after 3.02 seconds
[0m02:33:03.381181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB35DC0B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB35709250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB35709160>]}
[0m02:33:03.381181 [debug] [MainThread]: Flushing usage events
[0m02:33:04.318506 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:33:07.464627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B65421FF80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B65421D130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B65421D0D0>]}


============================== 02:33:07.464627 | e3909e09-609e-4c36-a84e-c31999cdfbfe ==============================
[0m02:33:07.464627 [info ] [MainThread]: Running with dbt=1.10.1
[0m02:33:07.464627 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\dbt_workspace\\Slip_Tests\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\ThembaniFaleni\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt snapshot --select snap_tags', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:33:08.122668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e3909e09-609e-4c36-a84e-c31999cdfbfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6568AB8F0>]}
[0m02:33:08.261300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e3909e09-609e-4c36-a84e-c31999cdfbfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B65627F1A0>]}
[0m02:33:08.261300 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m02:33:08.475924 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m02:33:08.475924 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m02:33:08.475924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e3909e09-609e-4c36-a84e-c31999cdfbfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6569645F0>]}
[0m02:33:08.491455 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'tests' in "<unicode string>", line 71, column 5 in file
`models\schema.yml`
[0m02:33:08.491455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e3909e09-609e-4c36-a84e-c31999cdfbfe', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B654687500>]}
[0m02:33:10.207031 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'fct_rating' in the 'models' section of file 'models\schema.yml'
[0m02:33:10.740010 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.Slip_Tests.not_null_fct_rating_user_id.140768c4a8' (models\schema.yml) depends on a node named 'fct_rating' in package '' which was not found
[0m02:33:10.740010 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.Slip_Tests.not_null_fct_rating_movie_id.e7004ba604' (models\schema.yml) depends on a node named 'fct_rating' in package '' which was not found
[0m02:33:10.740010 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.Slip_Tests.not_null_fct_rating_rating.2f45ab1d54' (models\schema.yml) depends on a node named 'fct_rating' in package '' which was not found
[0m02:33:10.740010 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.Slip_Tests.dbt_utils_expression_is_true_fct_rating__select_sum_rating_from_ref_src_ratings_select_sum_rating_from_ref_fct_rating_.f8623932f1' (models\schema.yml) depends on a node named 'fct_rating' in package '' which was not found
[0m02:33:10.740010 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.Slip_Tests.dbt_utils_expression_is_true_fct_rating__select_sum_rating_from_ref_src_ratings_select_sum_rating_from_ref_fct_rating_.f8623932f1' (models\schema.yml) depends on a node named 'fct_rating' in package '' which was not found
[0m02:33:10.838780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3909e09-609e-4c36-a84e-c31999cdfbfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B657240D40>]}
[0m02:33:10.989315 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m02:33:11.004841 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m02:33:11.020473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3909e09-609e-4c36-a84e-c31999cdfbfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B65714EB10>]}
[0m02:33:11.020473 [info ] [MainThread]: Found 12 models, 1 snapshot, 12 data tests, 6 sources, 592 macros
[0m02:33:11.020473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3909e09-609e-4c36-a84e-c31999cdfbfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B657240C20>]}
[0m02:33:11.020473 [info ] [MainThread]: 
[0m02:33:11.020473 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:33:11.032672 [info ] [MainThread]: 
[0m02:33:11.033902 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:33:11.035454 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MOVIELENS'
[0m02:33:11.101495 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS"
[0m02:33:11.101495 [debug] [ThreadPool]: On list_MOVIELENS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS"} */
show terse schemas in database MOVIELENS
    limit 10000
[0m02:33:11.102496 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:33:12.790136 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.695 seconds
[0m02:33:12.790136 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MOVIELENS_snapshots'
[0m02:33:12.807245 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m02:33:12.807245 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
alter session set quoted_identifiers_ignore_case = false;
[0m02:33:12.807245 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:33:14.016310 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.208 seconds
[0m02:33:14.029342 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m02:33:14.029342 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
show objects in MOVIELENS.snapshots
    limit 10000
    
;
[0m02:33:14.328291 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.300 seconds
[0m02:33:14.328291 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m02:33:14.328291 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
alter session unset quoted_identifiers_ignore_case;
[0m02:33:14.625168 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.307 seconds
[0m02:33:14.640653 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MOVIELENS_snapshots, now list_MOVIELENS_DEV)
[0m02:33:14.643205 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m02:33:14.643205 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session set quoted_identifiers_ignore_case = false;
[0m02:33:14.943455 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.307 seconds
[0m02:33:14.943455 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m02:33:14.943455 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
show objects in MOVIELENS.DEV
    limit 10000
    
;
[0m02:33:15.315120 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.371 seconds
[0m02:33:15.315120 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m02:33:15.315120 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session unset quoted_identifiers_ignore_case;
[0m02:33:15.597972 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.274 seconds
[0m02:33:15.597972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3909e09-609e-4c36-a84e-c31999cdfbfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B657240470>]}
[0m02:33:15.597972 [debug] [Thread-1 (]: Began running node snapshot.Slip_Tests.snap_tags
[0m02:33:15.597972 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.snap_tags ...................................... [RUN]
[0m02:33:15.597972 [debug] [Thread-1 (]: Acquiring new snowflake connection 'snapshot.Slip_Tests.snap_tags'
[0m02:33:15.597972 [debug] [Thread-1 (]: Began compiling node snapshot.Slip_Tests.snap_tags
[0m02:33:15.617551 [debug] [Thread-1 (]: Began executing node snapshot.Slip_Tests.snap_tags
[0m02:33:15.678598 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m02:33:15.678598 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
[0m02:33:15.678598 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:33:16.725707 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 1.047 seconds
[0m02:33:16.772973 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m02:33:16.772973 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
create or replace temporary table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS__dbt_tmp"
as (
    
    
    with snapshot_query as (

        



SELECT
    md5(cast(coalesce(cast(user_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(movie_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS id,
    user_id,
    movie_id,
    tag,
    TO_TIMESTAMP_LTZ(tag_timestamp) AS tag_timestamp
FROM MOVIELENS.DEV.src_tags
-- LIMIT 100


    ),

    snapshotted_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    

        from "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    
,
            tag_timestamp as dbt_updated_at,
            tag_timestamp as dbt_valid_from,
            
  
  coalesce(nullif(tag_timestamp, tag_timestamp), null)
  as dbt_valid_to
,
            md5(coalesce(cast(user_id as varchar ), '')
         || '|' || coalesce(cast(movie_id as varchar ), '')
         || '|' || coalesce(cast(tag as varchar ), '')
         || '|' || coalesce(cast(tag_timestamp as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    
,
            tag_timestamp as dbt_updated_at,
            tag_timestamp as dbt_valid_from,
            tag_timestamp as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

            where 
    
        snapshotted_data.dbt_unique_key_1 is null
    

            or (
    
        snapshotted_data.dbt_unique_key_1 is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.tag_timestamp)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.tag_timestamp)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

            where 
    
        source_data.dbt_unique_key_1 is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    )
;
[0m02:33:18.857487 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.073 seconds
[0m02:33:18.857487 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m02:33:18.857487 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS__dbt_tmp"
[0m02:33:19.123943 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.273 seconds
[0m02:33:19.139440 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m02:33:19.139440 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
[0m02:33:19.358911 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.219 seconds
[0m02:33:19.358911 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m02:33:19.358911 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS__dbt_tmp"
[0m02:33:19.656482 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.301 seconds
[0m02:33:19.656482 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m02:33:19.656482 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
[0m02:33:19.875415 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.210 seconds
[0m02:33:19.875415 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m02:33:19.875415 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS__dbt_tmp"
[0m02:33:20.095052 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.215 seconds
[0m02:33:20.110689 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m02:33:20.110689 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
/* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
select * from (
        
    
    with snapshot_query as (

        



SELECT
    md5(cast(coalesce(cast(user_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(movie_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS id,
    user_id,
    movie_id,
    tag,
    TO_TIMESTAMP_LTZ(tag_timestamp) AS tag_timestamp
FROM MOVIELENS.DEV.src_tags
-- LIMIT 100


    ),

    snapshotted_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    

        from "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    
,
            tag_timestamp as dbt_updated_at,
            tag_timestamp as dbt_valid_from,
            
  
  coalesce(nullif(tag_timestamp, tag_timestamp), null)
  as dbt_valid_to
,
            md5(coalesce(cast(user_id as varchar ), '')
         || '|' || coalesce(cast(movie_id as varchar ), '')
         || '|' || coalesce(cast(tag as varchar ), '')
         || '|' || coalesce(cast(tag_timestamp as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    
,
            tag_timestamp as dbt_updated_at,
            tag_timestamp as dbt_valid_from,
            tag_timestamp as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

            where 
    
        snapshotted_data.dbt_unique_key_1 is null
    

            or (
    
        snapshotted_data.dbt_unique_key_1 is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.tag_timestamp)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.tag_timestamp)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

            where 
    
        source_data.dbt_unique_key_1 is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m02:33:20.768707 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.657 seconds
[0m02:33:20.784281 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m02:33:20.784281 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
/* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m02:33:20.973464 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.197 seconds
[0m02:33:20.973464 [warn ] [Thread-1 (]: Data type of snapshot table timestamp columns (TIMESTAMP_NTZ) doesn't match derived column 'updated_at' (TIMESTAMP_LTZ). Please update snapshot config 'updated_at'.
[0m02:33:20.973464 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.Slip_Tests.snap_tags"
[0m02:33:20.973464 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m02:33:20.973464 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
BEGIN
[0m02:33:21.234691 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.254 seconds
[0m02:33:21.234691 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m02:33:21.234691 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
merge into "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS" as DBT_INTERNAL_DEST
    using "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("ID", "USER_ID", "MOVIE_ID", "TAG", "TAG_TIMESTAMP", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("ID", "USER_ID", "MOVIE_ID", "TAG", "TAG_TIMESTAMP", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m02:33:21.777051 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.536 seconds
[0m02:33:21.777051 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m02:33:21.777051 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
COMMIT
[0m02:33:22.194664 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.417 seconds
[0m02:33:22.210181 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3909e09-609e-4c36-a84e-c31999cdfbfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6517F9340>]}
[0m02:33:22.210181 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.snap_tags ...................................... [[32mSUCCESS 0[0m in 6.61s]
[0m02:33:22.210181 [debug] [Thread-1 (]: Finished running node snapshot.Slip_Tests.snap_tags
[0m02:33:22.210181 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:33:22.210181 [debug] [MainThread]: Connection 'list_MOVIELENS' was left open.
[0m02:33:22.210181 [debug] [MainThread]: On list_MOVIELENS: Close
[0m02:33:22.570829 [debug] [MainThread]: Connection 'list_MOVIELENS_DEV' was left open.
[0m02:33:22.570829 [debug] [MainThread]: On list_MOVIELENS_DEV: Close
[0m02:33:22.934377 [debug] [MainThread]: Connection 'snapshot.Slip_Tests.snap_tags' was left open.
[0m02:33:22.934920 [debug] [MainThread]: On snapshot.Slip_Tests.snap_tags: Close
[0m02:33:23.292029 [info ] [MainThread]: 
[0m02:33:23.292029 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 12.26 seconds (12.26s).
[0m02:33:23.292029 [debug] [MainThread]: Command end result
[0m02:33:23.313304 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m02:33:23.313304 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m02:33:23.327175 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\dbt_workspace\Slip_Tests\target\run_results.json
[0m02:33:23.327175 [info ] [MainThread]: 
[0m02:33:23.327175 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:33:23.327175 [info ] [MainThread]: 
[0m02:33:23.327175 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m02:33:23.327175 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m02:33:23.327175 [debug] [MainThread]: Command `dbt snapshot` succeeded at 02:33:23.327175 after 16.07 seconds
[0m02:33:23.327175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B654519E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B654650170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B65416FFE0>]}
[0m02:33:23.327175 [debug] [MainThread]: Flushing usage events
[0m02:33:24.248238 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:15:28.055489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4A0193110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4A0192DB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4A0192FC0>]}


============================== 10:15:28.096781 | 0b1651db-5fe6-4ec9-9946-6f40cf2d79ba ==============================
[0m10:15:28.096781 [info ] [MainThread]: Running with dbt=1.10.1
[0m10:15:28.098781 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ThembaniFaleni\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\dbt_workspace\\Slip_Tests\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:15:30.597723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b1651db-5fe6-4ec9-9946-6f40cf2d79ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4A0BB1730>]}
[0m10:15:30.769724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b1651db-5fe6-4ec9-9946-6f40cf2d79ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4A2A1BA40>]}
[0m10:15:30.772791 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m10:15:31.031243 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m10:15:31.254696 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:15:31.255697 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:15:31.327191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b1651db-5fe6-4ec9-9946-6f40cf2d79ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4A3085A00>]}
[0m10:15:31.483985 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m10:15:31.562079 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m10:15:31.811566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b1651db-5fe6-4ec9-9946-6f40cf2d79ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4A34C2990>]}
[0m10:15:31.812608 [info ] [MainThread]: Found 12 models, 1 snapshot, 12 data tests, 6 sources, 592 macros
[0m10:15:31.812608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b1651db-5fe6-4ec9-9946-6f40cf2d79ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4A3052F90>]}
[0m10:15:31.817667 [info ] [MainThread]: 
[0m10:15:31.818607 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:15:31.818607 [info ] [MainThread]: 
[0m10:15:31.819653 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:15:31.826601 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MOVIELENS_snapshots'
[0m10:15:32.754507 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m10:15:32.755506 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
alter session set quoted_identifiers_ignore_case = false;
[0m10:15:32.755506 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:15:34.927557 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 2.172 seconds
[0m10:15:34.932294 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m10:15:34.933178 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
show objects in MOVIELENS.snapshots
    limit 10000
    
;
[0m10:15:35.262809 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.330 seconds
[0m10:15:35.267807 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m10:15:35.267807 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
alter session unset quoted_identifiers_ignore_case;
[0m10:15:35.507489 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.239 seconds
[0m10:15:35.509488 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MOVIELENS_snapshots, now list_MOVIELENS_DEV)
[0m10:15:35.511486 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m10:15:35.512486 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session set quoted_identifiers_ignore_case = false;
[0m10:15:35.786235 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.274 seconds
[0m10:15:35.789848 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m10:15:35.790918 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
show objects in MOVIELENS.DEV
    limit 10000
    
;
[0m10:15:36.115872 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.325 seconds
[0m10:15:36.120590 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m10:15:36.121563 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session unset quoted_identifiers_ignore_case;
[0m10:15:36.375467 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.254 seconds
[0m10:15:36.379578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b1651db-5fe6-4ec9-9946-6f40cf2d79ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4A0C83770>]}
[0m10:15:36.395565 [debug] [Thread-1 (]: Began running node test.Slip_Tests.dbt_utils_equal_rowcount_fct_genome_score_ref_src_genome_score_.c5d70ca0d7
[0m10:15:36.396561 [info ] [Thread-1 (]: 1 of 12 START test dbt_utils_equal_rowcount_fct_genome_score_ref_src_genome_score_  [RUN]
[0m10:15:36.396561 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.Slip_Tests.dbt_utils_equal_rowcount_fct_genome_score_ref_src_genome_score_.c5d70ca0d7'
[0m10:15:36.397679 [debug] [Thread-1 (]: Began compiling node test.Slip_Tests.dbt_utils_equal_rowcount_fct_genome_score_ref_src_genome_score_.c5d70ca0d7
[0m10:15:36.422199 [debug] [Thread-1 (]: Writing injected SQL for node "test.Slip_Tests.dbt_utils_equal_rowcount_fct_genome_score_ref_src_genome_score_.c5d70ca0d7"
[0m10:15:36.424715 [debug] [Thread-1 (]: Began executing node test.Slip_Tests.dbt_utils_equal_rowcount_fct_genome_score_ref_src_genome_score_.c5d70ca0d7
[0m10:15:36.452554 [debug] [Thread-1 (]: Writing runtime sql for node "test.Slip_Tests.dbt_utils_equal_rowcount_fct_genome_score_ref_src_genome_score_.c5d70ca0d7"
[0m10:15:36.454432 [debug] [Thread-1 (]: Using snowflake connection "test.Slip_Tests.dbt_utils_equal_rowcount_fct_genome_score_ref_src_genome_score_.c5d70ca0d7"
[0m10:15:36.455432 [debug] [Thread-1 (]: On test.Slip_Tests.dbt_utils_equal_rowcount_fct_genome_score_ref_src_genome_score_.c5d70ca0d7: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "test.Slip_Tests.dbt_utils_equal_rowcount_fct_genome_score_ref_src_genome_score_.c5d70ca0d7"} */
select
      sum(coalesce(diff_count, 0)) as failures,
      sum(coalesce(diff_count, 0)) != 0 as should_warn,
      sum(coalesce(diff_count, 0)) != 0 as should_error
    from (
      
    
  




with a as (

    select 
      
      1 as id_dbtutils_test_equal_rowcount,
      count(*) as count_a 
    from MOVIELENS.DEV.fct_genome_score
    group by id_dbtutils_test_equal_rowcount


),
b as (

    select 
      
      1 as id_dbtutils_test_equal_rowcount,
      count(*) as count_b 
    from MOVIELENS.DEV.src_genome_score
    group by id_dbtutils_test_equal_rowcount

),
final as (

    select
    
        a.id_dbtutils_test_equal_rowcount as id_dbtutils_test_equal_rowcount_a,
          b.id_dbtutils_test_equal_rowcount as id_dbtutils_test_equal_rowcount_b,
        

        count_a,
        count_b,
        abs(count_a - count_b) as diff_count

    from a
    full join b
    on
    a.id_dbtutils_test_equal_rowcount = b.id_dbtutils_test_equal_rowcount
    


)

select * from final


  
  
      
    ) dbt_internal_test
[0m10:15:36.455432 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:15:37.618579 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.162 seconds
[0m10:15:37.627203 [info ] [Thread-1 (]: 1 of 12 PASS dbt_utils_equal_rowcount_fct_genome_score_ref_src_genome_score_ ... [[32mPASS[0m in 1.23s]
[0m10:15:37.628160 [debug] [Thread-1 (]: Finished running node test.Slip_Tests.dbt_utils_equal_rowcount_fct_genome_score_ref_src_genome_score_.c5d70ca0d7
[0m10:15:37.628160 [debug] [Thread-1 (]: Began running node test.Slip_Tests.dbt_utils_equal_rowcount_snap_tags_ref_src_tags_.78963607ce
[0m10:15:37.628160 [info ] [Thread-1 (]: 2 of 12 START test dbt_utils_equal_rowcount_snap_tags_ref_src_tags_ ............ [RUN]
[0m10:15:37.629935 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Slip_Tests.dbt_utils_equal_rowcount_fct_genome_score_ref_src_genome_score_.c5d70ca0d7, now test.Slip_Tests.dbt_utils_equal_rowcount_snap_tags_ref_src_tags_.78963607ce)
[0m10:15:37.630780 [debug] [Thread-1 (]: Began compiling node test.Slip_Tests.dbt_utils_equal_rowcount_snap_tags_ref_src_tags_.78963607ce
[0m10:15:37.635776 [debug] [Thread-1 (]: Writing injected SQL for node "test.Slip_Tests.dbt_utils_equal_rowcount_snap_tags_ref_src_tags_.78963607ce"
[0m10:15:37.636798 [debug] [Thread-1 (]: Began executing node test.Slip_Tests.dbt_utils_equal_rowcount_snap_tags_ref_src_tags_.78963607ce
[0m10:15:37.637768 [debug] [Thread-1 (]: Writing runtime sql for node "test.Slip_Tests.dbt_utils_equal_rowcount_snap_tags_ref_src_tags_.78963607ce"
[0m10:15:37.640462 [debug] [Thread-1 (]: Using snowflake connection "test.Slip_Tests.dbt_utils_equal_rowcount_snap_tags_ref_src_tags_.78963607ce"
[0m10:15:37.640462 [debug] [Thread-1 (]: On test.Slip_Tests.dbt_utils_equal_rowcount_snap_tags_ref_src_tags_.78963607ce: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "test.Slip_Tests.dbt_utils_equal_rowcount_snap_tags_ref_src_tags_.78963607ce"} */
select
      sum(coalesce(diff_count, 0)) as failures,
      sum(coalesce(diff_count, 0)) != 0 as should_warn,
      sum(coalesce(diff_count, 0)) != 0 as should_error
    from (
      
    
  




with a as (

    select 
      
      1 as id_dbtutils_test_equal_rowcount,
      count(*) as count_a 
    from MOVIELENS.snapshots.snap_tags
    group by id_dbtutils_test_equal_rowcount


),
b as (

    select 
      
      1 as id_dbtutils_test_equal_rowcount,
      count(*) as count_b 
    from MOVIELENS.DEV.src_tags
    group by id_dbtutils_test_equal_rowcount

),
final as (

    select
    
        a.id_dbtutils_test_equal_rowcount as id_dbtutils_test_equal_rowcount_a,
          b.id_dbtutils_test_equal_rowcount as id_dbtutils_test_equal_rowcount_b,
        

        count_a,
        count_b,
        abs(count_a - count_b) as diff_count

    from a
    full join b
    on
    a.id_dbtutils_test_equal_rowcount = b.id_dbtutils_test_equal_rowcount
    


)

select * from final


  
  
      
    ) dbt_internal_test
[0m10:15:38.560908 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.919 seconds
[0m10:15:38.561790 [error] [Thread-1 (]: 2 of 12 FAIL 1 dbt_utils_equal_rowcount_snap_tags_ref_src_tags_ ................ [[31mFAIL 1[0m in 0.93s]
[0m10:15:38.563778 [debug] [Thread-1 (]: Finished running node test.Slip_Tests.dbt_utils_equal_rowcount_snap_tags_ref_src_tags_.78963607ce
[0m10:15:38.563778 [debug] [Thread-1 (]: Began running node test.Slip_Tests.not_null_dim_movies_movie_id.0f96ca970d
[0m10:15:38.563778 [info ] [Thread-1 (]: 3 of 12 START test not_null_dim_movies_movie_id ................................ [RUN]
[0m10:15:38.564792 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Slip_Tests.dbt_utils_equal_rowcount_snap_tags_ref_src_tags_.78963607ce, now test.Slip_Tests.not_null_dim_movies_movie_id.0f96ca970d)
[0m10:15:38.565792 [debug] [Thread-1 (]: Began compiling node test.Slip_Tests.not_null_dim_movies_movie_id.0f96ca970d
[0m10:15:38.571418 [debug] [Thread-1 (]: Writing injected SQL for node "test.Slip_Tests.not_null_dim_movies_movie_id.0f96ca970d"
[0m10:15:38.573423 [debug] [Thread-1 (]: Began executing node test.Slip_Tests.not_null_dim_movies_movie_id.0f96ca970d
[0m10:15:38.575489 [debug] [Thread-1 (]: Writing runtime sql for node "test.Slip_Tests.not_null_dim_movies_movie_id.0f96ca970d"
[0m10:15:38.576496 [debug] [Thread-1 (]: Using snowflake connection "test.Slip_Tests.not_null_dim_movies_movie_id.0f96ca970d"
[0m10:15:38.577456 [debug] [Thread-1 (]: On test.Slip_Tests.not_null_dim_movies_movie_id.0f96ca970d: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "test.Slip_Tests.not_null_dim_movies_movie_id.0f96ca970d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select movie_id
from MOVIELENS.DEV.dim_movies
where movie_id is null



  
  
      
    ) dbt_internal_test
[0m10:15:38.825634 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.248 seconds
[0m10:15:38.827564 [info ] [Thread-1 (]: 3 of 12 PASS not_null_dim_movies_movie_id ...................................... [[32mPASS[0m in 0.26s]
[0m10:15:38.828557 [debug] [Thread-1 (]: Finished running node test.Slip_Tests.not_null_dim_movies_movie_id.0f96ca970d
[0m10:15:38.828557 [debug] [Thread-1 (]: Began running node test.Slip_Tests.not_null_dim_movies_movie_title.0206534c81
[0m10:15:38.829800 [info ] [Thread-1 (]: 4 of 12 START test not_null_dim_movies_movie_title ............................. [RUN]
[0m10:15:38.830801 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Slip_Tests.not_null_dim_movies_movie_id.0f96ca970d, now test.Slip_Tests.not_null_dim_movies_movie_title.0206534c81)
[0m10:15:38.830801 [debug] [Thread-1 (]: Began compiling node test.Slip_Tests.not_null_dim_movies_movie_title.0206534c81
[0m10:15:38.834796 [debug] [Thread-1 (]: Writing injected SQL for node "test.Slip_Tests.not_null_dim_movies_movie_title.0206534c81"
[0m10:15:38.836755 [debug] [Thread-1 (]: Began executing node test.Slip_Tests.not_null_dim_movies_movie_title.0206534c81
[0m10:15:38.839812 [debug] [Thread-1 (]: Writing runtime sql for node "test.Slip_Tests.not_null_dim_movies_movie_title.0206534c81"
[0m10:15:38.840851 [debug] [Thread-1 (]: Using snowflake connection "test.Slip_Tests.not_null_dim_movies_movie_title.0206534c81"
[0m10:15:38.840851 [debug] [Thread-1 (]: On test.Slip_Tests.not_null_dim_movies_movie_title.0206534c81: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "test.Slip_Tests.not_null_dim_movies_movie_title.0206534c81"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select movie_title
from MOVIELENS.DEV.dim_movies
where movie_title is null



  
  
      
    ) dbt_internal_test
[0m10:15:39.099418 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.257 seconds
[0m10:15:39.102059 [info ] [Thread-1 (]: 4 of 12 PASS not_null_dim_movies_movie_title ................................... [[32mPASS[0m in 0.27s]
[0m10:15:39.102966 [debug] [Thread-1 (]: Finished running node test.Slip_Tests.not_null_dim_movies_movie_title.0206534c81
[0m10:15:39.103966 [debug] [Thread-1 (]: Began running node test.Slip_Tests.not_null_fct_genome_score_movie_id.a06a45d2b3
[0m10:15:39.104954 [info ] [Thread-1 (]: 5 of 12 START test not_null_fct_genome_score_movie_id .......................... [RUN]
[0m10:15:39.105952 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Slip_Tests.not_null_dim_movies_movie_title.0206534c81, now test.Slip_Tests.not_null_fct_genome_score_movie_id.a06a45d2b3)
[0m10:15:39.105952 [debug] [Thread-1 (]: Began compiling node test.Slip_Tests.not_null_fct_genome_score_movie_id.a06a45d2b3
[0m10:15:39.113469 [debug] [Thread-1 (]: Writing injected SQL for node "test.Slip_Tests.not_null_fct_genome_score_movie_id.a06a45d2b3"
[0m10:15:39.114464 [debug] [Thread-1 (]: Began executing node test.Slip_Tests.not_null_fct_genome_score_movie_id.a06a45d2b3
[0m10:15:39.118466 [debug] [Thread-1 (]: Writing runtime sql for node "test.Slip_Tests.not_null_fct_genome_score_movie_id.a06a45d2b3"
[0m10:15:39.119968 [debug] [Thread-1 (]: Using snowflake connection "test.Slip_Tests.not_null_fct_genome_score_movie_id.a06a45d2b3"
[0m10:15:39.120976 [debug] [Thread-1 (]: On test.Slip_Tests.not_null_fct_genome_score_movie_id.a06a45d2b3: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "test.Slip_Tests.not_null_fct_genome_score_movie_id.a06a45d2b3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select movie_id
from MOVIELENS.DEV.fct_genome_score
where movie_id is null



  
  
      
    ) dbt_internal_test
[0m10:15:39.390186 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.268 seconds
[0m10:15:39.393202 [info ] [Thread-1 (]: 5 of 12 PASS not_null_fct_genome_score_movie_id ................................ [[32mPASS[0m in 0.29s]
[0m10:15:39.395833 [debug] [Thread-1 (]: Finished running node test.Slip_Tests.not_null_fct_genome_score_movie_id.a06a45d2b3
[0m10:15:39.396921 [debug] [Thread-1 (]: Began running node test.Slip_Tests.not_null_fct_genome_score_relevance_score.c1509905ec
[0m10:15:39.397833 [info ] [Thread-1 (]: 6 of 12 START test not_null_fct_genome_score_relevance_score ................... [RUN]
[0m10:15:39.400377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Slip_Tests.not_null_fct_genome_score_movie_id.a06a45d2b3, now test.Slip_Tests.not_null_fct_genome_score_relevance_score.c1509905ec)
[0m10:15:39.401367 [debug] [Thread-1 (]: Began compiling node test.Slip_Tests.not_null_fct_genome_score_relevance_score.c1509905ec
[0m10:15:39.409375 [debug] [Thread-1 (]: Writing injected SQL for node "test.Slip_Tests.not_null_fct_genome_score_relevance_score.c1509905ec"
[0m10:15:39.412381 [debug] [Thread-1 (]: Began executing node test.Slip_Tests.not_null_fct_genome_score_relevance_score.c1509905ec
[0m10:15:39.416377 [debug] [Thread-1 (]: Writing runtime sql for node "test.Slip_Tests.not_null_fct_genome_score_relevance_score.c1509905ec"
[0m10:15:39.419376 [debug] [Thread-1 (]: Using snowflake connection "test.Slip_Tests.not_null_fct_genome_score_relevance_score.c1509905ec"
[0m10:15:39.419883 [debug] [Thread-1 (]: On test.Slip_Tests.not_null_fct_genome_score_relevance_score.c1509905ec: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "test.Slip_Tests.not_null_fct_genome_score_relevance_score.c1509905ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select relevance_score
from MOVIELENS.DEV.fct_genome_score
where relevance_score is null



  
  
      
    ) dbt_internal_test
[0m10:15:40.562124 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.141 seconds
[0m10:15:40.564630 [info ] [Thread-1 (]: 6 of 12 PASS not_null_fct_genome_score_relevance_score ......................... [[32mPASS[0m in 1.16s]
[0m10:15:40.565640 [debug] [Thread-1 (]: Finished running node test.Slip_Tests.not_null_fct_genome_score_relevance_score.c1509905ec
[0m10:15:40.566636 [debug] [Thread-1 (]: Began running node test.Slip_Tests.not_null_fct_genome_score_tag_id.5d40275b2b
[0m10:15:40.566636 [info ] [Thread-1 (]: 7 of 12 START test not_null_fct_genome_score_tag_id ............................ [RUN]
[0m10:15:40.567710 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Slip_Tests.not_null_fct_genome_score_relevance_score.c1509905ec, now test.Slip_Tests.not_null_fct_genome_score_tag_id.5d40275b2b)
[0m10:15:40.568694 [debug] [Thread-1 (]: Began compiling node test.Slip_Tests.not_null_fct_genome_score_tag_id.5d40275b2b
[0m10:15:40.573013 [debug] [Thread-1 (]: Writing injected SQL for node "test.Slip_Tests.not_null_fct_genome_score_tag_id.5d40275b2b"
[0m10:15:40.574015 [debug] [Thread-1 (]: Began executing node test.Slip_Tests.not_null_fct_genome_score_tag_id.5d40275b2b
[0m10:15:40.576123 [debug] [Thread-1 (]: Writing runtime sql for node "test.Slip_Tests.not_null_fct_genome_score_tag_id.5d40275b2b"
[0m10:15:40.577016 [debug] [Thread-1 (]: Using snowflake connection "test.Slip_Tests.not_null_fct_genome_score_tag_id.5d40275b2b"
[0m10:15:40.577016 [debug] [Thread-1 (]: On test.Slip_Tests.not_null_fct_genome_score_tag_id.5d40275b2b: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "test.Slip_Tests.not_null_fct_genome_score_tag_id.5d40275b2b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select tag_id
from MOVIELENS.DEV.fct_genome_score
where tag_id is null



  
  
      
    ) dbt_internal_test
[0m10:15:40.814495 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.237 seconds
[0m10:15:40.818463 [info ] [Thread-1 (]: 7 of 12 PASS not_null_fct_genome_score_tag_id .................................. [[32mPASS[0m in 0.25s]
[0m10:15:40.819103 [debug] [Thread-1 (]: Finished running node test.Slip_Tests.not_null_fct_genome_score_tag_id.5d40275b2b
[0m10:15:40.820192 [debug] [Thread-1 (]: Began running node test.Slip_Tests.not_null_snap_tags_id.015a2066c2
[0m10:15:40.820192 [info ] [Thread-1 (]: 8 of 12 START test not_null_snap_tags_id ....................................... [RUN]
[0m10:15:40.821121 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Slip_Tests.not_null_fct_genome_score_tag_id.5d40275b2b, now test.Slip_Tests.not_null_snap_tags_id.015a2066c2)
[0m10:15:40.821121 [debug] [Thread-1 (]: Began compiling node test.Slip_Tests.not_null_snap_tags_id.015a2066c2
[0m10:15:40.826206 [debug] [Thread-1 (]: Writing injected SQL for node "test.Slip_Tests.not_null_snap_tags_id.015a2066c2"
[0m10:15:40.827154 [debug] [Thread-1 (]: Began executing node test.Slip_Tests.not_null_snap_tags_id.015a2066c2
[0m10:15:40.829661 [debug] [Thread-1 (]: Writing runtime sql for node "test.Slip_Tests.not_null_snap_tags_id.015a2066c2"
[0m10:15:40.831729 [debug] [Thread-1 (]: Using snowflake connection "test.Slip_Tests.not_null_snap_tags_id.015a2066c2"
[0m10:15:40.832730 [debug] [Thread-1 (]: On test.Slip_Tests.not_null_snap_tags_id.015a2066c2: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "test.Slip_Tests.not_null_snap_tags_id.015a2066c2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from MOVIELENS.snapshots.snap_tags
where id is null



  
  
      
    ) dbt_internal_test
[0m10:15:41.093768 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.260 seconds
[0m10:15:41.097765 [info ] [Thread-1 (]: 8 of 12 PASS not_null_snap_tags_id ............................................. [[32mPASS[0m in 0.28s]
[0m10:15:41.099765 [debug] [Thread-1 (]: Finished running node test.Slip_Tests.not_null_snap_tags_id.015a2066c2
[0m10:15:41.101302 [debug] [Thread-1 (]: Began running node test.Slip_Tests.not_null_snap_tags_movie_id.fb9962de5f
[0m10:15:41.102293 [info ] [Thread-1 (]: 9 of 12 START test not_null_snap_tags_movie_id ................................. [RUN]
[0m10:15:41.104302 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Slip_Tests.not_null_snap_tags_id.015a2066c2, now test.Slip_Tests.not_null_snap_tags_movie_id.fb9962de5f)
[0m10:15:41.105320 [debug] [Thread-1 (]: Began compiling node test.Slip_Tests.not_null_snap_tags_movie_id.fb9962de5f
[0m10:15:41.117201 [debug] [Thread-1 (]: Writing injected SQL for node "test.Slip_Tests.not_null_snap_tags_movie_id.fb9962de5f"
[0m10:15:41.119719 [debug] [Thread-1 (]: Began executing node test.Slip_Tests.not_null_snap_tags_movie_id.fb9962de5f
[0m10:15:41.121730 [debug] [Thread-1 (]: Writing runtime sql for node "test.Slip_Tests.not_null_snap_tags_movie_id.fb9962de5f"
[0m10:15:41.122730 [debug] [Thread-1 (]: Using snowflake connection "test.Slip_Tests.not_null_snap_tags_movie_id.fb9962de5f"
[0m10:15:41.123731 [debug] [Thread-1 (]: On test.Slip_Tests.not_null_snap_tags_movie_id.fb9962de5f: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "test.Slip_Tests.not_null_snap_tags_movie_id.fb9962de5f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select movie_id
from MOVIELENS.snapshots.snap_tags
where movie_id is null



  
  
      
    ) dbt_internal_test
[0m10:15:41.429356 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.305 seconds
[0m10:15:41.435750 [info ] [Thread-1 (]: 9 of 12 PASS not_null_snap_tags_movie_id ....................................... [[32mPASS[0m in 0.33s]
[0m10:15:41.438749 [debug] [Thread-1 (]: Finished running node test.Slip_Tests.not_null_snap_tags_movie_id.fb9962de5f
[0m10:15:41.439735 [debug] [Thread-1 (]: Began running node test.Slip_Tests.not_null_snap_tags_tag.b66ecb49f3
[0m10:15:41.442068 [info ] [Thread-1 (]: 10 of 12 START test not_null_snap_tags_tag ..................................... [RUN]
[0m10:15:41.443067 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Slip_Tests.not_null_snap_tags_movie_id.fb9962de5f, now test.Slip_Tests.not_null_snap_tags_tag.b66ecb49f3)
[0m10:15:41.444082 [debug] [Thread-1 (]: Began compiling node test.Slip_Tests.not_null_snap_tags_tag.b66ecb49f3
[0m10:15:41.454582 [debug] [Thread-1 (]: Writing injected SQL for node "test.Slip_Tests.not_null_snap_tags_tag.b66ecb49f3"
[0m10:15:41.456585 [debug] [Thread-1 (]: Began executing node test.Slip_Tests.not_null_snap_tags_tag.b66ecb49f3
[0m10:15:41.463097 [debug] [Thread-1 (]: Writing runtime sql for node "test.Slip_Tests.not_null_snap_tags_tag.b66ecb49f3"
[0m10:15:41.465098 [debug] [Thread-1 (]: Using snowflake connection "test.Slip_Tests.not_null_snap_tags_tag.b66ecb49f3"
[0m10:15:41.466093 [debug] [Thread-1 (]: On test.Slip_Tests.not_null_snap_tags_tag.b66ecb49f3: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "test.Slip_Tests.not_null_snap_tags_tag.b66ecb49f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select tag
from MOVIELENS.snapshots.snap_tags
where tag is null



  
  
      
    ) dbt_internal_test
[0m10:15:41.730586 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.264 seconds
[0m10:15:41.733554 [info ] [Thread-1 (]: 10 of 12 PASS not_null_snap_tags_tag ........................................... [[32mPASS[0m in 0.29s]
[0m10:15:41.734570 [debug] [Thread-1 (]: Finished running node test.Slip_Tests.not_null_snap_tags_tag.b66ecb49f3
[0m10:15:41.734570 [debug] [Thread-1 (]: Began running node test.Slip_Tests.not_null_snap_tags_user_id.a9aef7cace
[0m10:15:41.735576 [info ] [Thread-1 (]: 11 of 12 START test not_null_snap_tags_user_id ................................. [RUN]
[0m10:15:41.736569 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Slip_Tests.not_null_snap_tags_tag.b66ecb49f3, now test.Slip_Tests.not_null_snap_tags_user_id.a9aef7cace)
[0m10:15:41.736569 [debug] [Thread-1 (]: Began compiling node test.Slip_Tests.not_null_snap_tags_user_id.a9aef7cace
[0m10:15:41.740992 [debug] [Thread-1 (]: Writing injected SQL for node "test.Slip_Tests.not_null_snap_tags_user_id.a9aef7cace"
[0m10:15:41.742040 [debug] [Thread-1 (]: Began executing node test.Slip_Tests.not_null_snap_tags_user_id.a9aef7cace
[0m10:15:41.744976 [debug] [Thread-1 (]: Writing runtime sql for node "test.Slip_Tests.not_null_snap_tags_user_id.a9aef7cace"
[0m10:15:41.746978 [debug] [Thread-1 (]: Using snowflake connection "test.Slip_Tests.not_null_snap_tags_user_id.a9aef7cace"
[0m10:15:41.748015 [debug] [Thread-1 (]: On test.Slip_Tests.not_null_snap_tags_user_id.a9aef7cace: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "test.Slip_Tests.not_null_snap_tags_user_id.a9aef7cace"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from MOVIELENS.snapshots.snap_tags
where user_id is null



  
  
      
    ) dbt_internal_test
[0m10:15:42.036108 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.288 seconds
[0m10:15:42.037105 [info ] [Thread-1 (]: 11 of 12 PASS not_null_snap_tags_user_id ....................................... [[32mPASS[0m in 0.30s]
[0m10:15:42.038143 [debug] [Thread-1 (]: Finished running node test.Slip_Tests.not_null_snap_tags_user_id.a9aef7cace
[0m10:15:42.038143 [debug] [Thread-1 (]: Began running node test.Slip_Tests.unique_snap_tags_id.4ac4f44417
[0m10:15:42.039792 [info ] [Thread-1 (]: 12 of 12 START test unique_snap_tags_id ........................................ [RUN]
[0m10:15:42.040841 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Slip_Tests.not_null_snap_tags_user_id.a9aef7cace, now test.Slip_Tests.unique_snap_tags_id.4ac4f44417)
[0m10:15:42.040841 [debug] [Thread-1 (]: Began compiling node test.Slip_Tests.unique_snap_tags_id.4ac4f44417
[0m10:15:42.047856 [debug] [Thread-1 (]: Writing injected SQL for node "test.Slip_Tests.unique_snap_tags_id.4ac4f44417"
[0m10:15:42.050440 [debug] [Thread-1 (]: Began executing node test.Slip_Tests.unique_snap_tags_id.4ac4f44417
[0m10:15:42.053435 [debug] [Thread-1 (]: Writing runtime sql for node "test.Slip_Tests.unique_snap_tags_id.4ac4f44417"
[0m10:15:42.053435 [debug] [Thread-1 (]: Using snowflake connection "test.Slip_Tests.unique_snap_tags_id.4ac4f44417"
[0m10:15:42.055071 [debug] [Thread-1 (]: On test.Slip_Tests.unique_snap_tags_id.4ac4f44417: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "test.Slip_Tests.unique_snap_tags_id.4ac4f44417"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from MOVIELENS.snapshots.snap_tags
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m10:15:42.424639 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.369 seconds
[0m10:15:42.427642 [info ] [Thread-1 (]: 12 of 12 PASS unique_snap_tags_id .............................................. [[32mPASS[0m in 0.39s]
[0m10:15:42.430803 [debug] [Thread-1 (]: Finished running node test.Slip_Tests.unique_snap_tags_id.4ac4f44417
[0m10:15:42.433802 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:15:42.435801 [debug] [MainThread]: Connection 'list_MOVIELENS_DEV' was left open.
[0m10:15:42.436813 [debug] [MainThread]: On list_MOVIELENS_DEV: Close
[0m10:15:42.808434 [debug] [MainThread]: Connection 'test.Slip_Tests.unique_snap_tags_id.4ac4f44417' was left open.
[0m10:15:42.809437 [debug] [MainThread]: On test.Slip_Tests.unique_snap_tags_id.4ac4f44417: Close
[0m10:15:43.202545 [info ] [MainThread]: 
[0m10:15:43.203496 [info ] [MainThread]: Finished running 12 data tests in 0 hours 0 minutes and 11.38 seconds (11.38s).
[0m10:15:43.205504 [debug] [MainThread]: Command end result
[0m10:15:43.227709 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m10:15:43.230225 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m10:15:43.251390 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\dbt_workspace\Slip_Tests\target\run_results.json
[0m10:15:43.252388 [info ] [MainThread]: 
[0m10:15:43.253385 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:15:43.254387 [info ] [MainThread]: 
[0m10:15:43.255426 [error] [MainThread]: [31mFailure in test dbt_utils_equal_rowcount_snap_tags_ref_src_tags_ (models\schema.yml)[0m
[0m10:15:43.255426 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m10:15:43.256384 [info ] [MainThread]: 
[0m10:15:43.257389 [info ] [MainThread]:   compiled code at target\compiled\Slip_Tests\models\schema.yml\dbt_utils_equal_rowcount_snap_tags_ref_src_tags_.sql
[0m10:15:43.258388 [info ] [MainThread]: 
[0m10:15:43.258388 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=12
[0m10:15:43.259389 [debug] [MainThread]: Command `dbt test` failed at 10:15:43.259389 after 15.47 seconds
[0m10:15:43.260710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D49D43DFA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4A057B860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D49FEA82F0>]}
[0m10:15:43.260710 [debug] [MainThread]: Flushing usage events
[0m10:15:44.725513 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:37:31.907918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1AAB29160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1AD289280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1AD2881A0>]}


============================== 10:37:31.915026 | 121c3bbe-c7fb-4ba3-a5cb-0927bfcf7b3a ==============================
[0m10:37:31.915026 [info ] [MainThread]: Running with dbt=1.10.1
[0m10:37:31.916020 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ThembaniFaleni\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\dbt_workspace\\Slip_Tests\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:37:33.519998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '121c3bbe-c7fb-4ba3-a5cb-0927bfcf7b3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1AFC55490>]}
[0m10:37:33.806728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '121c3bbe-c7fb-4ba3-a5cb-0927bfcf7b3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1AF67D2E0>]}
[0m10:37:33.809448 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m10:37:34.420741 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m10:37:34.911677 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:37:34.912680 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:37:35.077110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '121c3bbe-c7fb-4ba3-a5cb-0927bfcf7b3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1AFF34A40>]}
[0m10:37:35.480554 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m10:37:35.513525 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m10:37:35.582005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '121c3bbe-c7fb-4ba3-a5cb-0927bfcf7b3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1B01FFC50>]}
[0m10:37:35.583007 [info ] [MainThread]: Found 12 models, 1 snapshot, 12 data tests, 6 sources, 592 macros
[0m10:37:35.585013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '121c3bbe-c7fb-4ba3-a5cb-0927bfcf7b3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1B01C2630>]}
[0m10:37:35.590303 [info ] [MainThread]: 
[0m10:37:35.591302 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:37:35.593304 [info ] [MainThread]: 
[0m10:37:35.594328 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:37:35.596312 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MOVIELENS'
[0m10:37:35.778635 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS"
[0m10:37:35.780114 [debug] [ThreadPool]: On list_MOVIELENS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS"} */
show terse schemas in database MOVIELENS
    limit 10000
[0m10:37:35.781237 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:37:37.857284 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.076 seconds
[0m10:37:37.875591 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MOVIELENS_snapshots'
[0m10:37:37.900794 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m10:37:37.901793 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
alter session set quoted_identifiers_ignore_case = false;
[0m10:37:37.902793 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:37:39.134984 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.232 seconds
[0m10:37:39.144259 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m10:37:39.145274 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
show objects in MOVIELENS.snapshots
    limit 10000
    
;
[0m10:37:39.473435 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.327 seconds
[0m10:37:39.521393 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m10:37:39.523396 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
alter session unset quoted_identifiers_ignore_case;
[0m10:37:39.824490 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.300 seconds
[0m10:37:39.830018 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MOVIELENS_snapshots, now list_MOVIELENS_DEV)
[0m10:37:39.837017 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m10:37:39.839543 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session set quoted_identifiers_ignore_case = false;
[0m10:37:40.131049 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.291 seconds
[0m10:37:40.135048 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m10:37:40.136011 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
show objects in MOVIELENS.DEV
    limit 10000
    
;
[0m10:37:40.484914 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.348 seconds
[0m10:37:40.488913 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m10:37:40.489916 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session unset quoted_identifiers_ignore_case;
[0m10:37:40.719749 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.229 seconds
[0m10:37:40.725747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '121c3bbe-c7fb-4ba3-a5cb-0927bfcf7b3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1AF3853A0>]}
[0m10:37:40.733743 [debug] [Thread-1 (]: Began running node snapshot.Slip_Tests.snap_tags
[0m10:37:40.734744 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.snap_tags ...................................... [RUN]
[0m10:37:40.736744 [debug] [Thread-1 (]: Acquiring new snowflake connection 'snapshot.Slip_Tests.snap_tags'
[0m10:37:40.738254 [debug] [Thread-1 (]: Began compiling node snapshot.Slip_Tests.snap_tags
[0m10:37:40.796326 [debug] [Thread-1 (]: Began executing node snapshot.Slip_Tests.snap_tags
[0m10:37:40.966534 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m10:37:40.968207 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
[0m10:37:40.969276 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:37:42.249342 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 1.280 seconds
[0m10:37:42.424793 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m10:37:42.425785 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
create or replace temporary table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS__dbt_tmp"
as (
    
    
    with snapshot_query as (

        



SELECT
    md5(cast(coalesce(cast(user_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(movie_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS id,
    user_id,
    movie_id,
    tag,
    TO_TIMESTAMP_LTZ(tag_timestamp) AS tag_timestamp
FROM MOVIELENS.DEV.src_tags
-- LIMIT 100


    ),

    snapshotted_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    

        from "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    
,
            tag_timestamp as dbt_updated_at,
            tag_timestamp as dbt_valid_from,
            
  
  coalesce(nullif(tag_timestamp, tag_timestamp), null)
  as dbt_valid_to
,
            md5(coalesce(cast(user_id as varchar ), '')
         || '|' || coalesce(cast(movie_id as varchar ), '')
         || '|' || coalesce(cast(tag as varchar ), '')
         || '|' || coalesce(cast(tag_timestamp as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    
,
            tag_timestamp as dbt_updated_at,
            tag_timestamp as dbt_valid_from,
            tag_timestamp as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

            where 
    
        snapshotted_data.dbt_unique_key_1 is null
    

            or (
    
        snapshotted_data.dbt_unique_key_1 is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.tag_timestamp)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.tag_timestamp)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

            where 
    
        source_data.dbt_unique_key_1 is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    )
;
[0m10:37:46.371812 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.943 seconds
[0m10:37:46.379754 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m10:37:46.381753 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS__dbt_tmp"
[0m10:37:46.675056 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.292 seconds
[0m10:37:46.683147 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m10:37:46.684257 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
[0m10:37:46.924094 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.238 seconds
[0m10:37:46.934614 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m10:37:46.936613 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS__dbt_tmp"
[0m10:37:47.225968 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.288 seconds
[0m10:37:47.233928 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m10:37:47.234890 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
[0m10:37:47.456584 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.220 seconds
[0m10:37:47.473932 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m10:37:47.475932 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS__dbt_tmp"
[0m10:37:47.734730 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.258 seconds
[0m10:37:47.813151 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m10:37:47.831170 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
/* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
select * from (
        
    
    with snapshot_query as (

        



SELECT
    md5(cast(coalesce(cast(user_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(movie_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS id,
    user_id,
    movie_id,
    tag,
    TO_TIMESTAMP_LTZ(tag_timestamp) AS tag_timestamp
FROM MOVIELENS.DEV.src_tags
-- LIMIT 100


    ),

    snapshotted_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    

        from "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    
,
            tag_timestamp as dbt_updated_at,
            tag_timestamp as dbt_valid_from,
            
  
  coalesce(nullif(tag_timestamp, tag_timestamp), null)
  as dbt_valid_to
,
            md5(coalesce(cast(user_id as varchar ), '')
         || '|' || coalesce(cast(movie_id as varchar ), '')
         || '|' || coalesce(cast(tag as varchar ), '')
         || '|' || coalesce(cast(tag_timestamp as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    
,
            tag_timestamp as dbt_updated_at,
            tag_timestamp as dbt_valid_from,
            tag_timestamp as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

            where 
    
        snapshotted_data.dbt_unique_key_1 is null
    

            or (
    
        snapshotted_data.dbt_unique_key_1 is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.tag_timestamp)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.tag_timestamp)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

            where 
    
        source_data.dbt_unique_key_1 is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m10:37:48.508130 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.658 seconds
[0m10:37:48.519061 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m10:37:48.520311 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
/* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m10:37:48.784895 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.264 seconds
[0m10:37:48.786896 [warn ] [Thread-1 (]: Data type of snapshot table timestamp columns (TIMESTAMP_NTZ) doesn't match derived column 'updated_at' (TIMESTAMP_LTZ). Please update snapshot config 'updated_at'.
[0m10:37:48.788918 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.Slip_Tests.snap_tags"
[0m10:37:48.792383 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m10:37:48.794381 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
BEGIN
[0m10:37:49.069232 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.274 seconds
[0m10:37:49.070216 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m10:37:49.071229 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
merge into "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS" as DBT_INTERNAL_DEST
    using "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("ID", "USER_ID", "MOVIE_ID", "TAG", "TAG_TIMESTAMP", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("ID", "USER_ID", "MOVIE_ID", "TAG", "TAG_TIMESTAMP", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m10:37:51.925034 [debug] [Thread-1 (]: SQL status: SUCCESS 2 in 2.853 seconds
[0m10:37:51.926032 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m10:37:51.928035 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
COMMIT
[0m10:37:52.418863 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.489 seconds
[0m10:37:52.484001 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '121c3bbe-c7fb-4ba3-a5cb-0927bfcf7b3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1ACF51BE0>]}
[0m10:37:52.484903 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.snap_tags ...................................... [[32mSUCCESS 2[0m in 11.74s]
[0m10:37:52.486913 [debug] [Thread-1 (]: Finished running node snapshot.Slip_Tests.snap_tags
[0m10:37:52.490009 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:37:52.491009 [debug] [MainThread]: Connection 'list_MOVIELENS' was left open.
[0m10:37:52.492001 [debug] [MainThread]: On list_MOVIELENS: Close
[0m10:37:52.896851 [debug] [MainThread]: Connection 'list_MOVIELENS_DEV' was left open.
[0m10:37:52.899379 [debug] [MainThread]: On list_MOVIELENS_DEV: Close
[0m10:37:53.321163 [debug] [MainThread]: Connection 'snapshot.Slip_Tests.snap_tags' was left open.
[0m10:37:53.322167 [debug] [MainThread]: On snapshot.Slip_Tests.snap_tags: Close
[0m10:37:53.717302 [info ] [MainThread]: 
[0m10:37:53.722008 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 18.12 seconds (18.12s).
[0m10:37:53.726014 [debug] [MainThread]: Command end result
[0m10:37:53.822991 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m10:37:53.835044 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m10:37:53.863802 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\dbt_workspace\Slip_Tests\target\run_results.json
[0m10:37:53.864958 [info ] [MainThread]: 
[0m10:37:53.866063 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:37:53.867248 [info ] [MainThread]: 
[0m10:37:53.868319 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m10:37:53.870622 [debug] [MainThread]: Command `dbt snapshot` succeeded at 10:37:53.870622 after 22.36 seconds
[0m10:37:53.871690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1AB58F770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1AD769E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1AD07BCE0>]}
[0m10:37:53.872841 [debug] [MainThread]: Flushing usage events
[0m10:37:55.521674 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:45:10.749033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202900C88F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020290085760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020290084D70>]}


============================== 10:45:10.757036 | 66ee00cd-7102-4192-b10a-76ab9b6d12bd ==============================
[0m10:45:10.757036 [info ] [MainThread]: Running with dbt=1.10.1
[0m10:45:10.759079 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ThembaniFaleni\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\dbt_workspace\\Slip_Tests\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:45:12.393611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66ee00cd-7102-4192-b10a-76ab9b6d12bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202922E20F0>]}
[0m10:45:12.729476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66ee00cd-7102-4192-b10a-76ab9b6d12bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002029268B6E0>]}
[0m10:45:12.733285 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m10:45:13.598660 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m10:45:14.114160 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:45:14.115158 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:45:14.283914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '66ee00cd-7102-4192-b10a-76ab9b6d12bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202929B4470>]}
[0m10:45:14.677603 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m10:45:14.701235 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m10:45:14.750858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '66ee00cd-7102-4192-b10a-76ab9b6d12bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020292C7E810>]}
[0m10:45:14.752973 [info ] [MainThread]: Found 12 models, 1 snapshot, 12 data tests, 6 sources, 592 macros
[0m10:45:14.754972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66ee00cd-7102-4192-b10a-76ab9b6d12bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020292C6FE60>]}
[0m10:45:14.762677 [info ] [MainThread]: 
[0m10:45:14.763689 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:45:14.765873 [info ] [MainThread]: 
[0m10:45:14.769329 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:45:14.786244 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MOVIELENS'
[0m10:45:15.002349 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS"
[0m10:45:15.003352 [debug] [ThreadPool]: On list_MOVIELENS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS"} */
show terse schemas in database MOVIELENS
    limit 10000
[0m10:45:15.004350 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:45:17.110995 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.107 seconds
[0m10:45:17.130062 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MOVIELENS_snapshots'
[0m10:45:17.161947 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m10:45:17.162948 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
alter session set quoted_identifiers_ignore_case = false;
[0m10:45:17.163958 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:45:18.427526 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.263 seconds
[0m10:45:18.439233 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m10:45:18.441232 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
show objects in MOVIELENS.snapshots
    limit 10000
    
;
[0m10:45:18.834877 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.393 seconds
[0m10:45:18.841403 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m10:45:18.842878 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
alter session unset quoted_identifiers_ignore_case;
[0m10:45:19.404590 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.561 seconds
[0m10:45:19.409115 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MOVIELENS_snapshots, now list_MOVIELENS_DEV)
[0m10:45:19.416160 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m10:45:19.418478 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session set quoted_identifiers_ignore_case = false;
[0m10:45:19.843120 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.423 seconds
[0m10:45:19.847122 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m10:45:19.848119 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
show objects in MOVIELENS.DEV
    limit 10000
    
;
[0m10:45:20.297666 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.448 seconds
[0m10:45:20.301197 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m10:45:20.302216 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session unset quoted_identifiers_ignore_case;
[0m10:45:20.588510 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.285 seconds
[0m10:45:20.599044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66ee00cd-7102-4192-b10a-76ab9b6d12bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202900C8950>]}
[0m10:45:20.608232 [debug] [Thread-1 (]: Began running node snapshot.Slip_Tests.snap_tags
[0m10:45:20.610234 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.snap_tags ...................................... [RUN]
[0m10:45:20.612761 [debug] [Thread-1 (]: Acquiring new snowflake connection 'snapshot.Slip_Tests.snap_tags'
[0m10:45:20.613763 [debug] [Thread-1 (]: Began compiling node snapshot.Slip_Tests.snap_tags
[0m10:45:20.722041 [debug] [Thread-1 (]: Began executing node snapshot.Slip_Tests.snap_tags
[0m10:45:20.831143 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m10:45:20.832144 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
[0m10:45:20.833146 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:45:22.190957 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 1.357 seconds
[0m10:45:22.350995 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m10:45:22.351961 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
create or replace temporary table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS__dbt_tmp"
as (
    
    
    with snapshot_query as (

        



SELECT
    md5(cast(coalesce(cast(user_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(movie_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS id,
    user_id,
    movie_id,
    tag,
    TO_TIMESTAMP_LTZ(tag_timestamp) AS tag_timestamp
FROM MOVIELENS.DEV.src_tags
-- LIMIT 100


    ),

    snapshotted_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    

        from "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    
,
            tag_timestamp as dbt_updated_at,
            tag_timestamp as dbt_valid_from,
            
  
  coalesce(nullif(tag_timestamp, tag_timestamp), null)
  as dbt_valid_to
,
            md5(coalesce(cast(user_id as varchar ), '')
         || '|' || coalesce(cast(movie_id as varchar ), '')
         || '|' || coalesce(cast(tag as varchar ), '')
         || '|' || coalesce(cast(tag_timestamp as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    
,
            tag_timestamp as dbt_updated_at,
            tag_timestamp as dbt_valid_from,
            tag_timestamp as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

            where 
    
        snapshotted_data.dbt_unique_key_1 is null
    

            or (
    
        snapshotted_data.dbt_unique_key_1 is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.tag_timestamp)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.tag_timestamp)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

            where 
    
        source_data.dbt_unique_key_1 is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    )
;
[0m10:45:26.331113 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.977 seconds
[0m10:45:26.338589 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m10:45:26.339604 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS__dbt_tmp"
[0m10:45:26.678370 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.337 seconds
[0m10:45:26.688769 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m10:45:26.689806 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
[0m10:45:27.081659 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.390 seconds
[0m10:45:27.118078 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m10:45:27.120591 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS__dbt_tmp"
[0m10:45:27.397164 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.275 seconds
[0m10:45:27.408097 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m10:45:27.410099 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
[0m10:45:27.699620 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.288 seconds
[0m10:45:27.726029 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m10:45:27.728008 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS__dbt_tmp"
[0m10:45:28.015950 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.287 seconds
[0m10:45:28.082563 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m10:45:28.084575 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
/* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
select * from (
        
    
    with snapshot_query as (

        



SELECT
    md5(cast(coalesce(cast(user_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(movie_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS id,
    user_id,
    movie_id,
    tag,
    TO_TIMESTAMP_LTZ(tag_timestamp) AS tag_timestamp
FROM MOVIELENS.DEV.src_tags
-- LIMIT 100


    ),

    snapshotted_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    

        from "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    
,
            tag_timestamp as dbt_updated_at,
            tag_timestamp as dbt_valid_from,
            
  
  coalesce(nullif(tag_timestamp, tag_timestamp), null)
  as dbt_valid_to
,
            md5(coalesce(cast(user_id as varchar ), '')
         || '|' || coalesce(cast(movie_id as varchar ), '')
         || '|' || coalesce(cast(tag as varchar ), '')
         || '|' || coalesce(cast(tag_timestamp as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    
,
            tag_timestamp as dbt_updated_at,
            tag_timestamp as dbt_valid_from,
            tag_timestamp as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

            where 
    
        snapshotted_data.dbt_unique_key_1 is null
    

            or (
    
        snapshotted_data.dbt_unique_key_1 is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.tag_timestamp)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.tag_timestamp)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

            where 
    
        source_data.dbt_unique_key_1 is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m10:45:29.964115 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.878 seconds
[0m10:45:29.975731 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m10:45:29.977724 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
/* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m10:45:30.244013 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.265 seconds
[0m10:45:30.246015 [warn ] [Thread-1 (]: Data type of snapshot table timestamp columns (TIMESTAMP_NTZ) doesn't match derived column 'updated_at' (TIMESTAMP_LTZ). Please update snapshot config 'updated_at'.
[0m10:45:30.248017 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.Slip_Tests.snap_tags"
[0m10:45:30.251023 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m10:45:30.252024 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
BEGIN
[0m10:45:30.532304 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.279 seconds
[0m10:45:30.533300 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m10:45:30.534299 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
merge into "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS" as DBT_INTERNAL_DEST
    using "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("ID", "USER_ID", "MOVIE_ID", "TAG", "TAG_TIMESTAMP", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("ID", "USER_ID", "MOVIE_ID", "TAG", "TAG_TIMESTAMP", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m10:45:31.211404 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.674 seconds
[0m10:45:31.212569 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m10:45:31.213713 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
COMMIT
[0m10:45:31.811157 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.596 seconds
[0m10:45:31.889509 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66ee00cd-7102-4192-b10a-76ab9b6d12bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202931FA3C0>]}
[0m10:45:31.952380 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.snap_tags ...................................... [[32mSUCCESS 0[0m in 11.27s]
[0m10:45:31.957663 [debug] [Thread-1 (]: Finished running node snapshot.Slip_Tests.snap_tags
[0m10:45:31.963101 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:45:31.964101 [debug] [MainThread]: Connection 'list_MOVIELENS' was left open.
[0m10:45:31.965112 [debug] [MainThread]: On list_MOVIELENS: Close
[0m10:45:32.352679 [debug] [MainThread]: Connection 'list_MOVIELENS_DEV' was left open.
[0m10:45:32.353676 [debug] [MainThread]: On list_MOVIELENS_DEV: Close
[0m10:45:32.790016 [debug] [MainThread]: Connection 'snapshot.Slip_Tests.snap_tags' was left open.
[0m10:45:32.791526 [debug] [MainThread]: On snapshot.Slip_Tests.snap_tags: Close
[0m10:45:33.208036 [info ] [MainThread]: 
[0m10:45:33.211036 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 18.44 seconds (18.44s).
[0m10:45:33.216840 [debug] [MainThread]: Command end result
[0m10:45:33.350752 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m10:45:33.364318 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m10:45:33.402823 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\dbt_workspace\Slip_Tests\target\run_results.json
[0m10:45:33.403826 [info ] [MainThread]: 
[0m10:45:33.406821 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:45:33.408823 [info ] [MainThread]: 
[0m10:45:33.409826 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m10:45:33.412358 [debug] [MainThread]: Command `dbt snapshot` succeeded at 10:45:33.412358 after 23.19 seconds
[0m10:45:33.413370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202904EFC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002028F9AB950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002028FA89220>]}
[0m10:45:33.414358 [debug] [MainThread]: Flushing usage events
[0m10:45:34.423078 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:49:11.864133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297B8FF3FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297B8FF1880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297B8FF36E0>]}


============================== 10:49:11.872296 | 262c8958-cc7c-4dae-b02a-a05dcbe258f8 ==============================
[0m10:49:11.872296 [info ] [MainThread]: Running with dbt=1.10.1
[0m10:49:11.873267 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\dbt_workspace\\Slip_Tests\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\ThembaniFaleni\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:49:13.528459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '262c8958-cc7c-4dae-b02a-a05dcbe258f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297BAC99040>]}
[0m10:49:13.841031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '262c8958-cc7c-4dae-b02a-a05dcbe258f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297BB8BC260>]}
[0m10:49:13.843027 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m10:49:14.416284 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m10:49:14.924292 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:49:14.926279 [debug] [MainThread]: Partial parsing: updated file: Slip_Tests://snapshots\snap_tag.sql
[0m10:49:16.882902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '262c8958-cc7c-4dae-b02a-a05dcbe258f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297BC03B230>]}
[0m10:49:17.102875 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m10:49:17.127101 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m10:49:17.212861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '262c8958-cc7c-4dae-b02a-a05dcbe258f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297BC1302C0>]}
[0m10:49:17.213807 [info ] [MainThread]: Found 12 models, 12 data tests, 1 snapshot, 6 sources, 592 macros
[0m10:49:17.215800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '262c8958-cc7c-4dae-b02a-a05dcbe258f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297BC0E1A30>]}
[0m10:49:17.223596 [info ] [MainThread]: 
[0m10:49:17.224565 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:49:17.225579 [info ] [MainThread]: 
[0m10:49:17.228125 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:49:17.230172 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MOVIELENS'
[0m10:49:17.408400 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS"
[0m10:49:17.409538 [debug] [ThreadPool]: On list_MOVIELENS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS"} */
show terse schemas in database MOVIELENS
    limit 10000
[0m10:49:17.410472 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:49:18.909087 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.498 seconds
[0m10:49:18.927182 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MOVIELENS_DEV'
[0m10:49:18.957220 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m10:49:18.959344 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session set quoted_identifiers_ignore_case = false;
[0m10:49:18.959344 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:49:20.283463 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.323 seconds
[0m10:49:20.291911 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m10:49:20.292913 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
show objects in MOVIELENS.DEV
    limit 10000
    
;
[0m10:49:20.628947 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.334 seconds
[0m10:49:20.632968 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m10:49:20.634949 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session unset quoted_identifiers_ignore_case;
[0m10:49:20.917576 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.279 seconds
[0m10:49:20.923602 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MOVIELENS_DEV, now list_MOVIELENS_snapshots)
[0m10:49:20.931146 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m10:49:20.935147 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
alter session set quoted_identifiers_ignore_case = false;
[0m10:49:21.233086 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.297 seconds
[0m10:49:21.238612 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m10:49:21.239625 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
show objects in MOVIELENS.snapshots
    limit 10000
    
;
[0m10:49:21.616628 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.376 seconds
[0m10:49:21.622159 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m10:49:21.623170 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
alter session unset quoted_identifiers_ignore_case;
[0m10:49:21.847719 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.223 seconds
[0m10:49:21.857293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '262c8958-cc7c-4dae-b02a-a05dcbe258f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297BBDCFAD0>]}
[0m10:49:21.869385 [debug] [Thread-1 (]: Began running node snapshot.Slip_Tests.snap_tags
[0m10:49:21.871387 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.snap_tags ...................................... [RUN]
[0m10:49:21.872378 [debug] [Thread-1 (]: Acquiring new snowflake connection 'snapshot.Slip_Tests.snap_tags'
[0m10:49:21.874378 [debug] [Thread-1 (]: Began compiling node snapshot.Slip_Tests.snap_tags
[0m10:49:21.892334 [debug] [Thread-1 (]: Began executing node snapshot.Slip_Tests.snap_tags
[0m10:49:22.039993 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m10:49:22.040993 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
[0m10:49:22.041989 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:49:23.190202 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 1.148 seconds
[0m10:49:23.348894 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m10:49:23.349896 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
create or replace temporary table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS__dbt_tmp"
as (
    
    
    with snapshot_query as (

        



SELECT
    md5(cast(coalesce(cast(user_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(movie_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS id,
    user_id,
    movie_id,
    tag,
    TO_TIMESTAMP_NTZ(tag_timestamp) AS tag_timestamp
FROM MOVIELENS.DEV.src_tags
-- LIMIT 100


    ),

    snapshotted_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    

        from "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    
,
            tag_timestamp as dbt_updated_at,
            tag_timestamp as dbt_valid_from,
            
  
  coalesce(nullif(tag_timestamp, tag_timestamp), null)
  as dbt_valid_to
,
            md5(coalesce(cast(user_id as varchar ), '')
         || '|' || coalesce(cast(movie_id as varchar ), '')
         || '|' || coalesce(cast(tag as varchar ), '')
         || '|' || coalesce(cast(tag_timestamp as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    
,
            tag_timestamp as dbt_updated_at,
            tag_timestamp as dbt_valid_from,
            tag_timestamp as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

            where 
    
        snapshotted_data.dbt_unique_key_1 is null
    

            or (
    
        snapshotted_data.dbt_unique_key_1 is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.tag_timestamp)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.tag_timestamp)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

            where 
    
        source_data.dbt_unique_key_1 is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    )
;
[0m10:49:25.503319 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.152 seconds
[0m10:49:25.509870 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m10:49:25.510866 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS__dbt_tmp"
[0m10:49:25.848614 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.336 seconds
[0m10:49:25.859154 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m10:49:25.860165 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
[0m10:49:26.175521 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.314 seconds
[0m10:49:26.184049 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m10:49:26.185130 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS__dbt_tmp"
[0m10:49:26.430299 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.244 seconds
[0m10:49:26.438856 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m10:49:26.439855 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
[0m10:49:26.668794 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.228 seconds
[0m10:49:26.688028 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m10:49:26.689872 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS__dbt_tmp"
[0m10:49:26.955042 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.264 seconds
[0m10:49:27.017960 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m10:49:27.018912 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
/* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
select * from (
        
    
    with snapshot_query as (

        



SELECT
    md5(cast(coalesce(cast(user_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(movie_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS id,
    user_id,
    movie_id,
    tag,
    TO_TIMESTAMP_NTZ(tag_timestamp) AS tag_timestamp
FROM MOVIELENS.DEV.src_tags
-- LIMIT 100


    ),

    snapshotted_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    

        from "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    
,
            tag_timestamp as dbt_updated_at,
            tag_timestamp as dbt_valid_from,
            
  
  coalesce(nullif(tag_timestamp, tag_timestamp), null)
  as dbt_valid_to
,
            md5(coalesce(cast(user_id as varchar ), '')
         || '|' || coalesce(cast(movie_id as varchar ), '')
         || '|' || coalesce(cast(tag as varchar ), '')
         || '|' || coalesce(cast(tag_timestamp as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    
,
            tag_timestamp as dbt_updated_at,
            tag_timestamp as dbt_valid_from,
            tag_timestamp as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

            where 
    
        snapshotted_data.dbt_unique_key_1 is null
    

            or (
    
        snapshotted_data.dbt_unique_key_1 is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.tag_timestamp)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.tag_timestamp)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

            where 
    
        source_data.dbt_unique_key_1 is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m10:49:27.402081 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.382 seconds
[0m10:49:27.409596 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m10:49:27.410599 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
/* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m10:49:27.642006 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.231 seconds
[0m10:49:27.644011 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.Slip_Tests.snap_tags"
[0m10:49:27.646546 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m10:49:27.646546 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
BEGIN
[0m10:49:27.939970 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.292 seconds
[0m10:49:27.941965 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m10:49:27.943983 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
merge into "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS" as DBT_INTERNAL_DEST
    using "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("ID", "USER_ID", "MOVIE_ID", "TAG", "TAG_TIMESTAMP", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("ID", "USER_ID", "MOVIE_ID", "TAG", "TAG_TIMESTAMP", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m10:49:29.046281 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.101 seconds
[0m10:49:29.048824 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m10:49:29.050058 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
COMMIT
[0m10:49:29.642552 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.591 seconds
[0m10:49:29.698679 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '262c8958-cc7c-4dae-b02a-a05dcbe258f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297B69D94C0>]}
[0m10:49:29.747810 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.snap_tags ...................................... [[32mSUCCESS 0[0m in 7.82s]
[0m10:49:29.749827 [debug] [Thread-1 (]: Finished running node snapshot.Slip_Tests.snap_tags
[0m10:49:29.753837 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:49:29.754838 [debug] [MainThread]: Connection 'list_MOVIELENS' was left open.
[0m10:49:29.755841 [debug] [MainThread]: On list_MOVIELENS: Close
[0m10:49:30.139121 [debug] [MainThread]: Connection 'list_MOVIELENS_snapshots' was left open.
[0m10:49:30.140235 [debug] [MainThread]: On list_MOVIELENS_snapshots: Close
[0m10:49:30.529883 [debug] [MainThread]: Connection 'snapshot.Slip_Tests.snap_tags' was left open.
[0m10:49:30.531786 [debug] [MainThread]: On snapshot.Slip_Tests.snap_tags: Close
[0m10:49:30.919696 [info ] [MainThread]: 
[0m10:49:30.920739 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 13.69 seconds (13.69s).
[0m10:49:30.922756 [debug] [MainThread]: Command end result
[0m10:49:30.981557 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m10:49:30.987903 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m10:49:31.008540 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\dbt_workspace\Slip_Tests\target\run_results.json
[0m10:49:31.009551 [info ] [MainThread]: 
[0m10:49:31.010551 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:49:31.011556 [info ] [MainThread]: 
[0m10:49:31.013067 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m10:49:31.015081 [debug] [MainThread]: Command `dbt snapshot` succeeded at 10:49:31.014080 after 19.59 seconds
[0m10:49:31.015081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297B9830410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297B98304A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297B9830680>]}
[0m10:49:31.016081 [debug] [MainThread]: Flushing usage events
[0m10:49:32.071371 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:10:24.748020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002696C4A8CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002696FC2F5C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002696D60F830>]}


============================== 11:10:24.748020 | d8ce3c0e-0a64-47cf-b9f4-725a54655b23 ==============================
[0m11:10:24.748020 [info ] [MainThread]: Running with dbt=1.10.1
[0m11:10:24.763034 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ThembaniFaleni\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\dbt_workspace\\Slip_Tests\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:10:26.123101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd8ce3c0e-0a64-47cf-b9f4-725a54655b23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269725F3770>]}
[0m11:10:26.369221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd8ce3c0e-0a64-47cf-b9f4-725a54655b23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026971DD8CB0>]}
[0m11:10:26.369221 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m11:10:26.852426 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m11:10:27.277114 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:10:27.277114 [debug] [MainThread]: Partial parsing: updated file: Slip_Tests://snapshots\snap_tag.sql
[0m11:10:28.962606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd8ce3c0e-0a64-47cf-b9f4-725a54655b23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026972CFBE30>]}
[0m11:10:29.180161 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m11:10:29.212020 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m11:10:29.259034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd8ce3c0e-0a64-47cf-b9f4-725a54655b23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002697297D880>]}
[0m11:10:29.259034 [info ] [MainThread]: Found 12 models, 12 data tests, 1 snapshot, 6 sources, 592 macros
[0m11:10:29.259034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8ce3c0e-0a64-47cf-b9f4-725a54655b23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026972BE1B80>]}
[0m11:10:29.275188 [info ] [MainThread]: 
[0m11:10:29.275188 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:10:29.283402 [info ] [MainThread]: 
[0m11:10:29.283402 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:10:29.294009 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MOVIELENS'
[0m11:10:29.453324 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS"
[0m11:10:29.455457 [debug] [ThreadPool]: On list_MOVIELENS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS"} */
show terse schemas in database MOVIELENS
    limit 10000
[0m11:10:29.455457 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:10:31.641295 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.190 seconds
[0m11:10:31.656931 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MOVIELENS_snapshots'
[0m11:10:31.688355 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m11:10:31.688355 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
alter session set quoted_identifiers_ignore_case = false;
[0m11:10:31.688355 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:10:33.160931 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.461 seconds
[0m11:10:33.160931 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m11:10:33.160931 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
show objects in MOVIELENS.snapshots
    limit 10000
    
;
[0m11:10:33.584315 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.412 seconds
[0m11:10:33.584315 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m11:10:33.584315 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
alter session unset quoted_identifiers_ignore_case;
[0m11:10:33.912318 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.320 seconds
[0m11:10:33.912318 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MOVIELENS_snapshots, now list_MOVIELENS_DEV)
[0m11:10:33.912318 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m11:10:33.912318 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session set quoted_identifiers_ignore_case = false;
[0m11:10:34.240699 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.318 seconds
[0m11:10:34.242357 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m11:10:34.242357 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
show objects in MOVIELENS.DEV
    limit 10000
    
;
[0m11:10:34.571165 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.325 seconds
[0m11:10:34.571165 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m11:10:34.571165 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session unset quoted_identifiers_ignore_case;
[0m11:10:34.849607 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.276 seconds
[0m11:10:34.849607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8ce3c0e-0a64-47cf-b9f4-725a54655b23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026972C3C920>]}
[0m11:10:34.849607 [debug] [Thread-1 (]: Began running node model.Slip_Tests.src_genome_score
[0m11:10:34.865701 [info ] [Thread-1 (]: 1 of 11 START sql view model DEV.src_genome_score .............................. [RUN]
[0m11:10:34.867301 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Slip_Tests.src_genome_score'
[0m11:10:34.867301 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.src_genome_score
[0m11:10:34.867301 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.src_genome_score"
[0m11:10:34.867301 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.src_genome_score
[0m11:10:34.947398 [debug] [Thread-1 (]: Writing runtime sql for node "model.Slip_Tests.src_genome_score"
[0m11:10:34.955471 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.src_genome_score"
[0m11:10:34.955471 [debug] [Thread-1 (]: On model.Slip_Tests.src_genome_score: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.src_genome_score"} */
create or replace   view MOVIELENS.DEV.src_genome_score
  
   as (
    -- For genome_scores
WITH raw_genome_scores AS (
    SELECT * FROM MOVIELENS.RAW.RAW_GENOME_SCORES
)

SELECT
    movieId AS movie_id,
    tagId AS tag_id,
    relevance
FROM raw_genome_scores
  );
[0m11:10:34.955471 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:10:36.750190 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.801 seconds
[0m11:10:36.813162 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8ce3c0e-0a64-47cf-b9f4-725a54655b23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002696D529490>]}
[0m11:10:36.813162 [info ] [Thread-1 (]: 1 of 11 OK created sql view model DEV.src_genome_score ......................... [[32mSUCCESS 1[0m in 1.93s]
[0m11:10:36.813162 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.src_genome_score
[0m11:10:36.813162 [debug] [Thread-1 (]: Began running node model.Slip_Tests.src_genome_tags
[0m11:10:36.824556 [info ] [Thread-1 (]: 2 of 11 START sql view model DEV.src_genome_tags ............................... [RUN]
[0m11:10:36.827006 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Slip_Tests.src_genome_score, now model.Slip_Tests.src_genome_tags)
[0m11:10:36.828310 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.src_genome_tags
[0m11:10:36.832643 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.src_genome_tags"
[0m11:10:36.836687 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.src_genome_tags
[0m11:10:36.850740 [debug] [Thread-1 (]: Writing runtime sql for node "model.Slip_Tests.src_genome_tags"
[0m11:10:36.854780 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.src_genome_tags"
[0m11:10:36.854780 [debug] [Thread-1 (]: On model.Slip_Tests.src_genome_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.src_genome_tags"} */
create or replace   view MOVIELENS.DEV.src_genome_tags
  
   as (
    WITH raw_genome_tags AS (
    SELECT * FROM MOVIELENS.RAW.RAW_GENOME_TAGS
)

SELECT
    tagId AS tag_id,
    tag
FROM raw_genome_tags
  );
[0m11:10:37.477117 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.618 seconds
[0m11:10:37.477117 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8ce3c0e-0a64-47cf-b9f4-725a54655b23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026973383110>]}
[0m11:10:37.477117 [info ] [Thread-1 (]: 2 of 11 OK created sql view model DEV.src_genome_tags .......................... [[32mSUCCESS 1[0m in 0.65s]
[0m11:10:37.485070 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.src_genome_tags
[0m11:10:37.485070 [debug] [Thread-1 (]: Began running node model.Slip_Tests.src_links
[0m11:10:37.485070 [info ] [Thread-1 (]: 3 of 11 START sql view model DEV.src_links ..................................... [RUN]
[0m11:10:37.488014 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Slip_Tests.src_genome_tags, now model.Slip_Tests.src_links)
[0m11:10:37.490047 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.src_links
[0m11:10:37.490047 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.src_links"
[0m11:10:37.555756 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.src_links
[0m11:10:37.564103 [debug] [Thread-1 (]: Writing runtime sql for node "model.Slip_Tests.src_links"
[0m11:10:37.564103 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.src_links"
[0m11:10:37.564103 [debug] [Thread-1 (]: On model.Slip_Tests.src_links: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.src_links"} */
create or replace   view MOVIELENS.DEV.src_links
  
   as (
    -- For links
WITH raw_links AS (
    SELECT * FROM MOVIELENS.RAW.RAW_LINKS
)

SELECT
    movieId AS movie_id,
    imdbId AS imdb_id,
    tmdbId AS tmdb_id
FROM raw_links
  );
[0m11:10:38.491763 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.932 seconds
[0m11:10:38.491763 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8ce3c0e-0a64-47cf-b9f4-725a54655b23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269733CEF00>]}
[0m11:10:38.507406 [info ] [Thread-1 (]: 3 of 11 OK created sql view model DEV.src_links ................................ [[32mSUCCESS 1[0m in 1.00s]
[0m11:10:38.508398 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.src_links
[0m11:10:38.508398 [debug] [Thread-1 (]: Began running node model.Slip_Tests.src_movies
[0m11:10:38.508398 [info ] [Thread-1 (]: 4 of 11 START sql view model DEV.src_movies .................................... [RUN]
[0m11:10:38.508398 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Slip_Tests.src_links, now model.Slip_Tests.src_movies)
[0m11:10:38.508398 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.src_movies
[0m11:10:38.508398 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.src_movies"
[0m11:10:38.508398 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.src_movies
[0m11:10:38.508398 [debug] [Thread-1 (]: Writing runtime sql for node "model.Slip_Tests.src_movies"
[0m11:10:38.525341 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.src_movies"
[0m11:10:38.526947 [debug] [Thread-1 (]: On model.Slip_Tests.src_movies: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.src_movies"} */
create or replace   view MOVIELENS.DEV.src_movies
  
   as (
    WITH raw_movies AS (
   SELECT * FROM MOVIELENS.RAW.RAW_MOVIES
)
SELECT
    movieId As movie_id,
    title,
    genres
FROM raw_movies
  );
[0m11:10:39.319840 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.793 seconds
[0m11:10:39.319840 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8ce3c0e-0a64-47cf-b9f4-725a54655b23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269733CCFB0>]}
[0m11:10:39.319840 [info ] [Thread-1 (]: 4 of 11 OK created sql view model DEV.src_movies ............................... [[32mSUCCESS 1[0m in 0.81s]
[0m11:10:39.319840 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.src_movies
[0m11:10:39.319840 [debug] [Thread-1 (]: Began running node model.Slip_Tests.src_ratings
[0m11:10:39.319840 [info ] [Thread-1 (]: 5 of 11 START sql table model DEV.src_ratings .................................. [RUN]
[0m11:10:39.319840 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Slip_Tests.src_movies, now model.Slip_Tests.src_ratings)
[0m11:10:39.319840 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.src_ratings
[0m11:10:39.337949 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.src_ratings"
[0m11:10:39.341452 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.src_ratings
[0m11:10:39.411685 [debug] [Thread-1 (]: Writing runtime sql for node "model.Slip_Tests.src_ratings"
[0m11:10:39.411685 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.src_ratings"
[0m11:10:39.411685 [debug] [Thread-1 (]: On model.Slip_Tests.src_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.src_ratings"} */
create or replace transient table MOVIELENS.DEV.src_ratings
    

    
    as (

WITH raw_ratings AS (

    SELECT * FROM MOVIELENS.RAW.RAW_RATINGS
)

SELECT
    userId AS user_id,
    movieId AS movie_id,
    rating,
    TO_TIMESTAMP_LTZ(timestamp) AS rating_timestamp
FROM raw_ratings
    )
;
[0m11:10:45.230827 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 5.827 seconds
[0m11:10:45.245846 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8ce3c0e-0a64-47cf-b9f4-725a54655b23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269733F42F0>]}
[0m11:10:45.245846 [info ] [Thread-1 (]: 5 of 11 OK created sql table model DEV.src_ratings ............................. [[32mSUCCESS 1[0m in 5.93s]
[0m11:10:45.245846 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.src_ratings
[0m11:10:45.245846 [debug] [Thread-1 (]: Began running node model.Slip_Tests.src_tags
[0m11:10:45.245846 [info ] [Thread-1 (]: 6 of 11 START sql table model DEV.src_tags ..................................... [RUN]
[0m11:10:45.245846 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Slip_Tests.src_ratings, now model.Slip_Tests.src_tags)
[0m11:10:45.245846 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.src_tags
[0m11:10:45.261948 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.src_tags"
[0m11:10:45.264639 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.src_tags
[0m11:10:45.270222 [debug] [Thread-1 (]: Writing runtime sql for node "model.Slip_Tests.src_tags"
[0m11:10:45.276478 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.src_tags"
[0m11:10:45.276478 [debug] [Thread-1 (]: On model.Slip_Tests.src_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.src_tags"} */
create or replace transient table MOVIELENS.DEV.src_tags
    

    
    as (

WITH raw_tags AS (
    SELECT * FROM MOVIELENS.RAW.RAW_TAGS
)
SELECT
    userId AS user_id,
    movieId AS movie_id,
    tag,
    TO_TIMESTAMP_LTZ(timestamp) AS tag_timestamp
FROM raw_tags
    )
;
[0m11:10:47.674450 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.397 seconds
[0m11:10:47.674450 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8ce3c0e-0a64-47cf-b9f4-725a54655b23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269732226F0>]}
[0m11:10:47.674450 [info ] [Thread-1 (]: 6 of 11 OK created sql table model DEV.src_tags ................................ [[32mSUCCESS 1[0m in 2.43s]
[0m11:10:47.690080 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.src_tags
[0m11:10:47.690080 [debug] [Thread-1 (]: Began running node model.Slip_Tests.fct_genome_score
[0m11:10:47.693158 [info ] [Thread-1 (]: 7 of 11 START sql table model DEV.fct_genome_score ............................. [RUN]
[0m11:10:47.693158 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Slip_Tests.src_tags, now model.Slip_Tests.fct_genome_score)
[0m11:10:47.693158 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.fct_genome_score
[0m11:10:47.704680 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.fct_genome_score"
[0m11:10:47.706897 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.fct_genome_score
[0m11:10:47.710716 [debug] [Thread-1 (]: Writing runtime sql for node "model.Slip_Tests.fct_genome_score"
[0m11:10:47.714644 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_genome_score"
[0m11:10:47.714644 [debug] [Thread-1 (]: On model.Slip_Tests.fct_genome_score: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_genome_score"} */
create or replace transient table MOVIELENS.DEV.fct_genome_score
    

    
    as (WITH src_scores AS (
    SELECT * FROM MOVIELENS.DEV.src_genome_score
)

SELECT
    movie_id,
    tag_id,
    ROUND(relevance, 4) AS relevance_score
FROM src_scores
WHERE relevance > 0
    )
;
[0m11:10:51.201081 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.485 seconds
[0m11:10:51.201081 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8ce3c0e-0a64-47cf-b9f4-725a54655b23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269733FC1A0>]}
[0m11:10:51.201081 [info ] [Thread-1 (]: 7 of 11 OK created sql table model DEV.fct_genome_score ........................ [[32mSUCCESS 1[0m in 3.51s]
[0m11:10:51.201081 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.fct_genome_score
[0m11:10:51.201081 [debug] [Thread-1 (]: Began running node model.Slip_Tests.dim_genome_tags
[0m11:10:51.201081 [info ] [Thread-1 (]: 8 of 11 START sql table model DEV.dim_genome_tags .............................. [RUN]
[0m11:10:51.201081 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Slip_Tests.fct_genome_score, now model.Slip_Tests.dim_genome_tags)
[0m11:10:51.201081 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.dim_genome_tags
[0m11:10:51.217117 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.dim_genome_tags"
[0m11:10:51.219320 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.dim_genome_tags
[0m11:10:51.226073 [debug] [Thread-1 (]: Writing runtime sql for node "model.Slip_Tests.dim_genome_tags"
[0m11:10:51.226483 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.dim_genome_tags"
[0m11:10:51.226483 [debug] [Thread-1 (]: On model.Slip_Tests.dim_genome_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.dim_genome_tags"} */
create or replace transient table MOVIELENS.DEV.dim_genome_tags
    

    
    as (WITH src_tags AS (
    SELECT * FROM MOVIELENS.DEV.src_genome_tags
)

SELECT
    tag_id,
    INITCAP(TRIM(tag)) AS tag_name
FROM src_tags
    )
;
[0m11:10:52.517856 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.299 seconds
[0m11:10:52.536171 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8ce3c0e-0a64-47cf-b9f4-725a54655b23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002697341DAF0>]}
[0m11:10:52.538465 [info ] [Thread-1 (]: 8 of 11 OK created sql table model DEV.dim_genome_tags ......................... [[32mSUCCESS 1[0m in 1.34s]
[0m11:10:52.539475 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.dim_genome_tags
[0m11:10:52.539475 [debug] [Thread-1 (]: Began running node model.Slip_Tests.dim_movies
[0m11:10:52.539475 [info ] [Thread-1 (]: 9 of 11 START sql table model DEV.dim_movies ................................... [RUN]
[0m11:10:52.539475 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Slip_Tests.dim_genome_tags, now model.Slip_Tests.dim_movies)
[0m11:10:52.539475 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.dim_movies
[0m11:10:52.552024 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.dim_movies"
[0m11:10:52.553390 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.dim_movies
[0m11:10:52.558347 [debug] [Thread-1 (]: Writing runtime sql for node "model.Slip_Tests.dim_movies"
[0m11:10:52.558347 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.dim_movies"
[0m11:10:52.558347 [debug] [Thread-1 (]: On model.Slip_Tests.dim_movies: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.dim_movies"} */
create or replace transient table MOVIELENS.DEV.dim_movies
    

    
    as (WITH src_movies AS (
    SELECT * FROM MOVIELENS.DEV.src_movies
)

SELECT
    movie_id,
    INITCAP(TRIM(title)) AS movie_title,
    SPLIT(genres, '|') AS genre_array,
FROM src_movies
    )
;
[0m11:10:54.510572 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.942 seconds
[0m11:10:54.516284 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8ce3c0e-0a64-47cf-b9f4-725a54655b23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269733F9AF0>]}
[0m11:10:54.516284 [info ] [Thread-1 (]: 9 of 11 OK created sql table model DEV.dim_movies .............................. [[32mSUCCESS 1[0m in 1.98s]
[0m11:10:54.520430 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.dim_movies
[0m11:10:54.520430 [debug] [Thread-1 (]: Began running node model.Slip_Tests.fct_ratings
[0m11:10:54.523040 [info ] [Thread-1 (]: 10 of 11 START sql incremental model DEV.fct_ratings ........................... [RUN]
[0m11:10:54.523040 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Slip_Tests.dim_movies, now model.Slip_Tests.fct_ratings)
[0m11:10:54.526607 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.fct_ratings
[0m11:10:54.546053 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.fct_ratings"
[0m11:10:54.546053 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.fct_ratings
[0m11:10:54.641344 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m11:10:54.641344 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
create or replace  temporary view MOVIELENS.DEV.fct_ratings__dbt_tmp
  
   as (
    

WITH src_ratings AS (
    SELECT * FROM MOVIELENS.DEV.src_ratings
)

SELECT
    user_id,
    movie_id,
    rating,
    rating_timestamp
FROM src_ratings
WHERE rating IS NOT NULL

    AND rating_timestamp > (
        SELECT MAX(rating_timestamp) FROM MOVIELENS.DEV.fct_ratings
    )

  );
[0m11:10:55.309634 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.662 seconds
[0m11:10:55.324161 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m11:10:55.324161 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
describe table MOVIELENS.DEV.fct_ratings__dbt_tmp
[0m11:10:55.612187 [debug] [Thread-1 (]: SQL status: SUCCESS 4 in 0.278 seconds
[0m11:10:55.612187 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m11:10:55.612187 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
describe table MOVIELENS.DEV.fct_ratings
[0m11:10:55.878264 [debug] [Thread-1 (]: SQL status: SUCCESS 4 in 0.265 seconds
[0m11:10:55.893865 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m11:10:55.893865 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
describe table MOVIELENS.DEV.fct_ratings__dbt_tmp
[0m11:10:56.149051 [debug] [Thread-1 (]: SQL status: SUCCESS 4 in 0.239 seconds
[0m11:10:56.149051 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m11:10:56.149051 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
describe table "MOVIELENS"."DEV"."FCT_RATINGS"
[0m11:10:56.400607 [debug] [Thread-1 (]: SQL status: SUCCESS 4 in 0.245 seconds
[0m11:10:56.416218 [debug] [Thread-1 (]: 
    In "MOVIELENS"."DEV"."FCT_RATINGS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m11:10:56.448191 [debug] [Thread-1 (]: Writing runtime sql for node "model.Slip_Tests.fct_ratings"
[0m11:10:56.465941 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m11:10:56.466985 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
-- back compat for old kwarg name
  
  begin;
[0m11:10:56.926467 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.467 seconds
[0m11:10:56.935984 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m11:10:56.935984 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
insert into MOVIELENS.DEV.fct_ratings ("USER_ID", "MOVIE_ID", "RATING", "RATING_TIMESTAMP")
        (
            select "USER_ID", "MOVIE_ID", "RATING", "RATING_TIMESTAMP"
            from MOVIELENS.DEV.fct_ratings__dbt_tmp
        );
[0m11:10:57.710424 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.774 seconds
[0m11:10:57.710424 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m11:10:57.710424 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
COMMIT
[0m11:10:57.987202 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.274 seconds
[0m11:10:58.002800 [debug] [Thread-1 (]: Applying DROP to: MOVIELENS.DEV.fct_ratings__dbt_tmp
[0m11:10:58.031497 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m11:10:58.034508 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
drop view if exists MOVIELENS.DEV.fct_ratings__dbt_tmp cascade
[0m11:10:58.363996 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.332 seconds
[0m11:10:58.363996 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8ce3c0e-0a64-47cf-b9f4-725a54655b23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269732C9C70>]}
[0m11:10:58.363996 [info ] [Thread-1 (]: 10 of 11 OK created sql incremental model DEV.fct_ratings ...................... [[32mSUCCESS 0[0m in 3.84s]
[0m11:10:58.363996 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.fct_ratings
[0m11:10:58.363996 [debug] [Thread-1 (]: Began running node model.Slip_Tests.dim_user
[0m11:10:58.363996 [info ] [Thread-1 (]: 11 of 11 START sql table model DEV.dim_user .................................... [RUN]
[0m11:10:58.363996 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Slip_Tests.fct_ratings, now model.Slip_Tests.dim_user)
[0m11:10:58.363996 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.dim_user
[0m11:10:58.384365 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.dim_user"
[0m11:10:58.385597 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.dim_user
[0m11:10:58.395002 [debug] [Thread-1 (]: Writing runtime sql for node "model.Slip_Tests.dim_user"
[0m11:10:58.399179 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.dim_user"
[0m11:10:58.402447 [debug] [Thread-1 (]: On model.Slip_Tests.dim_user: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.dim_user"} */
create or replace transient table MOVIELENS.DEV.dim_user
    

    
    as (WITH ratings AS (
    SELECT DISTINCT user_id FROM MOVIELENS.DEV.src_ratings
),

tags AS (
    SELECT DISTINCT user_id FROM MOVIELENS.DEV.src_tags
)

SELECT DISTINCT user_id
FROM (
    SELECT * FROM ratings
    UNION
    SELECT * FROM tags
)
    )
;
[0m11:11:00.307157 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.911 seconds
[0m11:11:00.307157 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8ce3c0e-0a64-47cf-b9f4-725a54655b23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002697329A870>]}
[0m11:11:00.307157 [info ] [Thread-1 (]: 11 of 11 OK created sql table model DEV.dim_user ............................... [[32mSUCCESS 1[0m in 1.94s]
[0m11:11:00.322778 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.dim_user
[0m11:11:00.322778 [debug] [Thread-1 (]: Began running node model.Slip_Tests.dim_movies_with_tags
[0m11:11:00.322778 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Slip_Tests.dim_user, now model.Slip_Tests.dim_movies_with_tags)
[0m11:11:00.322778 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.dim_movies_with_tags
[0m11:11:00.335297 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.dim_movies_with_tags"
[0m11:11:00.391389 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.dim_movies_with_tags
[0m11:11:00.402957 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:11:00.402957 [debug] [MainThread]: Connection 'list_MOVIELENS' was left open.
[0m11:11:00.402957 [debug] [MainThread]: On list_MOVIELENS: Close
[0m11:11:00.892046 [debug] [MainThread]: Connection 'list_MOVIELENS_DEV' was left open.
[0m11:11:00.892046 [debug] [MainThread]: On list_MOVIELENS_DEV: Close
[0m11:11:01.369322 [debug] [MainThread]: Connection 'model.Slip_Tests.dim_movies_with_tags' was left open.
[0m11:11:01.370415 [debug] [MainThread]: On model.Slip_Tests.dim_movies_with_tags: Close
[0m11:11:01.845919 [info ] [MainThread]: 
[0m11:11:01.845919 [info ] [MainThread]: Finished running 1 incremental model, 6 table models, 4 view models in 0 hours 0 minutes and 32.56 seconds (32.56s).
[0m11:11:01.845919 [debug] [MainThread]: Command end result
[0m11:11:01.908520 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m11:11:01.917856 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m11:11:01.936652 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\dbt_workspace\Slip_Tests\target\run_results.json
[0m11:11:01.936652 [info ] [MainThread]: 
[0m11:11:01.941786 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:11:01.943888 [info ] [MainThread]: 
[0m11:11:01.945317 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=11
[0m11:11:01.947595 [debug] [MainThread]: Command `dbt run` succeeded at 11:11:01.947595 after 37.55 seconds
[0m11:11:01.947595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002696D329B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269726C4E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002696C4A8CB0>]}
[0m11:11:01.950439 [debug] [MainThread]: Flushing usage events
[0m11:11:03.458633 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:13:07.942494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E40A665670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E40D18D4C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E40D18EA80>]}


============================== 11:13:07.949605 | a7eeccba-e5fb-4951-ab2b-604d3c66bf30 ==============================
[0m11:13:07.949605 [info ] [MainThread]: Running with dbt=1.10.1
[0m11:13:07.949605 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ThembaniFaleni\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\dbt_workspace\\Slip_Tests\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --model src_tags', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:13:07.949605 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of
`--resource-type model --select`
[0m11:13:07.961808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a7eeccba-e5fb-4951-ab2b-604d3c66bf30', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E40D21BFE0>]}
[0m11:13:09.301910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7eeccba-e5fb-4951-ab2b-604d3c66bf30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E40F7CACC0>]}
[0m11:13:09.572645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a7eeccba-e5fb-4951-ab2b-604d3c66bf30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E40F175CA0>]}
[0m11:13:09.572645 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m11:13:10.088855 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m11:13:10.525941 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:13:10.531557 [debug] [MainThread]: Partial parsing: updated file: Slip_Tests://models\staging\src_tags.sql
[0m11:13:11.668951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a7eeccba-e5fb-4951-ab2b-604d3c66bf30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E40F8BE3F0>]}
[0m11:13:11.880307 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m11:13:11.916770 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m11:13:11.963838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a7eeccba-e5fb-4951-ab2b-604d3c66bf30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E40F853080>]}
[0m11:13:11.963838 [info ] [MainThread]: Found 12 models, 12 data tests, 1 snapshot, 6 sources, 592 macros
[0m11:13:11.963838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7eeccba-e5fb-4951-ab2b-604d3c66bf30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E40FB04C20>]}
[0m11:13:11.971870 [info ] [MainThread]: 
[0m11:13:11.971870 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:13:11.980374 [info ] [MainThread]: 
[0m11:13:11.983138 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:13:11.986020 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MOVIELENS'
[0m11:13:12.148218 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS"
[0m11:13:12.148218 [debug] [ThreadPool]: On list_MOVIELENS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS"} */
show terse schemas in database MOVIELENS
    limit 10000
[0m11:13:12.148218 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:13:13.823922 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.670 seconds
[0m11:13:13.838892 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MOVIELENS_DEV'
[0m11:13:13.862375 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m11:13:13.862375 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session set quoted_identifiers_ignore_case = false;
[0m11:13:13.862375 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:13:15.250601 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.385 seconds
[0m11:13:15.258625 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m11:13:15.258625 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
show objects in MOVIELENS.DEV
    limit 10000
    
;
[0m11:13:15.566020 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.313 seconds
[0m11:13:15.566020 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m11:13:15.578536 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session unset quoted_identifiers_ignore_case;
[0m11:13:15.831419 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.256 seconds
[0m11:13:15.831419 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MOVIELENS_DEV, now list_MOVIELENS_snapshots)
[0m11:13:15.848317 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m11:13:15.848317 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
alter session set quoted_identifiers_ignore_case = false;
[0m11:13:16.115858 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.264 seconds
[0m11:13:16.115858 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m11:13:16.115858 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
show objects in MOVIELENS.snapshots
    limit 10000
    
;
[0m11:13:16.458375 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.338 seconds
[0m11:13:16.458375 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m11:13:16.465978 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
alter session unset quoted_identifiers_ignore_case;
[0m11:13:16.725483 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.266 seconds
[0m11:13:16.725483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7eeccba-e5fb-4951-ab2b-604d3c66bf30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E40A817B90>]}
[0m11:13:16.740982 [debug] [Thread-1 (]: Began running node model.Slip_Tests.src_tags
[0m11:13:16.740982 [info ] [Thread-1 (]: 1 of 1 START sql table model DEV.src_tags ...................................... [RUN]
[0m11:13:16.740982 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Slip_Tests.src_tags'
[0m11:13:16.740982 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.src_tags
[0m11:13:16.761502 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.src_tags"
[0m11:13:16.765800 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.src_tags
[0m11:13:16.849751 [debug] [Thread-1 (]: Writing runtime sql for node "model.Slip_Tests.src_tags"
[0m11:13:16.854010 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.src_tags"
[0m11:13:16.854010 [debug] [Thread-1 (]: On model.Slip_Tests.src_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.src_tags"} */
create or replace transient table MOVIELENS.DEV.src_tags
    

    
    as (

WITH raw_tags AS (
    SELECT * FROM MOVIELENS.RAW.RAW_TAGS
)
SELECT
    userId AS user_id,
    movieId AS movie_id,
    tag,
    TO_TIMESTAMP_NTZ(timestamp) AS tag_timestamp
FROM raw_tags
    )
;
[0m11:13:16.854010 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:13:19.625293 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.780 seconds
[0m11:13:19.687201 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7eeccba-e5fb-4951-ab2b-604d3c66bf30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E40A7697C0>]}
[0m11:13:19.687201 [info ] [Thread-1 (]: 1 of 1 OK created sql table model DEV.src_tags ................................. [[32mSUCCESS 1[0m in 2.95s]
[0m11:13:19.687201 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.src_tags
[0m11:13:19.687201 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:13:19.687201 [debug] [MainThread]: Connection 'list_MOVIELENS' was left open.
[0m11:13:19.687201 [debug] [MainThread]: On list_MOVIELENS: Close
[0m11:13:20.107772 [debug] [MainThread]: Connection 'list_MOVIELENS_snapshots' was left open.
[0m11:13:20.107772 [debug] [MainThread]: On list_MOVIELENS_snapshots: Close
[0m11:13:20.550039 [debug] [MainThread]: Connection 'model.Slip_Tests.src_tags' was left open.
[0m11:13:20.550039 [debug] [MainThread]: On model.Slip_Tests.src_tags: Close
[0m11:13:21.005308 [info ] [MainThread]: 
[0m11:13:21.005308 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.02 seconds (9.02s).
[0m11:13:21.005308 [debug] [MainThread]: Command end result
[0m11:13:21.064812 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m11:13:21.064812 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m11:13:21.094873 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\dbt_workspace\Slip_Tests\target\run_results.json
[0m11:13:21.095777 [info ] [MainThread]: 
[0m11:13:21.097706 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:13:21.097706 [info ] [MainThread]: 
[0m11:13:21.097706 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m11:13:21.097706 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m11:13:21.102315 [debug] [MainThread]: Command `dbt run` succeeded at 11:13:21.102315 after 13.55 seconds
[0m11:13:21.102315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E40A999BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E40FD92CF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E40A665670>]}
[0m11:13:21.102315 [debug] [MainThread]: Flushing usage events
[0m11:13:22.254252 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:14:08.764439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC94751D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC913DD550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC923BE660>]}


============================== 11:14:08.771457 | 1ed05967-4231-42c8-bf3c-7a8313fe2311 ==============================
[0m11:14:08.771457 [info ] [MainThread]: Running with dbt=1.10.1
[0m11:14:08.771457 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\dbt_workspace\\Slip_Tests\\logs', 'profiles_dir': 'C:\\Users\\ThembaniFaleni\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select src_tags', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:14:09.840047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ed05967-4231-42c8-bf3c-7a8313fe2311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC91F2A300>]}
[0m11:14:10.034259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1ed05967-4231-42c8-bf3c-7a8313fe2311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC96FB71A0>]}
[0m11:14:10.034259 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m11:14:10.420986 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m11:14:10.773804 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:14:10.781315 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:14:10.881160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ed05967-4231-42c8-bf3c-7a8313fe2311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC96DB58B0>]}
[0m11:14:11.112598 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m11:14:11.128322 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m11:14:11.175464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ed05967-4231-42c8-bf3c-7a8313fe2311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC97066CC0>]}
[0m11:14:11.175464 [info ] [MainThread]: Found 12 models, 12 data tests, 1 snapshot, 6 sources, 592 macros
[0m11:14:11.177800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ed05967-4231-42c8-bf3c-7a8313fe2311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC96B4DBB0>]}
[0m11:14:11.182297 [info ] [MainThread]: 
[0m11:14:11.182297 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:14:11.188879 [info ] [MainThread]: 
[0m11:14:11.193379 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:14:11.200873 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MOVIELENS'
[0m11:14:11.332748 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS"
[0m11:14:11.332748 [debug] [ThreadPool]: On list_MOVIELENS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS"} */
show terse schemas in database MOVIELENS
    limit 10000
[0m11:14:11.332748 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:14:12.758375 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.417 seconds
[0m11:14:12.775738 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MOVIELENS_DEV'
[0m11:14:12.789758 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m11:14:12.789758 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session set quoted_identifiers_ignore_case = false;
[0m11:14:12.789758 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:14:14.184730 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.395 seconds
[0m11:14:14.200991 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m11:14:14.200991 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
show objects in MOVIELENS.DEV
    limit 10000
    
;
[0m11:14:14.505725 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.302 seconds
[0m11:14:14.505725 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m11:14:14.505725 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session unset quoted_identifiers_ignore_case;
[0m11:14:14.804189 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.297 seconds
[0m11:14:14.804189 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MOVIELENS_DEV, now list_MOVIELENS_snapshots)
[0m11:14:14.820582 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m11:14:14.820582 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
alter session set quoted_identifiers_ignore_case = false;
[0m11:14:15.105516 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.280 seconds
[0m11:14:15.105516 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m11:14:15.105516 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
show objects in MOVIELENS.snapshots
    limit 10000
    
;
[0m11:14:15.486150 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.378 seconds
[0m11:14:15.486150 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m11:14:15.486150 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
alter session unset quoted_identifiers_ignore_case;
[0m11:14:15.738285 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.246 seconds
[0m11:14:15.740947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ed05967-4231-42c8-bf3c-7a8313fe2311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC96EFB5F0>]}
[0m11:14:15.746509 [debug] [Thread-1 (]: Began running node model.Slip_Tests.src_tags
[0m11:14:15.747585 [info ] [Thread-1 (]: 1 of 1 START sql table model DEV.src_tags ...................................... [RUN]
[0m11:14:15.748696 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Slip_Tests.src_tags'
[0m11:14:15.749775 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.src_tags
[0m11:14:15.755700 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.src_tags"
[0m11:14:15.755700 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.src_tags
[0m11:14:15.828193 [debug] [Thread-1 (]: Writing runtime sql for node "model.Slip_Tests.src_tags"
[0m11:14:15.828193 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.src_tags"
[0m11:14:15.828193 [debug] [Thread-1 (]: On model.Slip_Tests.src_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.src_tags"} */
create or replace transient table MOVIELENS.DEV.src_tags
    

    
    as (

WITH raw_tags AS (
    SELECT * FROM MOVIELENS.RAW.RAW_TAGS
)
SELECT
    userId AS user_id,
    movieId AS movie_id,
    tag,
    TO_TIMESTAMP_NTZ(timestamp) AS tag_timestamp
FROM raw_tags
    )
;
[0m11:14:15.828193 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:14:18.526149 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.693 seconds
[0m11:14:18.558451 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ed05967-4231-42c8-bf3c-7a8313fe2311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC941D1F10>]}
[0m11:14:18.558451 [info ] [Thread-1 (]: 1 of 1 OK created sql table model DEV.src_tags ................................. [[32mSUCCESS 1[0m in 2.81s]
[0m11:14:18.572970 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.src_tags
[0m11:14:18.574414 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:14:18.574414 [debug] [MainThread]: Connection 'list_MOVIELENS' was left open.
[0m11:14:18.574414 [debug] [MainThread]: On list_MOVIELENS: Close
[0m11:14:18.962256 [debug] [MainThread]: Connection 'list_MOVIELENS_snapshots' was left open.
[0m11:14:18.962256 [debug] [MainThread]: On list_MOVIELENS_snapshots: Close
[0m11:14:19.409609 [debug] [MainThread]: Connection 'model.Slip_Tests.src_tags' was left open.
[0m11:14:19.409609 [debug] [MainThread]: On model.Slip_Tests.src_tags: Close
[0m11:14:19.867733 [info ] [MainThread]: 
[0m11:14:19.886381 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.67 seconds (8.67s).
[0m11:14:19.887978 [debug] [MainThread]: Command end result
[0m11:14:19.936475 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m11:14:19.938297 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m11:14:19.951180 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\dbt_workspace\Slip_Tests\target\run_results.json
[0m11:14:19.951180 [info ] [MainThread]: 
[0m11:14:19.958690 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:14:19.958690 [info ] [MainThread]: 
[0m11:14:19.958690 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m11:14:19.958690 [debug] [MainThread]: Command `dbt run` succeeded at 11:14:19.958690 after 11.47 seconds
[0m11:14:19.958690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC949433B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC94289040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC942884A0>]}
[0m11:14:19.958690 [debug] [MainThread]: Flushing usage events
[0m11:14:20.893827 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:15:52.778585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0D481FF20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0D4E743B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0D4E74E60>]}


============================== 11:15:52.778585 | e0de628a-e502-4430-b59b-17a4b457958f ==============================
[0m11:15:52.778585 [info ] [MainThread]: Running with dbt=1.10.1
[0m11:15:52.778585 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\ThembaniFaleni\\.dbt', 'log_path': 'C:\\dbt_workspace\\Slip_Tests\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:15:54.236462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0de628a-e502-4430-b59b-17a4b457958f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0D71438C0>]}
[0m11:15:54.518555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e0de628a-e502-4430-b59b-17a4b457958f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0D6B3E7E0>]}
[0m11:15:54.518555 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m11:15:55.049117 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m11:15:55.462337 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:15:55.462337 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:15:55.599094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0de628a-e502-4430-b59b-17a4b457958f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0D638DAF0>]}
[0m11:15:55.914384 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m11:15:55.931211 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m11:15:55.977538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0de628a-e502-4430-b59b-17a4b457958f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0D75B5EE0>]}
[0m11:15:55.977538 [info ] [MainThread]: Found 12 models, 12 data tests, 1 snapshot, 6 sources, 592 macros
[0m11:15:55.977538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0de628a-e502-4430-b59b-17a4b457958f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0D744CD70>]}
[0m11:15:55.997197 [info ] [MainThread]: 
[0m11:15:55.997197 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:15:55.999394 [info ] [MainThread]: 
[0m11:15:55.999394 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:15:56.003370 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MOVIELENS'
[0m11:15:56.168043 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS"
[0m11:15:56.168043 [debug] [ThreadPool]: On list_MOVIELENS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS"} */
show terse schemas in database MOVIELENS
    limit 10000
[0m11:15:56.168043 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:15:57.886207 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.707 seconds
[0m11:15:57.898973 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MOVIELENS_snapshots'
[0m11:15:57.914865 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m11:15:57.914865 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
alter session set quoted_identifiers_ignore_case = false;
[0m11:15:57.914865 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:15:59.235606 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.314 seconds
[0m11:15:59.247333 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m11:15:59.247912 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
show objects in MOVIELENS.snapshots
    limit 10000
    
;
[0m11:15:59.636319 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.387 seconds
[0m11:15:59.681258 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m11:15:59.681258 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
alter session unset quoted_identifiers_ignore_case;
[0m11:15:59.924923 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.252 seconds
[0m11:15:59.924923 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MOVIELENS_snapshots, now list_MOVIELENS_DEV)
[0m11:15:59.940529 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m11:15:59.940529 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session set quoted_identifiers_ignore_case = false;
[0m11:16:00.254370 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.313 seconds
[0m11:16:00.254370 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m11:16:00.254370 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
show objects in MOVIELENS.DEV
    limit 10000
    
;
[0m11:16:00.615621 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.355 seconds
[0m11:16:00.615621 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m11:16:00.615621 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session unset quoted_identifiers_ignore_case;
[0m11:16:00.923271 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.296 seconds
[0m11:16:00.931976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0de628a-e502-4430-b59b-17a4b457958f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0D49FC8F0>]}
[0m11:16:00.940892 [debug] [Thread-1 (]: Began running node snapshot.Slip_Tests.snap_tags
[0m11:16:00.942239 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.snap_tags ...................................... [RUN]
[0m11:16:00.943343 [debug] [Thread-1 (]: Acquiring new snowflake connection 'snapshot.Slip_Tests.snap_tags'
[0m11:16:00.943343 [debug] [Thread-1 (]: Began compiling node snapshot.Slip_Tests.snap_tags
[0m11:16:01.003683 [debug] [Thread-1 (]: Began executing node snapshot.Slip_Tests.snap_tags
[0m11:16:01.121795 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m11:16:01.121795 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
[0m11:16:01.121795 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:16:02.365486 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 1.242 seconds
[0m11:16:02.542097 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m11:16:02.542097 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
create or replace temporary table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS__dbt_tmp"
as (
    
    
    with snapshot_query as (

        



SELECT
    md5(cast(coalesce(cast(user_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(movie_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS id,
    user_id,
    movie_id,
    tag,
    tag_timestamp
FROM MOVIELENS.DEV.src_tags
-- LIMIT 100


    ),

    snapshotted_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    

        from "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    
,
            tag_timestamp as dbt_updated_at,
            tag_timestamp as dbt_valid_from,
            
  
  coalesce(nullif(tag_timestamp, tag_timestamp), null)
  as dbt_valid_to
,
            md5(coalesce(cast(user_id as varchar ), '')
         || '|' || coalesce(cast(movie_id as varchar ), '')
         || '|' || coalesce(cast(tag as varchar ), '')
         || '|' || coalesce(cast(tag_timestamp as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    
,
            tag_timestamp as dbt_updated_at,
            tag_timestamp as dbt_valid_from,
            tag_timestamp as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

            where 
    
        snapshotted_data.dbt_unique_key_1 is null
    

            or (
    
        snapshotted_data.dbt_unique_key_1 is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.tag_timestamp)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.tag_timestamp)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

            where 
    
        source_data.dbt_unique_key_1 is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    )
;
[0m11:16:06.992967 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.449 seconds
[0m11:16:06.992967 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m11:16:06.992967 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS__dbt_tmp"
[0m11:16:07.228930 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.233 seconds
[0m11:16:07.244527 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m11:16:07.244527 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
[0m11:16:07.511829 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.263 seconds
[0m11:16:07.583129 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m11:16:07.583129 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS__dbt_tmp"
[0m11:16:07.849471 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.262 seconds
[0m11:16:07.887144 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m11:16:07.887144 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
[0m11:16:08.156964 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.262 seconds
[0m11:16:08.172468 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m11:16:08.172468 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS__dbt_tmp"
[0m11:16:08.421411 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.260 seconds
[0m11:16:08.485898 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m11:16:08.485898 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
/* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
select * from (
        
    
    with snapshot_query as (

        



SELECT
    md5(cast(coalesce(cast(user_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(movie_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS id,
    user_id,
    movie_id,
    tag,
    tag_timestamp
FROM MOVIELENS.DEV.src_tags
-- LIMIT 100


    ),

    snapshotted_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    

        from "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    
,
            tag_timestamp as dbt_updated_at,
            tag_timestamp as dbt_valid_from,
            
  
  coalesce(nullif(tag_timestamp, tag_timestamp), null)
  as dbt_valid_to
,
            md5(coalesce(cast(user_id as varchar ), '')
         || '|' || coalesce(cast(movie_id as varchar ), '')
         || '|' || coalesce(cast(tag as varchar ), '')
         || '|' || coalesce(cast(tag_timestamp as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    
,
            tag_timestamp as dbt_updated_at,
            tag_timestamp as dbt_valid_from,
            tag_timestamp as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

            where 
    
        snapshotted_data.dbt_unique_key_1 is null
    

            or (
    
        snapshotted_data.dbt_unique_key_1 is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.tag_timestamp)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.tag_timestamp)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

            where 
    
        source_data.dbt_unique_key_1 is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m11:16:09.149455 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.671 seconds
[0m11:16:09.165086 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m11:16:09.165086 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
/* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m11:16:09.401877 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.233 seconds
[0m11:16:09.401877 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.Slip_Tests.snap_tags"
[0m11:16:09.401877 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m11:16:09.401877 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
BEGIN
[0m11:16:09.861652 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.456 seconds
[0m11:16:09.861652 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m11:16:09.861652 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
merge into "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS" as DBT_INTERNAL_DEST
    using "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("ID", "USER_ID", "MOVIE_ID", "TAG", "TAG_TIMESTAMP", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("ID", "USER_ID", "MOVIE_ID", "TAG", "TAG_TIMESTAMP", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m11:16:14.359866 [debug] [Thread-1 (]: SQL status: SUCCESS 931122 in 4.504 seconds
[0m11:16:14.376200 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m11:16:14.376200 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
COMMIT
[0m11:16:14.990608 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.613 seconds
[0m11:16:15.051228 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0de628a-e502-4430-b59b-17a4b457958f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0D7B65310>]}
[0m11:16:15.051228 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.snap_tags ...................................... [[32mSUCCESS 931122[0m in 14.11s]
[0m11:16:15.051228 [debug] [Thread-1 (]: Finished running node snapshot.Slip_Tests.snap_tags
[0m11:16:15.051228 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:16:15.064775 [debug] [MainThread]: Connection 'list_MOVIELENS' was left open.
[0m11:16:15.064775 [debug] [MainThread]: On list_MOVIELENS: Close
[0m11:16:15.499435 [debug] [MainThread]: Connection 'list_MOVIELENS_DEV' was left open.
[0m11:16:15.499435 [debug] [MainThread]: On list_MOVIELENS_DEV: Close
[0m11:16:15.908493 [debug] [MainThread]: Connection 'snapshot.Slip_Tests.snap_tags' was left open.
[0m11:16:15.908493 [debug] [MainThread]: On snapshot.Slip_Tests.snap_tags: Close
[0m11:16:16.301194 [info ] [MainThread]: 
[0m11:16:16.301194 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 20.30 seconds (20.30s).
[0m11:16:16.311305 [debug] [MainThread]: Command end result
[0m11:16:16.367546 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m11:16:16.379223 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m11:16:16.401312 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\dbt_workspace\Slip_Tests\target\run_results.json
[0m11:16:16.401312 [info ] [MainThread]: 
[0m11:16:16.413765 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:16:16.413765 [info ] [MainThread]: 
[0m11:16:16.426467 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m11:16:16.431073 [debug] [MainThread]: Command `dbt snapshot` succeeded at 11:16:16.431073 after 23.98 seconds
[0m11:16:16.431073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0D2458E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0D28C7200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0D28C73E0>]}
[0m11:16:16.433589 [debug] [MainThread]: Flushing usage events
[0m11:16:17.762191 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:18:33.539770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011629CA6720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011629CA71A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001162BF31820>]}


============================== 11:18:33.539770 | f005fca0-7aea-4669-8d33-930d79423e2c ==============================
[0m11:18:33.539770 [info ] [MainThread]: Running with dbt=1.10.1
[0m11:18:33.539770 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\ThembaniFaleni\\.dbt', 'log_path': 'C:\\dbt_workspace\\Slip_Tests\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:18:34.642807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f005fca0-7aea-4669-8d33-930d79423e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001162DEF1220>]}
[0m11:18:34.841891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f005fca0-7aea-4669-8d33-930d79423e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001162E1FB500>]}
[0m11:18:34.841891 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m11:18:35.261318 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m11:18:35.606565 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:18:35.618573 [debug] [MainThread]: Partial parsing: updated file: Slip_Tests://snapshots\snap_tag.sql
[0m11:18:36.924930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f005fca0-7aea-4669-8d33-930d79423e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001162E91B080>]}
[0m11:18:37.147403 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m11:18:37.178783 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m11:18:37.220155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f005fca0-7aea-4669-8d33-930d79423e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001162E926AE0>]}
[0m11:18:37.220155 [info ] [MainThread]: Found 12 models, 12 data tests, 1 snapshot, 6 sources, 592 macros
[0m11:18:37.224070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f005fca0-7aea-4669-8d33-930d79423e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001162E91CF50>]}
[0m11:18:37.234438 [info ] [MainThread]: 
[0m11:18:37.236111 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:18:37.238260 [info ] [MainThread]: 
[0m11:18:37.241139 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:18:37.243673 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MOVIELENS'
[0m11:18:37.362496 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS"
[0m11:18:37.362496 [debug] [ThreadPool]: On list_MOVIELENS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS"} */
show terse schemas in database MOVIELENS
    limit 10000
[0m11:18:37.362496 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:18:38.912939 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.546 seconds
[0m11:18:38.929262 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MOVIELENS_DEV'
[0m11:18:38.945122 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m11:18:38.945122 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session set quoted_identifiers_ignore_case = false;
[0m11:18:38.945122 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:18:40.166103 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.219 seconds
[0m11:18:40.166103 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m11:18:40.166103 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
show objects in MOVIELENS.DEV
    limit 10000
    
;
[0m11:18:40.599268 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.425 seconds
[0m11:18:40.599268 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m11:18:40.599268 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session unset quoted_identifiers_ignore_case;
[0m11:18:40.867836 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.262 seconds
[0m11:18:40.867836 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MOVIELENS_DEV, now list_MOVIELENS_snapshots)
[0m11:18:40.867836 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m11:18:40.867836 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
alter session set quoted_identifiers_ignore_case = false;
[0m11:18:41.151306 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.269 seconds
[0m11:18:41.151306 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m11:18:41.151306 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
show objects in MOVIELENS.snapshots
    limit 10000
    
;
[0m11:18:41.485847 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.331 seconds
[0m11:18:41.485847 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m11:18:41.485847 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
alter session unset quoted_identifiers_ignore_case;
[0m11:18:41.727333 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.234 seconds
[0m11:18:41.730585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f005fca0-7aea-4669-8d33-930d79423e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001162E248620>]}
[0m11:18:41.737595 [debug] [Thread-1 (]: Began running node snapshot.Slip_Tests.snap_tags
[0m11:18:41.739125 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.snap_tags ...................................... [RUN]
[0m11:18:41.740252 [debug] [Thread-1 (]: Acquiring new snowflake connection 'snapshot.Slip_Tests.snap_tags'
[0m11:18:41.740920 [debug] [Thread-1 (]: Began compiling node snapshot.Slip_Tests.snap_tags
[0m11:18:41.753497 [debug] [Thread-1 (]: Began executing node snapshot.Slip_Tests.snap_tags
[0m11:18:41.847334 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m11:18:41.847334 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
[0m11:18:41.851343 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:18:43.067747 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 1.217 seconds
[0m11:18:43.161828 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m11:18:43.161828 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
create or replace temporary table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS__dbt_tmp"
as (
    
    
    with snapshot_query as (

        



SELECT
    md5(cast(coalesce(cast(user_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(movie_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS id,
    user_id,
    movie_id,
    tag,
    TO_TIMESTAMP_NTZ(tag_timestamp) as tag_timestamp
FROM MOVIELENS.DEV.src_tags
-- LIMIT 100


    ),

    snapshotted_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    

        from "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    
,
            tag_timestamp as dbt_updated_at,
            tag_timestamp as dbt_valid_from,
            
  
  coalesce(nullif(tag_timestamp, tag_timestamp), null)
  as dbt_valid_to
,
            md5(coalesce(cast(user_id as varchar ), '')
         || '|' || coalesce(cast(movie_id as varchar ), '')
         || '|' || coalesce(cast(tag as varchar ), '')
         || '|' || coalesce(cast(tag_timestamp as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    
,
            tag_timestamp as dbt_updated_at,
            tag_timestamp as dbt_valid_from,
            tag_timestamp as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

            where 
    
        snapshotted_data.dbt_unique_key_1 is null
    

            or (
    
        snapshotted_data.dbt_unique_key_1 is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.tag_timestamp)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.tag_timestamp)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

            where 
    
        source_data.dbt_unique_key_1 is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    )
;
[0m11:18:45.642435 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.478 seconds
[0m11:18:45.658461 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m11:18:45.660223 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS__dbt_tmp"
[0m11:18:45.995132 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.334 seconds
[0m11:18:46.054857 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m11:18:46.054857 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
[0m11:18:46.328986 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.271 seconds
[0m11:18:46.328986 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m11:18:46.328986 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS__dbt_tmp"
[0m11:18:46.594520 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.255 seconds
[0m11:18:46.598238 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m11:18:46.598238 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
[0m11:18:46.845091 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.246 seconds
[0m11:18:46.860978 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m11:18:46.861694 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS__dbt_tmp"
[0m11:18:47.144669 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.281 seconds
[0m11:18:47.179848 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m11:18:47.179848 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
/* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
select * from (
        
    
    with snapshot_query as (

        



SELECT
    md5(cast(coalesce(cast(user_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(movie_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS id,
    user_id,
    movie_id,
    tag,
    TO_TIMESTAMP_NTZ(tag_timestamp) as tag_timestamp
FROM MOVIELENS.DEV.src_tags
-- LIMIT 100


    ),

    snapshotted_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    

        from "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    
,
            tag_timestamp as dbt_updated_at,
            tag_timestamp as dbt_valid_from,
            
  
  coalesce(nullif(tag_timestamp, tag_timestamp), null)
  as dbt_valid_to
,
            md5(coalesce(cast(user_id as varchar ), '')
         || '|' || coalesce(cast(movie_id as varchar ), '')
         || '|' || coalesce(cast(tag as varchar ), '')
         || '|' || coalesce(cast(tag_timestamp as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    
,
            tag_timestamp as dbt_updated_at,
            tag_timestamp as dbt_valid_from,
            tag_timestamp as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

            where 
    
        snapshotted_data.dbt_unique_key_1 is null
    

            or (
    
        snapshotted_data.dbt_unique_key_1 is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.tag_timestamp)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.tag_timestamp)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

            where 
    
        source_data.dbt_unique_key_1 is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m11:18:47.701087 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.511 seconds
[0m11:18:47.702786 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m11:18:47.702786 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
/* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m11:18:47.979242 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.268 seconds
[0m11:18:47.979242 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.Slip_Tests.snap_tags"
[0m11:18:47.986283 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m11:18:47.986283 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
BEGIN
[0m11:18:48.398061 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.416 seconds
[0m11:18:48.398061 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m11:18:48.398061 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
merge into "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS" as DBT_INTERNAL_DEST
    using "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("ID", "USER_ID", "MOVIE_ID", "TAG", "TAG_TIMESTAMP", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("ID", "USER_ID", "MOVIE_ID", "TAG", "TAG_TIMESTAMP", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m11:18:49.352967 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.950 seconds
[0m11:18:49.352967 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m11:18:49.352967 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
COMMIT
[0m11:18:49.865597 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.511 seconds
[0m11:18:49.913791 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f005fca0-7aea-4669-8d33-930d79423e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000116291B92B0>]}
[0m11:18:49.916001 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.snap_tags ...................................... [[32mSUCCESS 0[0m in 8.17s]
[0m11:18:49.917876 [debug] [Thread-1 (]: Finished running node snapshot.Slip_Tests.snap_tags
[0m11:18:49.920620 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:18:49.920620 [debug] [MainThread]: Connection 'list_MOVIELENS' was left open.
[0m11:18:49.920620 [debug] [MainThread]: On list_MOVIELENS: Close
[0m11:18:50.341672 [debug] [MainThread]: Connection 'list_MOVIELENS_snapshots' was left open.
[0m11:18:50.341672 [debug] [MainThread]: On list_MOVIELENS_snapshots: Close
[0m11:18:50.717977 [debug] [MainThread]: Connection 'snapshot.Slip_Tests.snap_tags' was left open.
[0m11:18:50.717977 [debug] [MainThread]: On snapshot.Slip_Tests.snap_tags: Close
[0m11:18:51.139986 [info ] [MainThread]: 
[0m11:18:51.139986 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 13.90 seconds (13.90s).
[0m11:18:51.139986 [debug] [MainThread]: Command end result
[0m11:18:51.201011 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m11:18:51.201011 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m11:18:51.233427 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\dbt_workspace\Slip_Tests\target\run_results.json
[0m11:18:51.235941 [info ] [MainThread]: 
[0m11:18:51.235941 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:18:51.235941 [info ] [MainThread]: 
[0m11:18:51.235941 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m11:18:51.235941 [debug] [MainThread]: Command `dbt snapshot` succeeded at 11:18:51.235941 after 18.02 seconds
[0m11:18:51.235941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011629CA71A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001162C003B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001162B4E0980>]}
[0m11:18:51.235941 [debug] [MainThread]: Flushing usage events
[0m11:18:52.284920 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:05:22.707795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001750E5D15E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001750D874E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001750D874860>]}


============================== 12:05:22.715130 | bc7e8fbd-5d9d-44b6-a845-2c8ca3a48018 ==============================
[0m12:05:22.715130 [info ] [MainThread]: Running with dbt=1.10.1
[0m12:05:22.716323 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\ThembaniFaleni\\.dbt', 'log_path': 'C:\\dbt_workspace\\Slip_Tests\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:05:23.865469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc7e8fbd-5d9d-44b6-a845-2c8ca3a48018', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017510E93F80>]}
[0m12:05:24.102273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bc7e8fbd-5d9d-44b6-a845-2c8ca3a48018', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001750E0D1E20>]}
[0m12:05:24.106394 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m12:05:24.516611 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m12:05:24.867562 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:05:24.868600 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:05:24.987406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc7e8fbd-5d9d-44b6-a845-2c8ca3a48018', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001751136FF80>]}
[0m12:05:25.289950 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m12:05:25.305626 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m12:05:25.337530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc7e8fbd-5d9d-44b6-a845-2c8ca3a48018', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175110E6420>]}
[0m12:05:25.337530 [info ] [MainThread]: Found 12 models, 12 data tests, 1 snapshot, 6 sources, 592 macros
[0m12:05:25.352756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc7e8fbd-5d9d-44b6-a845-2c8ca3a48018', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001751132FCB0>]}
[0m12:05:25.356964 [info ] [MainThread]: 
[0m12:05:25.357996 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:05:25.359023 [info ] [MainThread]: 
[0m12:05:25.359023 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:05:25.359023 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MOVIELENS'
[0m12:05:25.483157 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS"
[0m12:05:25.483157 [debug] [ThreadPool]: On list_MOVIELENS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS"} */
show terse schemas in database MOVIELENS
    limit 10000
[0m12:05:25.483157 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:05:28.044878 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.559 seconds
[0m12:05:28.072248 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MOVIELENS_DEV'
[0m12:05:28.103598 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m12:05:28.103598 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session set quoted_identifiers_ignore_case = false;
[0m12:05:28.103598 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:05:29.523185 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.413 seconds
[0m12:05:29.523185 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m12:05:29.523185 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
show objects in MOVIELENS.DEV
    limit 10000
    
;
[0m12:05:29.896521 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.362 seconds
[0m12:05:29.901406 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m12:05:29.901406 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session unset quoted_identifiers_ignore_case;
[0m12:05:30.346144 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.441 seconds
[0m12:05:30.346144 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MOVIELENS_DEV, now list_MOVIELENS_snapshots)
[0m12:05:30.355428 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m12:05:30.355428 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
alter session set quoted_identifiers_ignore_case = false;
[0m12:05:30.638721 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.289 seconds
[0m12:05:30.650241 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m12:05:30.650241 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
show objects in MOVIELENS.snapshots
    limit 10000
    
;
[0m12:05:31.025407 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.375 seconds
[0m12:05:31.025407 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m12:05:31.025407 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
alter session unset quoted_identifiers_ignore_case;
[0m12:05:31.503114 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.473 seconds
[0m12:05:31.511589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc7e8fbd-5d9d-44b6-a845-2c8ca3a48018', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175119373B0>]}
[0m12:05:31.511589 [debug] [Thread-1 (]: Began running node snapshot.Slip_Tests.snap_tags
[0m12:05:31.511589 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.snap_tags ...................................... [RUN]
[0m12:05:31.511589 [debug] [Thread-1 (]: Acquiring new snowflake connection 'snapshot.Slip_Tests.snap_tags'
[0m12:05:31.511589 [debug] [Thread-1 (]: Began compiling node snapshot.Slip_Tests.snap_tags
[0m12:05:31.573895 [debug] [Thread-1 (]: Began executing node snapshot.Slip_Tests.snap_tags
[0m12:05:31.683163 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m12:05:31.683163 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
[0m12:05:31.683163 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:05:33.219544 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 1.529 seconds
[0m12:05:33.314731 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m12:05:33.314731 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
create or replace temporary table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS__dbt_tmp"
as (
    
    
    with snapshot_query as (

        



SELECT
    md5(cast(coalesce(cast(user_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(movie_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS id,
    user_id,
    movie_id,
    tag,
    TO_TIMESTAMP_NTZ(tag_timestamp) as tag_timestamp
FROM MOVIELENS.DEV.src_tags
-- LIMIT 100


    ),

    snapshotted_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    

        from "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    
,
            tag_timestamp as dbt_updated_at,
            tag_timestamp as dbt_valid_from,
            
  
  coalesce(nullif(tag_timestamp, tag_timestamp), null)
  as dbt_valid_to
,
            md5(coalesce(cast(user_id as varchar ), '')
         || '|' || coalesce(cast(movie_id as varchar ), '')
         || '|' || coalesce(cast(tag as varchar ), '')
         || '|' || coalesce(cast(tag_timestamp as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    
,
            tag_timestamp as dbt_updated_at,
            tag_timestamp as dbt_valid_from,
            tag_timestamp as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

            where 
    
        snapshotted_data.dbt_unique_key_1 is null
    

            or (
    
        snapshotted_data.dbt_unique_key_1 is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.tag_timestamp)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.tag_timestamp)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

            where 
    
        source_data.dbt_unique_key_1 is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    )
;
[0m12:05:36.699973 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.374 seconds
[0m12:05:36.703076 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m12:05:36.703076 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS__dbt_tmp"
[0m12:05:36.950126 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.248 seconds
[0m12:05:36.965741 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m12:05:36.965741 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
[0m12:05:37.204104 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.240 seconds
[0m12:05:37.217205 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m12:05:37.217205 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS__dbt_tmp"
[0m12:05:37.451582 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.241 seconds
[0m12:05:37.467197 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m12:05:37.467197 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
[0m12:05:37.705145 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.244 seconds
[0m12:05:37.736601 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m12:05:37.736601 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS__dbt_tmp"
[0m12:05:37.969258 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.233 seconds
[0m12:05:38.016709 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m12:05:38.016709 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
/* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
select * from (
        
    
    with snapshot_query as (

        



SELECT
    md5(cast(coalesce(cast(user_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(movie_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS id,
    user_id,
    movie_id,
    tag,
    TO_TIMESTAMP_NTZ(tag_timestamp) as tag_timestamp
FROM MOVIELENS.DEV.src_tags
-- LIMIT 100


    ),

    snapshotted_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    

        from "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    
,
            tag_timestamp as dbt_updated_at,
            tag_timestamp as dbt_valid_from,
            
  
  coalesce(nullif(tag_timestamp, tag_timestamp), null)
  as dbt_valid_to
,
            md5(coalesce(cast(user_id as varchar ), '')
         || '|' || coalesce(cast(movie_id as varchar ), '')
         || '|' || coalesce(cast(tag as varchar ), '')
         || '|' || coalesce(cast(tag_timestamp as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    
,
            tag_timestamp as dbt_updated_at,
            tag_timestamp as dbt_valid_from,
            tag_timestamp as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

            where 
    
        snapshotted_data.dbt_unique_key_1 is null
    

            or (
    
        snapshotted_data.dbt_unique_key_1 is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.tag_timestamp)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.tag_timestamp)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

            where 
    
        source_data.dbt_unique_key_1 is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m12:05:38.849422 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.825 seconds
[0m12:05:38.849422 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m12:05:38.849422 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
/* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m12:05:39.065847 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.206 seconds
[0m12:05:39.065847 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.Slip_Tests.snap_tags"
[0m12:05:39.065847 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m12:05:39.065847 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
BEGIN
[0m12:05:39.347954 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.283 seconds
[0m12:05:39.347954 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m12:05:39.347954 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
merge into "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS" as DBT_INTERNAL_DEST
    using "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("ID", "USER_ID", "MOVIE_ID", "TAG", "TAG_TIMESTAMP", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("ID", "USER_ID", "MOVIE_ID", "TAG", "TAG_TIMESTAMP", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m12:05:41.512498 [debug] [Thread-1 (]: SQL status: SUCCESS 2 in 2.153 seconds
[0m12:05:41.512498 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m12:05:41.512498 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
COMMIT
[0m12:05:42.122214 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.604 seconds
[0m12:05:42.169778 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc7e8fbd-5d9d-44b6-a845-2c8ca3a48018', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001750BD492E0>]}
[0m12:05:42.169778 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.snap_tags ...................................... [[32mSUCCESS 2[0m in 10.64s]
[0m12:05:42.169778 [debug] [Thread-1 (]: Finished running node snapshot.Slip_Tests.snap_tags
[0m12:05:42.178877 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:05:42.178877 [debug] [MainThread]: Connection 'list_MOVIELENS' was left open.
[0m12:05:42.178877 [debug] [MainThread]: On list_MOVIELENS: Close
[0m12:05:42.557581 [debug] [MainThread]: Connection 'list_MOVIELENS_snapshots' was left open.
[0m12:05:42.572105 [debug] [MainThread]: On list_MOVIELENS_snapshots: Close
[0m12:05:42.942899 [debug] [MainThread]: Connection 'snapshot.Slip_Tests.snap_tags' was left open.
[0m12:05:42.942899 [debug] [MainThread]: On snapshot.Slip_Tests.snap_tags: Close
[0m12:05:43.423774 [info ] [MainThread]: 
[0m12:05:43.423774 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 18.06 seconds (18.06s).
[0m12:05:43.423774 [debug] [MainThread]: Command end result
[0m12:05:43.476698 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m12:05:43.489643 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m12:05:43.518133 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\dbt_workspace\Slip_Tests\target\run_results.json
[0m12:05:43.518133 [info ] [MainThread]: 
[0m12:05:43.523231 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:05:43.523231 [info ] [MainThread]: 
[0m12:05:43.523231 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:05:43.529249 [debug] [MainThread]: Command `dbt snapshot` succeeded at 12:05:43.523231 after 21.18 seconds
[0m12:05:43.529249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017508355640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017511377E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001750C73C260>]}
[0m12:05:43.529249 [debug] [MainThread]: Flushing usage events
[0m12:05:44.918515 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:12:09.291240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001572D0AFF20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157298F8CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001572D2CF860>]}


============================== 12:12:09.291240 | 634a54c6-9c10-4341-ac50-160fa8f29da7 ==============================
[0m12:12:09.291240 [info ] [MainThread]: Running with dbt=1.10.1
[0m12:12:09.306257 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\dbt_workspace\\Slip_Tests\\logs', 'profiles_dir': 'C:\\Users\\ThembaniFaleni\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:12:10.791138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '634a54c6-9c10-4341-ac50-160fa8f29da7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001572D7002F0>]}
[0m12:12:11.074596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '634a54c6-9c10-4341-ac50-160fa8f29da7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001572F22E0C0>]}
[0m12:12:11.074596 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m12:12:11.549290 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m12:12:11.949940 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:12:11.949940 [debug] [MainThread]: Partial parsing: updated file: Slip_Tests://models\staging\src_tags.sql
[0m12:12:12.894162 [error] [MainThread]: Encountered an error:
Compilation Error in model src_tags (models\staging\src_tags.sql)
  expected token 'end of print statement', got 'SESSION'
    line 3
      {{ALTER SESSION SET TIMEZONE = 'Africa/Johannesburg';}}
[0m12:12:12.894162 [debug] [MainThread]: Command `dbt run` failed at 12:12:12.894162 after 3.98 seconds
[0m12:12:12.894162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001572D1D8F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001572FF02E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001572FF025D0>]}
[0m12:12:12.903679 [debug] [MainThread]: Flushing usage events
[0m12:12:14.045163 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:13:03.996039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025ADDAE4E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025ADBE35730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025ADE23F950>]}


============================== 12:13:03.996039 | 9d75bab6-586e-4d1a-b650-6ddc7859f2dc ==============================
[0m12:13:03.996039 [info ] [MainThread]: Running with dbt=1.10.1
[0m12:13:04.009750 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\dbt_workspace\\Slip_Tests\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\ThembaniFaleni\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:13:05.425840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d75bab6-586e-4d1a-b650-6ddc7859f2dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025AE0B29430>]}
[0m12:13:05.656020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d75bab6-586e-4d1a-b650-6ddc7859f2dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025ADDE20800>]}
[0m12:13:05.671747 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m12:13:06.066253 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m12:13:06.437139 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:13:06.437139 [debug] [MainThread]: Partial parsing: updated file: Slip_Tests://models\staging\src_tags.sql
[0m12:13:07.194084 [error] [MainThread]: Encountered an error:
Compilation Error in model src_tags (models\staging\src_tags.sql)
  expected token 'end of print statement', got 'SESSION'
    line 3
      {{ALTER SESSION SET TIMEZONE = 'Africa/Johannesburg'}}
[0m12:13:07.238522 [debug] [MainThread]: Command `dbt run` failed at 12:13:07.238522 after 3.61 seconds
[0m12:13:07.238522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025ADDABB590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025AE1532720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025AE12B72F0>]}
[0m12:13:07.238522 [debug] [MainThread]: Flushing usage events
[0m12:13:08.279739 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:16:55.706289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF8DE18A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF8E3C9250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF8E3C8AA0>]}


============================== 12:16:55.706289 | 32e74ea8-96c9-4fea-a954-b2267e5e872e ==============================
[0m12:16:55.706289 [info ] [MainThread]: Running with dbt=1.10.1
[0m12:16:55.719788 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\dbt_workspace\\Slip_Tests\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\ThembaniFaleni\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:16:56.913409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '32e74ea8-96c9-4fea-a954-b2267e5e872e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF91039F70>]}
[0m12:16:57.131482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '32e74ea8-96c9-4fea-a954-b2267e5e872e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF9103A990>]}
[0m12:16:57.135991 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m12:16:57.539509 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m12:16:57.883513 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m12:16:57.883513 [debug] [MainThread]: Partial parsing: updated file: Slip_Tests://models\staging\src_tags.sql
[0m12:16:57.883513 [debug] [MainThread]: Partial parsing: updated file: Slip_Tests://snapshots\snap_tag.sql
[0m12:16:59.853370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '32e74ea8-96c9-4fea-a954-b2267e5e872e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF9189A900>]}
[0m12:17:00.091744 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m12:17:00.107403 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m12:17:00.169888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '32e74ea8-96c9-4fea-a954-b2267e5e872e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF918DBAD0>]}
[0m12:17:00.169888 [info ] [MainThread]: Found 12 models, 12 data tests, 1 snapshot, 6 sources, 592 macros
[0m12:17:00.169888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32e74ea8-96c9-4fea-a954-b2267e5e872e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF8E2E9880>]}
[0m12:17:00.182913 [info ] [MainThread]: 
[0m12:17:00.182913 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:17:00.185925 [info ] [MainThread]: 
[0m12:17:00.185925 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:17:00.185925 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MOVIELENS'
[0m12:17:00.432788 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS"
[0m12:17:00.432788 [debug] [ThreadPool]: On list_MOVIELENS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS"} */
show terse schemas in database MOVIELENS
    limit 10000
[0m12:17:00.432788 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:17:03.137859 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.701 seconds
[0m12:17:03.148896 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MOVIELENS_snapshots'
[0m12:17:03.165388 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m12:17:03.165388 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
alter session set quoted_identifiers_ignore_case = false;
[0m12:17:03.165388 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:17:04.514158 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.343 seconds
[0m12:17:04.522468 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m12:17:04.522468 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
show objects in MOVIELENS.snapshots
    limit 10000
    
;
[0m12:17:04.889827 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.369 seconds
[0m12:17:04.889827 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m12:17:04.889827 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
alter session unset quoted_identifiers_ignore_case;
[0m12:17:05.140027 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.246 seconds
[0m12:17:05.140027 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MOVIELENS_snapshots, now list_MOVIELENS_DEV)
[0m12:17:05.140027 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m12:17:05.140027 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session set quoted_identifiers_ignore_case = false;
[0m12:17:05.422472 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.278 seconds
[0m12:17:05.422472 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m12:17:05.422472 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
show objects in MOVIELENS.DEV
    limit 10000
    
;
[0m12:17:05.815187 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.379 seconds
[0m12:17:05.822122 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m12:17:05.822122 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session unset quoted_identifiers_ignore_case;
[0m12:17:06.144276 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.331 seconds
[0m12:17:06.159926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32e74ea8-96c9-4fea-a954-b2267e5e872e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF910647D0>]}
[0m12:17:06.172544 [debug] [Thread-1 (]: Began running node model.Slip_Tests.src_genome_score
[0m12:17:06.175940 [info ] [Thread-1 (]: 1 of 11 START sql view model DEV.src_genome_score .............................. [RUN]
[0m12:17:06.176674 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Slip_Tests.src_genome_score'
[0m12:17:06.176674 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.src_genome_score
[0m12:17:06.176674 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.src_genome_score"
[0m12:17:06.176674 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.src_genome_score
[0m12:17:06.271151 [debug] [Thread-1 (]: Writing runtime sql for node "model.Slip_Tests.src_genome_score"
[0m12:17:06.271151 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.src_genome_score"
[0m12:17:06.271151 [debug] [Thread-1 (]: On model.Slip_Tests.src_genome_score: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.src_genome_score"} */
create or replace   view MOVIELENS.DEV.src_genome_score
  
   as (
    -- For genome_scores
WITH raw_genome_scores AS (
    SELECT * FROM MOVIELENS.RAW.RAW_GENOME_SCORES
)

SELECT
    movieId AS movie_id,
    tagId AS tag_id,
    relevance
FROM raw_genome_scores
  );
[0m12:17:06.271151 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:17:07.995365 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.730 seconds
[0m12:17:08.055181 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32e74ea8-96c9-4fea-a954-b2267e5e872e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF8BFE99A0>]}
[0m12:17:08.055181 [info ] [Thread-1 (]: 1 of 11 OK created sql view model DEV.src_genome_score ......................... [[32mSUCCESS 1[0m in 1.88s]
[0m12:17:08.055181 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.src_genome_score
[0m12:17:08.055181 [debug] [Thread-1 (]: Began running node model.Slip_Tests.src_genome_tags
[0m12:17:08.065608 [info ] [Thread-1 (]: 2 of 11 START sql view model DEV.src_genome_tags ............................... [RUN]
[0m12:17:08.065608 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Slip_Tests.src_genome_score, now model.Slip_Tests.src_genome_tags)
[0m12:17:08.065608 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.src_genome_tags
[0m12:17:08.071127 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.src_genome_tags"
[0m12:17:08.071127 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.src_genome_tags
[0m12:17:08.071127 [debug] [Thread-1 (]: Writing runtime sql for node "model.Slip_Tests.src_genome_tags"
[0m12:17:08.071127 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.src_genome_tags"
[0m12:17:08.086773 [debug] [Thread-1 (]: On model.Slip_Tests.src_genome_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.src_genome_tags"} */
create or replace   view MOVIELENS.DEV.src_genome_tags
  
   as (
    WITH raw_genome_tags AS (
    SELECT * FROM MOVIELENS.RAW.RAW_GENOME_TAGS
)

SELECT
    tagId AS tag_id,
    tag
FROM raw_genome_tags
  );
[0m12:17:08.588933 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.501 seconds
[0m12:17:08.590603 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32e74ea8-96c9-4fea-a954-b2267e5e872e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF91FA9760>]}
[0m12:17:08.596616 [info ] [Thread-1 (]: 2 of 11 OK created sql view model DEV.src_genome_tags .......................... [[32mSUCCESS 1[0m in 0.52s]
[0m12:17:08.596616 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.src_genome_tags
[0m12:17:08.596616 [debug] [Thread-1 (]: Began running node model.Slip_Tests.src_links
[0m12:17:08.596616 [info ] [Thread-1 (]: 3 of 11 START sql view model DEV.src_links ..................................... [RUN]
[0m12:17:08.596616 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Slip_Tests.src_genome_tags, now model.Slip_Tests.src_links)
[0m12:17:08.596616 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.src_links
[0m12:17:08.604653 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.src_links"
[0m12:17:08.604653 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.src_links
[0m12:17:08.609641 [debug] [Thread-1 (]: Writing runtime sql for node "model.Slip_Tests.src_links"
[0m12:17:08.615177 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.src_links"
[0m12:17:08.615177 [debug] [Thread-1 (]: On model.Slip_Tests.src_links: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.src_links"} */
create or replace   view MOVIELENS.DEV.src_links
  
   as (
    -- For links
WITH raw_links AS (
    SELECT * FROM MOVIELENS.RAW.RAW_LINKS
)

SELECT
    movieId AS movie_id,
    imdbId AS imdb_id,
    tmdbId AS tmdb_id
FROM raw_links
  );
[0m12:17:09.203412 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.587 seconds
[0m12:17:09.203412 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32e74ea8-96c9-4fea-a954-b2267e5e872e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF91F8EC00>]}
[0m12:17:09.203412 [info ] [Thread-1 (]: 3 of 11 OK created sql view model DEV.src_links ................................ [[32mSUCCESS 1[0m in 0.61s]
[0m12:17:09.203412 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.src_links
[0m12:17:09.203412 [debug] [Thread-1 (]: Began running node model.Slip_Tests.src_movies
[0m12:17:09.203412 [info ] [Thread-1 (]: 4 of 11 START sql view model DEV.src_movies .................................... [RUN]
[0m12:17:09.203412 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Slip_Tests.src_links, now model.Slip_Tests.src_movies)
[0m12:17:09.203412 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.src_movies
[0m12:17:09.203412 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.src_movies"
[0m12:17:09.217931 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.src_movies
[0m12:17:09.217931 [debug] [Thread-1 (]: Writing runtime sql for node "model.Slip_Tests.src_movies"
[0m12:17:09.217931 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.src_movies"
[0m12:17:09.217931 [debug] [Thread-1 (]: On model.Slip_Tests.src_movies: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.src_movies"} */
create or replace   view MOVIELENS.DEV.src_movies
  
   as (
    WITH raw_movies AS (
   SELECT * FROM MOVIELENS.RAW.RAW_MOVIES
)
SELECT
    movieId As movie_id,
    title,
    genres
FROM raw_movies
  );
[0m12:17:09.855369 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.628 seconds
[0m12:17:09.897820 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32e74ea8-96c9-4fea-a954-b2267e5e872e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF91E407D0>]}
[0m12:17:09.897820 [info ] [Thread-1 (]: 4 of 11 OK created sql view model DEV.src_movies ............................... [[32mSUCCESS 1[0m in 0.69s]
[0m12:17:09.897820 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.src_movies
[0m12:17:09.897820 [debug] [Thread-1 (]: Began running node model.Slip_Tests.src_ratings
[0m12:17:09.897820 [info ] [Thread-1 (]: 5 of 11 START sql table model DEV.src_ratings .................................. [RUN]
[0m12:17:09.897820 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Slip_Tests.src_movies, now model.Slip_Tests.src_ratings)
[0m12:17:09.897820 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.src_ratings
[0m12:17:09.897820 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.src_ratings"
[0m12:17:09.897820 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.src_ratings
[0m12:17:09.947976 [debug] [Thread-1 (]: Writing runtime sql for node "model.Slip_Tests.src_ratings"
[0m12:17:09.947976 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.src_ratings"
[0m12:17:09.947976 [debug] [Thread-1 (]: On model.Slip_Tests.src_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.src_ratings"} */
create or replace transient table MOVIELENS.DEV.src_ratings
    

    
    as (

WITH raw_ratings AS (

    SELECT * FROM MOVIELENS.RAW.RAW_RATINGS
)

SELECT
    userId AS user_id,
    movieId AS movie_id,
    rating,
    TO_TIMESTAMP_LTZ(timestamp) AS rating_timestamp
FROM raw_ratings
    )
;
[0m12:17:15.563502 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 5.615 seconds
[0m12:17:15.579113 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32e74ea8-96c9-4fea-a954-b2267e5e872e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF91FC7E90>]}
[0m12:17:15.579113 [info ] [Thread-1 (]: 5 of 11 OK created sql table model DEV.src_ratings ............................. [[32mSUCCESS 1[0m in 5.68s]
[0m12:17:15.579113 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.src_ratings
[0m12:17:15.579113 [debug] [Thread-1 (]: Began running node model.Slip_Tests.src_tags
[0m12:17:15.579113 [info ] [Thread-1 (]: 6 of 11 START sql table model DEV.src_tags ..................................... [RUN]
[0m12:17:15.587786 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Slip_Tests.src_ratings, now model.Slip_Tests.src_tags)
[0m12:17:15.587786 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.src_tags
[0m12:17:15.587786 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.src_tags"
[0m12:17:15.594800 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.src_tags
[0m12:17:15.594800 [debug] [Thread-1 (]: Writing runtime sql for node "model.Slip_Tests.src_tags"
[0m12:17:15.602863 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.src_tags"
[0m12:17:15.603436 [debug] [Thread-1 (]: On model.Slip_Tests.src_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.src_tags"} */
create or replace transient table MOVIELENS.DEV.src_tags
    

    
    as (

WITH raw_tags AS (
    SELECT * FROM MOVIELENS.RAW.RAW_TAGS
)
SELECT
    userId AS user_id,
    movieId AS movie_id,
    tag,
    CONVERT_TIMEZONE('UTC', 'Africa/Johannesburg', TO_TIMESTAMP_NTZ(timestamp)) AS tag_timestamp
    -- TO_TIMESTAMP_NTZ(timestamp) AS tag_timestamp
FROM raw_tags
    )
;
[0m12:17:19.463260 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.861 seconds
[0m12:17:19.463260 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32e74ea8-96c9-4fea-a954-b2267e5e872e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF92FF7320>]}
[0m12:17:19.463260 [info ] [Thread-1 (]: 6 of 11 OK created sql table model DEV.src_tags ................................ [[32mSUCCESS 1[0m in 3.88s]
[0m12:17:19.463260 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.src_tags
[0m12:17:19.463260 [debug] [Thread-1 (]: Began running node model.Slip_Tests.fct_genome_score
[0m12:17:19.463260 [info ] [Thread-1 (]: 7 of 11 START sql table model DEV.fct_genome_score ............................. [RUN]
[0m12:17:19.463260 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Slip_Tests.src_tags, now model.Slip_Tests.fct_genome_score)
[0m12:17:19.463260 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.fct_genome_score
[0m12:17:19.482778 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.fct_genome_score"
[0m12:17:19.487084 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.fct_genome_score
[0m12:17:19.490569 [debug] [Thread-1 (]: Writing runtime sql for node "model.Slip_Tests.fct_genome_score"
[0m12:17:19.498904 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_genome_score"
[0m12:17:19.498904 [debug] [Thread-1 (]: On model.Slip_Tests.fct_genome_score: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_genome_score"} */
create or replace transient table MOVIELENS.DEV.fct_genome_score
    

    
    as (WITH src_scores AS (
    SELECT * FROM MOVIELENS.DEV.src_genome_score
)

SELECT
    movie_id,
    tag_id,
    ROUND(relevance, 4) AS relevance_score
FROM src_scores
WHERE relevance > 0
    )
;
[0m12:17:22.380510 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.885 seconds
[0m12:17:22.380510 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32e74ea8-96c9-4fea-a954-b2267e5e872e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF91FC4980>]}
[0m12:17:22.380510 [info ] [Thread-1 (]: 7 of 11 OK created sql table model DEV.fct_genome_score ........................ [[32mSUCCESS 1[0m in 2.92s]
[0m12:17:22.380510 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.fct_genome_score
[0m12:17:22.380510 [debug] [Thread-1 (]: Began running node model.Slip_Tests.dim_genome_tags
[0m12:17:22.380510 [info ] [Thread-1 (]: 8 of 11 START sql table model DEV.dim_genome_tags .............................. [RUN]
[0m12:17:22.380510 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Slip_Tests.fct_genome_score, now model.Slip_Tests.dim_genome_tags)
[0m12:17:22.396106 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.dim_genome_tags
[0m12:17:22.397298 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.dim_genome_tags"
[0m12:17:22.397298 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.dim_genome_tags
[0m12:17:22.412219 [debug] [Thread-1 (]: Writing runtime sql for node "model.Slip_Tests.dim_genome_tags"
[0m12:17:22.412219 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.dim_genome_tags"
[0m12:17:22.412219 [debug] [Thread-1 (]: On model.Slip_Tests.dim_genome_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.dim_genome_tags"} */
create or replace transient table MOVIELENS.DEV.dim_genome_tags
    

    
    as (WITH src_tags AS (
    SELECT * FROM MOVIELENS.DEV.src_genome_tags
)

SELECT
    tag_id,
    INITCAP(TRIM(tag)) AS tag_name
FROM src_tags
    )
;
[0m12:17:23.853892 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.450 seconds
[0m12:17:23.869953 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32e74ea8-96c9-4fea-a954-b2267e5e872e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF91FC4710>]}
[0m12:17:23.869953 [info ] [Thread-1 (]: 8 of 11 OK created sql table model DEV.dim_genome_tags ......................... [[32mSUCCESS 1[0m in 1.49s]
[0m12:17:23.869953 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.dim_genome_tags
[0m12:17:23.869953 [debug] [Thread-1 (]: Began running node model.Slip_Tests.dim_movies
[0m12:17:23.869953 [info ] [Thread-1 (]: 9 of 11 START sql table model DEV.dim_movies ................................... [RUN]
[0m12:17:23.869953 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Slip_Tests.dim_genome_tags, now model.Slip_Tests.dim_movies)
[0m12:17:23.869953 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.dim_movies
[0m12:17:23.869953 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.dim_movies"
[0m12:17:23.885600 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.dim_movies
[0m12:17:23.888491 [debug] [Thread-1 (]: Writing runtime sql for node "model.Slip_Tests.dim_movies"
[0m12:17:23.894014 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.dim_movies"
[0m12:17:23.894014 [debug] [Thread-1 (]: On model.Slip_Tests.dim_movies: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.dim_movies"} */
create or replace transient table MOVIELENS.DEV.dim_movies
    

    
    as (WITH src_movies AS (
    SELECT * FROM MOVIELENS.DEV.src_movies
)

SELECT
    movie_id,
    INITCAP(TRIM(title)) AS movie_title,
    SPLIT(genres, '|') AS genre_array,
FROM src_movies
    )
;
[0m12:17:25.704021 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.814 seconds
[0m12:17:25.704021 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32e74ea8-96c9-4fea-a954-b2267e5e872e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF91F09400>]}
[0m12:17:25.719641 [info ] [Thread-1 (]: 9 of 11 OK created sql table model DEV.dim_movies .............................. [[32mSUCCESS 1[0m in 1.83s]
[0m12:17:25.719641 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.dim_movies
[0m12:17:25.721941 [debug] [Thread-1 (]: Began running node model.Slip_Tests.fct_ratings
[0m12:17:25.721941 [info ] [Thread-1 (]: 10 of 11 START sql incremental model DEV.fct_ratings ........................... [RUN]
[0m12:17:25.721941 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Slip_Tests.dim_movies, now model.Slip_Tests.fct_ratings)
[0m12:17:25.721941 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.fct_ratings
[0m12:17:25.739147 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.fct_ratings"
[0m12:17:25.744956 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.fct_ratings
[0m12:17:25.811383 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m12:17:25.811383 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
create or replace  temporary view MOVIELENS.DEV.fct_ratings__dbt_tmp
  
   as (
    

WITH src_ratings AS (
    SELECT * FROM MOVIELENS.DEV.src_ratings
)

SELECT
    user_id,
    movie_id,
    rating,
    rating_timestamp
FROM src_ratings
WHERE rating IS NOT NULL

    AND rating_timestamp > (
        SELECT MAX(rating_timestamp) FROM MOVIELENS.DEV.fct_ratings
    )

  );
[0m12:17:26.534123 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.713 seconds
[0m12:17:26.549869 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m12:17:26.549869 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
describe table MOVIELENS.DEV.fct_ratings__dbt_tmp
[0m12:17:26.771713 [debug] [Thread-1 (]: SQL status: SUCCESS 4 in 0.229 seconds
[0m12:17:26.771713 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m12:17:26.787310 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
describe table MOVIELENS.DEV.fct_ratings
[0m12:17:27.035131 [debug] [Thread-1 (]: SQL status: SUCCESS 4 in 0.255 seconds
[0m12:17:27.067975 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m12:17:27.067975 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
describe table MOVIELENS.DEV.fct_ratings__dbt_tmp
[0m12:17:27.309777 [debug] [Thread-1 (]: SQL status: SUCCESS 4 in 0.236 seconds
[0m12:17:27.318796 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m12:17:27.318796 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
describe table "MOVIELENS"."DEV"."FCT_RATINGS"
[0m12:17:27.599653 [debug] [Thread-1 (]: SQL status: SUCCESS 4 in 0.278 seconds
[0m12:17:27.619356 [debug] [Thread-1 (]: 
    In "MOVIELENS"."DEV"."FCT_RATINGS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m12:17:27.645548 [debug] [Thread-1 (]: Writing runtime sql for node "model.Slip_Tests.fct_ratings"
[0m12:17:27.661333 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m12:17:27.661333 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
-- back compat for old kwarg name
  
  begin;
[0m12:17:28.066037 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.402 seconds
[0m12:17:28.066037 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m12:17:28.069466 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
insert into MOVIELENS.DEV.fct_ratings ("USER_ID", "MOVIE_ID", "RATING", "RATING_TIMESTAMP")
        (
            select "USER_ID", "MOVIE_ID", "RATING", "RATING_TIMESTAMP"
            from MOVIELENS.DEV.fct_ratings__dbt_tmp
        );
[0m12:17:28.997980 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.941 seconds
[0m12:17:29.013095 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m12:17:29.014680 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
COMMIT
[0m12:17:29.307344 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.307 seconds
[0m12:17:29.339568 [debug] [Thread-1 (]: Applying DROP to: MOVIELENS.DEV.fct_ratings__dbt_tmp
[0m12:17:29.356972 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m12:17:29.356972 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
drop view if exists MOVIELENS.DEV.fct_ratings__dbt_tmp cascade
[0m12:17:29.636027 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.275 seconds
[0m12:17:29.643848 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32e74ea8-96c9-4fea-a954-b2267e5e872e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF93022210>]}
[0m12:17:29.644360 [info ] [Thread-1 (]: 10 of 11 OK created sql incremental model DEV.fct_ratings ...................... [[32mSUCCESS 0[0m in 3.92s]
[0m12:17:29.644360 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.fct_ratings
[0m12:17:29.644360 [debug] [Thread-1 (]: Began running node model.Slip_Tests.dim_user
[0m12:17:29.644360 [info ] [Thread-1 (]: 11 of 11 START sql table model DEV.dim_user .................................... [RUN]
[0m12:17:29.655073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Slip_Tests.fct_ratings, now model.Slip_Tests.dim_user)
[0m12:17:29.655600 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.dim_user
[0m12:17:29.660181 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.dim_user"
[0m12:17:29.660181 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.dim_user
[0m12:17:29.674427 [debug] [Thread-1 (]: Writing runtime sql for node "model.Slip_Tests.dim_user"
[0m12:17:29.677442 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.dim_user"
[0m12:17:29.677442 [debug] [Thread-1 (]: On model.Slip_Tests.dim_user: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.dim_user"} */
create or replace transient table MOVIELENS.DEV.dim_user
    

    
    as (WITH ratings AS (
    SELECT DISTINCT user_id FROM MOVIELENS.DEV.src_ratings
),

tags AS (
    SELECT DISTINCT user_id FROM MOVIELENS.DEV.src_tags
)

SELECT DISTINCT user_id
FROM (
    SELECT * FROM ratings
    UNION
    SELECT * FROM tags
)
    )
;
[0m12:17:31.136472 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.459 seconds
[0m12:17:31.136472 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32e74ea8-96c9-4fea-a954-b2267e5e872e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF9305B080>]}
[0m12:17:31.144088 [info ] [Thread-1 (]: 11 of 11 OK created sql table model DEV.dim_user ............................... [[32mSUCCESS 1[0m in 1.48s]
[0m12:17:31.144088 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.dim_user
[0m12:17:31.144088 [debug] [Thread-1 (]: Began running node model.Slip_Tests.dim_movies_with_tags
[0m12:17:31.144088 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Slip_Tests.dim_user, now model.Slip_Tests.dim_movies_with_tags)
[0m12:17:31.144088 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.dim_movies_with_tags
[0m12:17:31.291720 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.dim_movies_with_tags"
[0m12:17:31.291720 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.dim_movies_with_tags
[0m12:17:31.301399 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:17:31.301399 [debug] [MainThread]: Connection 'list_MOVIELENS' was left open.
[0m12:17:31.301399 [debug] [MainThread]: On list_MOVIELENS: Close
[0m12:17:31.676556 [debug] [MainThread]: Connection 'list_MOVIELENS_DEV' was left open.
[0m12:17:31.677829 [debug] [MainThread]: On list_MOVIELENS_DEV: Close
[0m12:17:32.051376 [debug] [MainThread]: Connection 'model.Slip_Tests.dim_movies_with_tags' was left open.
[0m12:17:32.051376 [debug] [MainThread]: On model.Slip_Tests.dim_movies_with_tags: Close
[0m12:17:32.468058 [info ] [MainThread]: 
[0m12:17:32.468058 [info ] [MainThread]: Finished running 1 incremental model, 6 table models, 4 view models in 0 hours 0 minutes and 32.28 seconds (32.28s).
[0m12:17:32.468058 [debug] [MainThread]: Command end result
[0m12:17:32.541566 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m12:17:32.551044 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m12:17:32.566314 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\dbt_workspace\Slip_Tests\target\run_results.json
[0m12:17:32.566314 [info ] [MainThread]: 
[0m12:17:32.574421 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:17:32.574421 [info ] [MainThread]: 
[0m12:17:32.574421 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=11
[0m12:17:32.574421 [debug] [MainThread]: Command `dbt run` succeeded at 12:17:32.574421 after 37.17 seconds
[0m12:17:32.574421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF8E39E360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF8E39C7A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF919DC290>]}
[0m12:17:32.574421 [debug] [MainThread]: Flushing usage events
[0m12:17:33.900520 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:18:54.577332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A975D9280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A978DD850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A99CC1820>]}


============================== 12:18:54.585733 | 86054916-0d50-4ab2-8747-6b6a2772c5cf ==============================
[0m12:18:54.585733 [info ] [MainThread]: Running with dbt=1.10.1
[0m12:18:54.594162 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ThembaniFaleni\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\dbt_workspace\\Slip_Tests\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m12:18:56.183915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86054916-0d50-4ab2-8747-6b6a2772c5cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A9C78AF90>]}
[0m12:18:56.382236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86054916-0d50-4ab2-8747-6b6a2772c5cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A9A4517F0>]}
[0m12:18:56.382236 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m12:18:56.788206 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m12:18:57.141931 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:18:57.141931 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:18:57.276728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86054916-0d50-4ab2-8747-6b6a2772c5cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A9C7635F0>]}
[0m12:18:57.525306 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m12:18:57.592946 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m12:18:57.641765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86054916-0d50-4ab2-8747-6b6a2772c5cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A9C8B85F0>]}
[0m12:18:57.641765 [info ] [MainThread]: Found 12 models, 12 data tests, 1 snapshot, 6 sources, 592 macros
[0m12:18:57.641765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86054916-0d50-4ab2-8747-6b6a2772c5cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A9CA5F080>]}
[0m12:18:57.641765 [info ] [MainThread]: 
[0m12:18:57.656955 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:18:57.656955 [info ] [MainThread]: 
[0m12:18:57.661187 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:18:57.661187 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MOVIELENS'
[0m12:18:57.814075 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS"
[0m12:18:57.815380 [debug] [ThreadPool]: On list_MOVIELENS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS"} */
show terse schemas in database MOVIELENS
    limit 10000
[0m12:18:57.815888 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:18:59.357553 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.546 seconds
[0m12:18:59.396467 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MOVIELENS_snapshots'
[0m12:18:59.422127 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m12:18:59.422127 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
alter session set quoted_identifiers_ignore_case = false;
[0m12:18:59.422127 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:19:00.566203 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.149 seconds
[0m12:19:00.584033 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m12:19:00.584033 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
show objects in MOVIELENS.snapshots
    limit 10000
    
;
[0m12:19:00.850213 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.265 seconds
[0m12:19:00.850213 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m12:19:00.850213 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
alter session unset quoted_identifiers_ignore_case;
[0m12:19:01.114026 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.259 seconds
[0m12:19:01.114026 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MOVIELENS_snapshots, now list_MOVIELENS_DEV)
[0m12:19:01.114026 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m12:19:01.114026 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session set quoted_identifiers_ignore_case = false;
[0m12:19:01.349039 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.234 seconds
[0m12:19:01.349039 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m12:19:01.349039 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
show objects in MOVIELENS.DEV
    limit 10000
    
;
[0m12:19:01.758626 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.402 seconds
[0m12:19:01.758626 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m12:19:01.758626 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session unset quoted_identifiers_ignore_case;
[0m12:19:02.051015 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.279 seconds
[0m12:19:02.051015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86054916-0d50-4ab2-8747-6b6a2772c5cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A99D386E0>]}
[0m12:19:02.066628 [debug] [Thread-1 (]: Began running node snapshot.Slip_Tests.snap_tags
[0m12:19:02.066628 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.snap_tags ...................................... [RUN]
[0m12:19:02.066628 [debug] [Thread-1 (]: Acquiring new snowflake connection 'snapshot.Slip_Tests.snap_tags'
[0m12:19:02.066628 [debug] [Thread-1 (]: Began compiling node snapshot.Slip_Tests.snap_tags
[0m12:19:02.125128 [debug] [Thread-1 (]: Began executing node snapshot.Slip_Tests.snap_tags
[0m12:19:02.246382 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m12:19:02.246382 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
[0m12:19:02.246382 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:19:03.545286 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 1.308 seconds
[0m12:19:03.684920 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m12:19:03.684920 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
create or replace temporary table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS__dbt_tmp"
as (
    
    
    with snapshot_query as (

        





SELECT
    md5(cast(coalesce(cast(user_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(movie_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS id,
    user_id,
    movie_id,
    tag,
    -- TO_TIMESTAMP_NTZ(tag_timestamp) as tag_timestamp,
    CONVERT_TIMEZONE('UTC', 'Africa/Johannesburg', TO_TIMESTAMP_NTZ(timestamp)) AS tag_timestamp
FROM MOVIELENS.DEV.src_tags
-- LIMIT 100


    ),

    snapshotted_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    

        from "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    
,
            tag_timestamp as dbt_updated_at,
            tag_timestamp as dbt_valid_from,
            
  
  coalesce(nullif(tag_timestamp, tag_timestamp), null)
  as dbt_valid_to
,
            md5(coalesce(cast(user_id as varchar ), '')
         || '|' || coalesce(cast(movie_id as varchar ), '')
         || '|' || coalesce(cast(tag as varchar ), '')
         || '|' || coalesce(cast(tag_timestamp as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    
,
            tag_timestamp as dbt_updated_at,
            tag_timestamp as dbt_valid_from,
            tag_timestamp as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

            where 
    
        snapshotted_data.dbt_unique_key_1 is null
    

            or (
    
        snapshotted_data.dbt_unique_key_1 is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.tag_timestamp)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.tag_timestamp)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

            where 
    
        source_data.dbt_unique_key_1 is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    )
;
[0m12:19:04.289651 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bd21ab-0106-cbdf-0002-c72a00053142
[0m12:19:04.289651 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 19 at position 68
invalid identifier 'TIMESTAMP'
[0m12:19:04.310357 [debug] [Thread-1 (]: Database Error in snapshot snap_tags (snapshots\snap_tag.sql)
  000904 (42000): SQL compilation error: error line 19 at position 68
  invalid identifier 'TIMESTAMP'
[0m12:19:04.310357 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86054916-0d50-4ab2-8747-6b6a2772c5cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A9D2978C0>]}
[0m12:19:04.321510 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshots.snap_tags .................................. [[31mERROR[0m in 2.24s]
[0m12:19:04.322280 [debug] [Thread-1 (]: Finished running node snapshot.Slip_Tests.snap_tags
[0m12:19:04.322280 [debug] [Thread-4 (]: Marking all children of 'snapshot.Slip_Tests.snap_tags' to be skipped because of status 'error'.  Reason: Database Error in snapshot snap_tags (snapshots\snap_tag.sql)
  000904 (42000): SQL compilation error: error line 19 at position 68
  invalid identifier 'TIMESTAMP'.
[0m12:19:04.328809 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:19:04.328809 [debug] [MainThread]: Connection 'list_MOVIELENS' was left open.
[0m12:19:04.328809 [debug] [MainThread]: On list_MOVIELENS: Close
[0m12:19:04.711210 [debug] [MainThread]: Connection 'list_MOVIELENS_DEV' was left open.
[0m12:19:04.711210 [debug] [MainThread]: On list_MOVIELENS_DEV: Close
[0m12:19:05.148501 [debug] [MainThread]: Connection 'snapshot.Slip_Tests.snap_tags' was left open.
[0m12:19:05.148501 [debug] [MainThread]: On snapshot.Slip_Tests.snap_tags: Close
[0m12:19:05.541487 [info ] [MainThread]: 
[0m12:19:05.541487 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 7.88 seconds (7.88s).
[0m12:19:05.541487 [debug] [MainThread]: Command end result
[0m12:19:05.607378 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m12:19:05.607378 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m12:19:05.624580 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\dbt_workspace\Slip_Tests\target\run_results.json
[0m12:19:05.624580 [info ] [MainThread]: 
[0m12:19:05.624580 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:19:05.635605 [info ] [MainThread]: 
[0m12:19:05.637244 [error] [MainThread]: [31mFailure in snapshot snap_tags (snapshots\snap_tag.sql)[0m
[0m12:19:05.642450 [error] [MainThread]:   Database Error in snapshot snap_tags (snapshots\snap_tag.sql)
  000904 (42000): SQL compilation error: error line 19 at position 68
  invalid identifier 'TIMESTAMP'
[0m12:19:05.643971 [info ] [MainThread]: 
[0m12:19:05.643971 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:19:05.647098 [debug] [MainThread]: Command `dbt snapshot` failed at 12:19:05.647098 after 11.42 seconds
[0m12:19:05.647098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A9971FB60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A9971DC40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A99F451F0>]}
[0m12:19:05.647098 [debug] [MainThread]: Flushing usage events
[0m12:19:06.689488 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:20:01.841728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277198D6420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027716FC91C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027719313FB0>]}


============================== 12:20:01.847756 | 3029c851-8e54-41e8-b8ec-a8634a622e1b ==============================
[0m12:20:01.847756 [info ] [MainThread]: Running with dbt=1.10.1
[0m12:20:01.847756 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\dbt_workspace\\Slip_Tests\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\ThembaniFaleni\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m12:20:03.283790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3029c851-8e54-41e8-b8ec-a8634a622e1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002771C096870>]}
[0m12:20:03.600670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3029c851-8e54-41e8-b8ec-a8634a622e1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027719451370>]}
[0m12:20:03.600670 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m12:20:03.981355 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m12:20:04.337421 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:20:04.337421 [debug] [MainThread]: Partial parsing: updated file: Slip_Tests://snapshots\snap_tag.sql
[0m12:20:05.702659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3029c851-8e54-41e8-b8ec-a8634a622e1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002771C708110>]}
[0m12:20:05.860026 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m12:20:05.883183 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m12:20:05.915314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3029c851-8e54-41e8-b8ec-a8634a622e1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002771C8E60C0>]}
[0m12:20:05.915314 [info ] [MainThread]: Found 12 models, 12 data tests, 1 snapshot, 6 sources, 592 macros
[0m12:20:05.915314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3029c851-8e54-41e8-b8ec-a8634a622e1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277193C9430>]}
[0m12:20:05.925681 [info ] [MainThread]: 
[0m12:20:05.925681 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:20:05.929490 [info ] [MainThread]: 
[0m12:20:05.929896 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:20:05.931431 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MOVIELENS'
[0m12:20:06.077021 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS"
[0m12:20:06.077021 [debug] [ThreadPool]: On list_MOVIELENS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS"} */
show terse schemas in database MOVIELENS
    limit 10000
[0m12:20:06.077021 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:20:07.625051 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.557 seconds
[0m12:20:07.639661 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MOVIELENS_DEV'
[0m12:20:07.662841 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m12:20:07.671355 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session set quoted_identifiers_ignore_case = false;
[0m12:20:07.671355 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:20:08.967287 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.299 seconds
[0m12:20:08.967287 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m12:20:08.967287 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
show objects in MOVIELENS.DEV
    limit 10000
    
;
[0m12:20:09.281947 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.305 seconds
[0m12:20:09.281947 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m12:20:09.290557 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session unset quoted_identifiers_ignore_case;
[0m12:20:09.547493 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.257 seconds
[0m12:20:09.547493 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MOVIELENS_DEV, now list_MOVIELENS_snapshots)
[0m12:20:09.547493 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m12:20:09.547493 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
alter session set quoted_identifiers_ignore_case = false;
[0m12:20:09.791305 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.235 seconds
[0m12:20:09.803069 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m12:20:09.862186 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
show objects in MOVIELENS.snapshots
    limit 10000
    
;
[0m12:20:10.127598 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.275 seconds
[0m12:20:10.127598 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m12:20:10.143237 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
alter session unset quoted_identifiers_ignore_case;
[0m12:20:10.379605 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.235 seconds
[0m12:20:10.379605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3029c851-8e54-41e8-b8ec-a8634a622e1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027717167740>]}
[0m12:20:10.392222 [debug] [Thread-1 (]: Began running node snapshot.Slip_Tests.snap_tags
[0m12:20:10.392222 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.snap_tags ...................................... [RUN]
[0m12:20:10.396634 [debug] [Thread-1 (]: Acquiring new snowflake connection 'snapshot.Slip_Tests.snap_tags'
[0m12:20:10.396634 [debug] [Thread-1 (]: Began compiling node snapshot.Slip_Tests.snap_tags
[0m12:20:10.413474 [debug] [Thread-1 (]: Began executing node snapshot.Slip_Tests.snap_tags
[0m12:20:10.525824 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m12:20:10.525824 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
[0m12:20:10.525824 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:20:11.929235 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 1.412 seconds
[0m12:20:12.054846 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m12:20:12.054846 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
create or replace temporary table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS__dbt_tmp"
as (
    
    
    with snapshot_query as (

        





SELECT
    md5(cast(coalesce(cast(user_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(movie_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS id,
    user_id,
    movie_id,
    tag,
    -- TO_TIMESTAMP_NTZ(tag_timestamp) as tag_timestamp,
    CONVERT_TIMEZONE('UTC', 'Africa/Johannesburg', TO_TIMESTAMP_NTZ(tag_timestamp)) AS tag_timestamp
FROM MOVIELENS.DEV.src_tags
-- LIMIT 100


    ),

    snapshotted_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    

        from "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    
,
            tag_timestamp as dbt_updated_at,
            tag_timestamp as dbt_valid_from,
            
  
  coalesce(nullif(tag_timestamp, tag_timestamp), null)
  as dbt_valid_to
,
            md5(coalesce(cast(user_id as varchar ), '')
         || '|' || coalesce(cast(movie_id as varchar ), '')
         || '|' || coalesce(cast(tag as varchar ), '')
         || '|' || coalesce(cast(tag_timestamp as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    
,
            tag_timestamp as dbt_updated_at,
            tag_timestamp as dbt_valid_from,
            tag_timestamp as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

            where 
    
        snapshotted_data.dbt_unique_key_1 is null
    

            or (
    
        snapshotted_data.dbt_unique_key_1 is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.tag_timestamp)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.tag_timestamp)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

            where 
    
        source_data.dbt_unique_key_1 is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    )
;
[0m12:20:17.407858 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 5.341 seconds
[0m12:20:17.415375 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m12:20:17.415375 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS__dbt_tmp"
[0m12:20:17.653436 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.238 seconds
[0m12:20:17.653436 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m12:20:17.653436 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
[0m12:20:18.050409 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.386 seconds
[0m12:20:18.050409 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m12:20:18.050409 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS__dbt_tmp"
[0m12:20:18.302071 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.239 seconds
[0m12:20:18.309586 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m12:20:18.309586 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
[0m12:20:18.512499 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.203 seconds
[0m12:20:18.528232 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m12:20:18.528232 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS__dbt_tmp"
[0m12:20:18.766387 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.233 seconds
[0m12:20:18.813583 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m12:20:18.813583 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
/* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
select * from (
        
    
    with snapshot_query as (

        





SELECT
    md5(cast(coalesce(cast(user_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(movie_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS id,
    user_id,
    movie_id,
    tag,
    -- TO_TIMESTAMP_NTZ(tag_timestamp) as tag_timestamp,
    CONVERT_TIMEZONE('UTC', 'Africa/Johannesburg', TO_TIMESTAMP_NTZ(tag_timestamp)) AS tag_timestamp
FROM MOVIELENS.DEV.src_tags
-- LIMIT 100


    ),

    snapshotted_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    

        from "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    
,
            tag_timestamp as dbt_updated_at,
            tag_timestamp as dbt_valid_from,
            
  
  coalesce(nullif(tag_timestamp, tag_timestamp), null)
  as dbt_valid_to
,
            md5(coalesce(cast(user_id as varchar ), '')
         || '|' || coalesce(cast(movie_id as varchar ), '')
         || '|' || coalesce(cast(tag as varchar ), '')
         || '|' || coalesce(cast(tag_timestamp as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    
,
            tag_timestamp as dbt_updated_at,
            tag_timestamp as dbt_valid_from,
            tag_timestamp as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

            where 
    
        snapshotted_data.dbt_unique_key_1 is null
    

            or (
    
        snapshotted_data.dbt_unique_key_1 is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.tag_timestamp)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.tag_timestamp)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

            where 
    
        source_data.dbt_unique_key_1 is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m12:20:19.330584 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.511 seconds
[0m12:20:19.330584 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m12:20:19.330584 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
/* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m12:20:19.546479 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.209 seconds
[0m12:20:19.546479 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.Slip_Tests.snap_tags"
[0m12:20:19.546479 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m12:20:19.546479 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
BEGIN
[0m12:20:19.816318 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.268 seconds
[0m12:20:19.816318 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m12:20:19.816318 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
merge into "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS" as DBT_INTERNAL_DEST
    using "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("ID", "USER_ID", "MOVIE_ID", "TAG", "TAG_TIMESTAMP", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("ID", "USER_ID", "MOVIE_ID", "TAG", "TAG_TIMESTAMP", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m12:20:24.092715 [debug] [Thread-1 (]: SQL status: SUCCESS 931122 in 4.261 seconds
[0m12:20:24.093306 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m12:20:24.093306 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
COMMIT
[0m12:20:24.704941 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.614 seconds
[0m12:20:24.752257 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3029c851-8e54-41e8-b8ec-a8634a622e1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277170B9130>]}
[0m12:20:24.752257 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.snap_tags ...................................... [[32mSUCCESS 931122[0m in 14.34s]
[0m12:20:24.752257 [debug] [Thread-1 (]: Finished running node snapshot.Slip_Tests.snap_tags
[0m12:20:24.752257 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:20:24.752257 [debug] [MainThread]: Connection 'list_MOVIELENS' was left open.
[0m12:20:24.752257 [debug] [MainThread]: On list_MOVIELENS: Close
[0m12:20:25.157850 [debug] [MainThread]: Connection 'list_MOVIELENS_snapshots' was left open.
[0m12:20:25.157850 [debug] [MainThread]: On list_MOVIELENS_snapshots: Close
[0m12:20:25.628479 [debug] [MainThread]: Connection 'snapshot.Slip_Tests.snap_tags' was left open.
[0m12:20:25.630686 [debug] [MainThread]: On snapshot.Slip_Tests.snap_tags: Close
[0m12:20:26.321592 [info ] [MainThread]: 
[0m12:20:26.336849 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 20.39 seconds (20.39s).
[0m12:20:26.336849 [debug] [MainThread]: Command end result
[0m12:20:26.396799 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m12:20:26.400634 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m12:20:26.415502 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\dbt_workspace\Slip_Tests\target\run_results.json
[0m12:20:26.415502 [info ] [MainThread]: 
[0m12:20:26.415502 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:20:26.425395 [info ] [MainThread]: 
[0m12:20:26.425395 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:20:26.425395 [debug] [MainThread]: Command `dbt snapshot` succeeded at 12:20:26.425395 after 24.94 seconds
[0m12:20:26.428423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027719D1E0C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277170B9130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277198B86B0>]}
[0m12:20:26.430091 [debug] [MainThread]: Flushing usage events
[0m12:20:27.777929 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:27:08.173539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1D2A6F830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1CECB8CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1D24D6390>]}


============================== 12:27:08.173539 | 59afb487-da75-4f93-b08c-72ffcc7c7559 ==============================
[0m12:27:08.173539 [info ] [MainThread]: Running with dbt=1.10.1
[0m12:27:08.173539 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\ThembaniFaleni\\.dbt', 'log_path': 'C:\\dbt_workspace\\Slip_Tests\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:27:09.286417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '59afb487-da75-4f93-b08c-72ffcc7c7559', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1D4DBB770>]}
[0m12:27:09.510263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '59afb487-da75-4f93-b08c-72ffcc7c7559', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1D4C28800>]}
[0m12:27:09.510263 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m12:27:09.929106 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m12:27:10.163044 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m12:27:10.166056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '59afb487-da75-4f93-b08c-72ffcc7c7559', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1D2738F50>]}
[0m12:27:10.179305 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'tests' in "<unicode string>", line 71, column 5 in file
`models\schema.yml`
[0m12:27:10.182900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '59afb487-da75-4f93-b08c-72ffcc7c7559', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1D52A76B0>]}
[0m12:27:13.351230 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'fct_rating' in the 'models' section of file 'models\schema.yml'
[0m12:27:14.136293 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.Slip_Tests.not_null_fct_rating_user_id.140768c4a8' (models\schema.yml) depends on a node named 'fct_rating' in package '' which was not found
[0m12:27:14.141106 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.Slip_Tests.not_null_fct_rating_movie_id.e7004ba604' (models\schema.yml) depends on a node named 'fct_rating' in package '' which was not found
[0m12:27:14.141106 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.Slip_Tests.not_null_fct_rating_rating.2f45ab1d54' (models\schema.yml) depends on a node named 'fct_rating' in package '' which was not found
[0m12:27:14.141106 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.Slip_Tests.dbt_utils_expression_is_true_fct_rating__select_sum_rating_from_ref_src_ratings_select_sum_rating_from_ref_fct_rating_.f8623932f1' (models\schema.yml) depends on a node named 'fct_rating' in package '' which was not found
[0m12:27:14.144617 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.Slip_Tests.dbt_utils_expression_is_true_fct_rating__select_sum_rating_from_ref_src_ratings_select_sum_rating_from_ref_fct_rating_.f8623932f1' (models\schema.yml) depends on a node named 'fct_rating' in package '' which was not found
[0m12:27:14.416240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '59afb487-da75-4f93-b08c-72ffcc7c7559', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1D4CB6960>]}
[0m12:27:14.565851 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m12:27:14.582176 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m12:27:14.623137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '59afb487-da75-4f93-b08c-72ffcc7c7559', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1D5673C80>]}
[0m12:27:14.623137 [info ] [MainThread]: Found 12 models, 1 snapshot, 12 data tests, 6 sources, 592 macros
[0m12:27:14.626649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59afb487-da75-4f93-b08c-72ffcc7c7559', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1D562A420>]}
[0m12:27:14.629292 [info ] [MainThread]: 
[0m12:27:14.629292 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:27:14.639012 [info ] [MainThread]: 
[0m12:27:14.641047 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:27:14.643793 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MOVIELENS'
[0m12:27:14.770823 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS"
[0m12:27:14.781366 [debug] [ThreadPool]: On list_MOVIELENS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS"} */
show terse schemas in database MOVIELENS
    limit 10000
[0m12:27:14.781366 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:27:16.829727 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.054 seconds
[0m12:27:16.840287 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MOVIELENS_snapshots'
[0m12:27:16.855315 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m12:27:16.855315 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
alter session set quoted_identifiers_ignore_case = false;
[0m12:27:16.855315 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:27:18.179287 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.324 seconds
[0m12:27:18.179287 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m12:27:18.179287 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
show objects in MOVIELENS.snapshots
    limit 10000
    
;
[0m12:27:18.463589 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.282 seconds
[0m12:27:18.463589 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m12:27:18.479209 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
alter session unset quoted_identifiers_ignore_case;
[0m12:27:18.732370 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.252 seconds
[0m12:27:18.732370 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MOVIELENS_snapshots, now list_MOVIELENS_DEV)
[0m12:27:18.735882 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m12:27:18.735882 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session set quoted_identifiers_ignore_case = false;
[0m12:27:19.131693 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.390 seconds
[0m12:27:19.134901 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m12:27:19.134901 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
show objects in MOVIELENS.DEV
    limit 10000
    
;
[0m12:27:19.419812 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.292 seconds
[0m12:27:19.433835 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m12:27:19.435850 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session unset quoted_identifiers_ignore_case;
[0m12:27:19.672158 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.239 seconds
[0m12:27:19.672158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59afb487-da75-4f93-b08c-72ffcc7c7559', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1D560F080>]}
[0m12:27:19.688559 [debug] [Thread-1 (]: Began running node model.Slip_Tests.src_genome_score
[0m12:27:19.689780 [info ] [Thread-1 (]: 1 of 11 START sql view model DEV.src_genome_score .............................. [RUN]
[0m12:27:19.689780 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Slip_Tests.src_genome_score'
[0m12:27:19.696295 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.src_genome_score
[0m12:27:19.706393 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.src_genome_score"
[0m12:27:19.706393 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.src_genome_score
[0m12:27:19.747565 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.src_genome_score"
[0m12:27:19.748610 [debug] [Thread-1 (]: On model.Slip_Tests.src_genome_score: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.src_genome_score"} */
ALTER SESSION SET TIMEZONE = 'Africa/Johannesburg
[0m12:27:19.748610 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:27:20.947598 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bd21b3-0106-cae9-0002-c72a0005615e
[0m12:27:20.947598 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
parse error line 1 at position 49 near '<EOF>'.
syntax error line 1 at position 36 unexpected '/'.
syntax error line 1 at position 36 unexpected '/'.
syntax error line 1 at position 49 unexpected '<EOF>'.
[0m12:27:20.979578 [debug] [Thread-1 (]: Database Error in model src_genome_score (models\staging\src_genome_score.sql)
  001003 (42000): SQL compilation error:
  parse error line 1 at position 49 near '<EOF>'.
  syntax error line 1 at position 36 unexpected '/'.
  syntax error line 1 at position 36 unexpected '/'.
  syntax error line 1 at position 49 unexpected '<EOF>'.
[0m12:27:20.983716 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59afb487-da75-4f93-b08c-72ffcc7c7559', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1D2042030>]}
[0m12:27:20.984769 [error] [Thread-1 (]: 1 of 11 ERROR creating sql view model DEV.src_genome_score ..................... [[31mERROR[0m in 1.29s]
[0m12:27:20.987301 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.src_genome_score
[0m12:27:20.987301 [debug] [Thread-1 (]: Began running node model.Slip_Tests.src_genome_tags
[0m12:27:20.987301 [debug] [Thread-4 (]: Marking all children of 'model.Slip_Tests.src_genome_score' to be skipped because of status 'error'.  Reason: Database Error in model src_genome_score (models\staging\src_genome_score.sql)
  001003 (42000): SQL compilation error:
  parse error line 1 at position 49 near '<EOF>'.
  syntax error line 1 at position 36 unexpected '/'.
  syntax error line 1 at position 36 unexpected '/'.
  syntax error line 1 at position 49 unexpected '<EOF>'..
[0m12:27:20.987301 [info ] [Thread-1 (]: 2 of 11 START sql view model DEV.src_genome_tags ............................... [RUN]
[0m12:27:20.995343 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Slip_Tests.src_genome_score, now model.Slip_Tests.src_genome_tags)
[0m12:27:20.995343 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.src_genome_tags
[0m12:27:21.001464 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.src_genome_tags"
[0m12:27:21.002653 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.src_genome_tags
[0m12:27:21.009786 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.src_genome_tags"
[0m12:27:21.009786 [debug] [Thread-1 (]: On model.Slip_Tests.src_genome_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.src_genome_tags"} */
ALTER SESSION SET TIMEZONE = 'Africa/Johannesburg
[0m12:27:21.237368 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bd21b3-0106-cc4a-0002-c72a0005811a
[0m12:27:21.237368 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
parse error line 1 at position 49 near '<EOF>'.
syntax error line 1 at position 36 unexpected '/'.
syntax error line 1 at position 36 unexpected '/'.
syntax error line 1 at position 49 unexpected '<EOF>'.
[0m12:27:21.237368 [debug] [Thread-1 (]: Database Error in model src_genome_tags (models\staging\src_genome_tags.sql)
  001003 (42000): SQL compilation error:
  parse error line 1 at position 49 near '<EOF>'.
  syntax error line 1 at position 36 unexpected '/'.
  syntax error line 1 at position 36 unexpected '/'.
  syntax error line 1 at position 49 unexpected '<EOF>'.
[0m12:27:21.237368 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59afb487-da75-4f93-b08c-72ffcc7c7559', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1D6CB2720>]}
[0m12:27:21.253036 [error] [Thread-1 (]: 2 of 11 ERROR creating sql view model DEV.src_genome_tags ...................... [[31mERROR[0m in 0.24s]
[0m12:27:21.253036 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.src_genome_tags
[0m12:27:21.253036 [debug] [Thread-1 (]: Began running node model.Slip_Tests.src_links
[0m12:27:21.253036 [debug] [Thread-4 (]: Marking all children of 'model.Slip_Tests.src_genome_tags' to be skipped because of status 'error'.  Reason: Database Error in model src_genome_tags (models\staging\src_genome_tags.sql)
  001003 (42000): SQL compilation error:
  parse error line 1 at position 49 near '<EOF>'.
  syntax error line 1 at position 36 unexpected '/'.
  syntax error line 1 at position 36 unexpected '/'.
  syntax error line 1 at position 49 unexpected '<EOF>'..
[0m12:27:21.253036 [info ] [Thread-1 (]: 3 of 11 START sql view model DEV.src_links ..................................... [RUN]
[0m12:27:21.253036 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Slip_Tests.src_genome_tags, now model.Slip_Tests.src_links)
[0m12:27:21.253036 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.src_links
[0m12:27:21.253036 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.src_links"
[0m12:27:21.253036 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.src_links
[0m12:27:21.270856 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.src_links"
[0m12:27:21.272343 [debug] [Thread-1 (]: On model.Slip_Tests.src_links: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.src_links"} */
ALTER SESSION SET TIMEZONE = 'Africa/Johannesburg
[0m12:27:21.522578 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bd21b3-0106-cbdf-0002-c72a0005315a
[0m12:27:21.522578 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
parse error line 1 at position 49 near '<EOF>'.
syntax error line 1 at position 36 unexpected '/'.
syntax error line 1 at position 36 unexpected '/'.
syntax error line 1 at position 49 unexpected '<EOF>'.
[0m12:27:21.555365 [debug] [Thread-1 (]: Database Error in model src_links (models\staging\src_links.sql)
  001003 (42000): SQL compilation error:
  parse error line 1 at position 49 near '<EOF>'.
  syntax error line 1 at position 36 unexpected '/'.
  syntax error line 1 at position 36 unexpected '/'.
  syntax error line 1 at position 49 unexpected '<EOF>'.
[0m12:27:21.555365 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59afb487-da75-4f93-b08c-72ffcc7c7559', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1D6AF62A0>]}
[0m12:27:21.555365 [error] [Thread-1 (]: 3 of 11 ERROR creating sql view model DEV.src_links ............................ [[31mERROR[0m in 0.30s]
[0m12:27:21.569966 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.src_links
[0m12:27:21.569966 [debug] [Thread-1 (]: Began running node model.Slip_Tests.src_movies
[0m12:27:21.569966 [debug] [Thread-4 (]: Marking all children of 'model.Slip_Tests.src_links' to be skipped because of status 'error'.  Reason: Database Error in model src_links (models\staging\src_links.sql)
  001003 (42000): SQL compilation error:
  parse error line 1 at position 49 near '<EOF>'.
  syntax error line 1 at position 36 unexpected '/'.
  syntax error line 1 at position 36 unexpected '/'.
  syntax error line 1 at position 49 unexpected '<EOF>'..
[0m12:27:21.569966 [info ] [Thread-1 (]: 4 of 11 START sql view model DEV.src_movies .................................... [RUN]
[0m12:27:21.575021 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Slip_Tests.src_links, now model.Slip_Tests.src_movies)
[0m12:27:21.575021 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.src_movies
[0m12:27:21.579873 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.src_movies"
[0m12:27:21.582450 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.src_movies
[0m12:27:21.588793 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.src_movies"
[0m12:27:21.590584 [debug] [Thread-1 (]: On model.Slip_Tests.src_movies: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.src_movies"} */
ALTER SESSION SET TIMEZONE = 'Africa/Johannesburg
[0m12:27:21.827621 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bd21b3-0106-ca6f-0002-c72a00051186
[0m12:27:21.827621 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
parse error line 1 at position 49 near '<EOF>'.
syntax error line 1 at position 36 unexpected '/'.
syntax error line 1 at position 36 unexpected '/'.
syntax error line 1 at position 49 unexpected '<EOF>'.
[0m12:27:21.838697 [debug] [Thread-1 (]: Database Error in model src_movies (models\staging\src_movies.sql)
  001003 (42000): SQL compilation error:
  parse error line 1 at position 49 near '<EOF>'.
  syntax error line 1 at position 36 unexpected '/'.
  syntax error line 1 at position 36 unexpected '/'.
  syntax error line 1 at position 49 unexpected '<EOF>'.
[0m12:27:21.838697 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59afb487-da75-4f93-b08c-72ffcc7c7559', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1D5433AD0>]}
[0m12:27:21.838697 [error] [Thread-1 (]: 4 of 11 ERROR creating sql view model DEV.src_movies ........................... [[31mERROR[0m in 0.26s]
[0m12:27:21.838697 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.src_movies
[0m12:27:21.851711 [debug] [Thread-1 (]: Began running node model.Slip_Tests.src_ratings
[0m12:27:21.851711 [debug] [Thread-4 (]: Marking all children of 'model.Slip_Tests.src_movies' to be skipped because of status 'error'.  Reason: Database Error in model src_movies (models\staging\src_movies.sql)
  001003 (42000): SQL compilation error:
  parse error line 1 at position 49 near '<EOF>'.
  syntax error line 1 at position 36 unexpected '/'.
  syntax error line 1 at position 36 unexpected '/'.
  syntax error line 1 at position 49 unexpected '<EOF>'..
[0m12:27:21.851711 [info ] [Thread-1 (]: 5 of 11 START sql table model DEV.src_ratings .................................. [RUN]
[0m12:27:21.851711 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Slip_Tests.src_movies, now model.Slip_Tests.src_ratings)
[0m12:27:21.851711 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.src_ratings
[0m12:27:21.851711 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.src_ratings"
[0m12:27:21.851711 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.src_ratings
[0m12:27:21.877176 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.src_ratings"
[0m12:27:21.877176 [debug] [Thread-1 (]: On model.Slip_Tests.src_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.src_ratings"} */
ALTER SESSION SET TIMEZONE = 'Africa/Johannesburg
[0m12:27:22.098678 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bd21b3-0106-ca7a-0002-c72a0005017e
[0m12:27:22.098678 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
parse error line 1 at position 49 near '<EOF>'.
syntax error line 1 at position 36 unexpected '/'.
syntax error line 1 at position 36 unexpected '/'.
syntax error line 1 at position 49 unexpected '<EOF>'.
[0m12:27:22.118815 [debug] [Thread-1 (]: Database Error in model src_ratings (models\staging\src_ratings.sql)
  001003 (42000): SQL compilation error:
  parse error line 1 at position 49 near '<EOF>'.
  syntax error line 1 at position 36 unexpected '/'.
  syntax error line 1 at position 36 unexpected '/'.
  syntax error line 1 at position 49 unexpected '<EOF>'.
[0m12:27:22.123651 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59afb487-da75-4f93-b08c-72ffcc7c7559', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1D6AF7080>]}
[0m12:27:22.125336 [error] [Thread-1 (]: 5 of 11 ERROR creating sql table model DEV.src_ratings ......................... [[31mERROR[0m in 0.27s]
[0m12:27:22.126812 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.src_ratings
[0m12:27:22.126812 [debug] [Thread-1 (]: Began running node model.Slip_Tests.src_tags
[0m12:27:22.128318 [debug] [Thread-4 (]: Marking all children of 'model.Slip_Tests.src_ratings' to be skipped because of status 'error'.  Reason: Database Error in model src_ratings (models\staging\src_ratings.sql)
  001003 (42000): SQL compilation error:
  parse error line 1 at position 49 near '<EOF>'.
  syntax error line 1 at position 36 unexpected '/'.
  syntax error line 1 at position 36 unexpected '/'.
  syntax error line 1 at position 49 unexpected '<EOF>'..
[0m12:27:22.129100 [info ] [Thread-1 (]: 6 of 11 START sql table model DEV.src_tags ..................................... [RUN]
[0m12:27:22.131118 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Slip_Tests.src_ratings, now model.Slip_Tests.src_tags)
[0m12:27:22.131632 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.src_tags
[0m12:27:22.136933 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.src_tags"
[0m12:27:22.138577 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.src_tags
[0m12:27:22.141412 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.src_tags"
[0m12:27:22.141412 [debug] [Thread-1 (]: On model.Slip_Tests.src_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.src_tags"} */
ALTER SESSION SET TIMEZONE = 'Africa/Johannesburg
[0m12:27:22.511145 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bd21b3-0106-cc06-0002-c72a000541be
[0m12:27:22.511145 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
parse error line 1 at position 49 near '<EOF>'.
syntax error line 1 at position 36 unexpected '/'.
syntax error line 1 at position 36 unexpected '/'.
syntax error line 1 at position 49 unexpected '<EOF>'.
[0m12:27:22.528365 [debug] [Thread-1 (]: Database Error in model src_tags (models\staging\src_tags.sql)
  001003 (42000): SQL compilation error:
  parse error line 1 at position 49 near '<EOF>'.
  syntax error line 1 at position 36 unexpected '/'.
  syntax error line 1 at position 36 unexpected '/'.
  syntax error line 1 at position 49 unexpected '<EOF>'.
[0m12:27:22.528365 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59afb487-da75-4f93-b08c-72ffcc7c7559', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1D6CAD670>]}
[0m12:27:22.528365 [error] [Thread-1 (]: 6 of 11 ERROR creating sql table model DEV.src_tags ............................ [[31mERROR[0m in 0.40s]
[0m12:27:22.528365 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.src_tags
[0m12:27:22.528365 [debug] [Thread-1 (]: Began running node model.Slip_Tests.fct_genome_score
[0m12:27:22.528365 [debug] [Thread-4 (]: Marking all children of 'model.Slip_Tests.src_tags' to be skipped because of status 'error'.  Reason: Database Error in model src_tags (models\staging\src_tags.sql)
  001003 (42000): SQL compilation error:
  parse error line 1 at position 49 near '<EOF>'.
  syntax error line 1 at position 36 unexpected '/'.
  syntax error line 1 at position 36 unexpected '/'.
  syntax error line 1 at position 49 unexpected '<EOF>'..
[0m12:27:22.528365 [info ] [Thread-1 (]: 7 of 11 SKIP relation DEV.fct_genome_score ..................................... [[33mSKIP[0m]
[0m12:27:22.528365 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.fct_genome_score
[0m12:27:22.528365 [debug] [Thread-1 (]: Began running node model.Slip_Tests.dim_genome_tags
[0m12:27:22.528365 [info ] [Thread-1 (]: 8 of 11 SKIP relation DEV.dim_genome_tags ...................................... [[33mSKIP[0m]
[0m12:27:22.539374 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.dim_genome_tags
[0m12:27:22.540847 [debug] [Thread-1 (]: Began running node model.Slip_Tests.dim_movies
[0m12:27:22.540847 [info ] [Thread-1 (]: 9 of 11 SKIP relation DEV.dim_movies ........................................... [[33mSKIP[0m]
[0m12:27:22.540847 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.dim_movies
[0m12:27:22.543758 [debug] [Thread-1 (]: Began running node model.Slip_Tests.fct_ratings
[0m12:27:22.544491 [info ] [Thread-1 (]: 10 of 11 SKIP relation DEV.fct_ratings ......................................... [[33mSKIP[0m]
[0m12:27:22.546114 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.fct_ratings
[0m12:27:22.547920 [debug] [Thread-1 (]: Began running node model.Slip_Tests.dim_user
[0m12:27:22.548603 [info ] [Thread-1 (]: 11 of 11 SKIP relation DEV.dim_user ............................................ [[33mSKIP[0m]
[0m12:27:22.548603 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.dim_user
[0m12:27:22.548603 [debug] [Thread-1 (]: Began running node model.Slip_Tests.dim_movies_with_tags
[0m12:27:22.548603 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.dim_movies_with_tags
[0m12:27:22.548603 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:27:22.548603 [debug] [MainThread]: Connection 'list_MOVIELENS' was left open.
[0m12:27:22.548603 [debug] [MainThread]: On list_MOVIELENS: Close
[0m12:27:22.999273 [debug] [MainThread]: Connection 'list_MOVIELENS_DEV' was left open.
[0m12:27:22.999273 [debug] [MainThread]: On list_MOVIELENS_DEV: Close
[0m12:27:23.377972 [debug] [MainThread]: Connection 'model.Slip_Tests.src_tags' was left open.
[0m12:27:23.377972 [debug] [MainThread]: On model.Slip_Tests.src_tags: Close
[0m12:27:23.743682 [info ] [MainThread]: 
[0m12:27:23.743682 [info ] [MainThread]: Finished running 1 incremental model, 6 table models, 4 view models in 0 hours 0 minutes and 9.10 seconds (9.10s).
[0m12:27:23.743682 [debug] [MainThread]: Command end result
[0m12:27:23.805936 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m12:27:23.805936 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m12:27:23.828543 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\dbt_workspace\Slip_Tests\target\run_results.json
[0m12:27:23.828543 [info ] [MainThread]: 
[0m12:27:23.828543 [info ] [MainThread]: [31mCompleted with 6 errors, 0 partial successes, and 0 warnings:[0m
[0m12:27:23.828543 [info ] [MainThread]: 
[0m12:27:23.828543 [error] [MainThread]: [31mFailure in model src_genome_score (models\staging\src_genome_score.sql)[0m
[0m12:27:23.828543 [error] [MainThread]:   Database Error in model src_genome_score (models\staging\src_genome_score.sql)
  001003 (42000): SQL compilation error:
  parse error line 1 at position 49 near '<EOF>'.
  syntax error line 1 at position 36 unexpected '/'.
  syntax error line 1 at position 36 unexpected '/'.
  syntax error line 1 at position 49 unexpected '<EOF>'.
[0m12:27:23.828543 [info ] [MainThread]: 
[0m12:27:23.828543 [info ] [MainThread]:   compiled code at target\compiled\Slip_Tests\models\staging\src_genome_score.sql
[0m12:27:23.828543 [info ] [MainThread]: 
[0m12:27:23.836555 [error] [MainThread]: [31mFailure in model src_genome_tags (models\staging\src_genome_tags.sql)[0m
[0m12:27:23.836555 [error] [MainThread]:   Database Error in model src_genome_tags (models\staging\src_genome_tags.sql)
  001003 (42000): SQL compilation error:
  parse error line 1 at position 49 near '<EOF>'.
  syntax error line 1 at position 36 unexpected '/'.
  syntax error line 1 at position 36 unexpected '/'.
  syntax error line 1 at position 49 unexpected '<EOF>'.
[0m12:27:23.839726 [info ] [MainThread]: 
[0m12:27:23.841529 [info ] [MainThread]:   compiled code at target\compiled\Slip_Tests\models\staging\src_genome_tags.sql
[0m12:27:23.843983 [info ] [MainThread]: 
[0m12:27:23.845004 [error] [MainThread]: [31mFailure in model src_links (models\staging\src_links.sql)[0m
[0m12:27:23.845004 [error] [MainThread]:   Database Error in model src_links (models\staging\src_links.sql)
  001003 (42000): SQL compilation error:
  parse error line 1 at position 49 near '<EOF>'.
  syntax error line 1 at position 36 unexpected '/'.
  syntax error line 1 at position 36 unexpected '/'.
  syntax error line 1 at position 49 unexpected '<EOF>'.
[0m12:27:23.845004 [info ] [MainThread]: 
[0m12:27:23.845004 [info ] [MainThread]:   compiled code at target\compiled\Slip_Tests\models\staging\src_links.sql
[0m12:27:23.849458 [info ] [MainThread]: 
[0m12:27:23.850860 [error] [MainThread]: [31mFailure in model src_movies (models\staging\src_movies.sql)[0m
[0m12:27:23.850860 [error] [MainThread]:   Database Error in model src_movies (models\staging\src_movies.sql)
  001003 (42000): SQL compilation error:
  parse error line 1 at position 49 near '<EOF>'.
  syntax error line 1 at position 36 unexpected '/'.
  syntax error line 1 at position 36 unexpected '/'.
  syntax error line 1 at position 49 unexpected '<EOF>'.
[0m12:27:23.852869 [info ] [MainThread]: 
[0m12:27:23.852869 [info ] [MainThread]:   compiled code at target\compiled\Slip_Tests\models\staging\src_movies.sql
[0m12:27:23.860626 [info ] [MainThread]: 
[0m12:27:23.860881 [error] [MainThread]: [31mFailure in model src_ratings (models\staging\src_ratings.sql)[0m
[0m12:27:23.860881 [error] [MainThread]:   Database Error in model src_ratings (models\staging\src_ratings.sql)
  001003 (42000): SQL compilation error:
  parse error line 1 at position 49 near '<EOF>'.
  syntax error line 1 at position 36 unexpected '/'.
  syntax error line 1 at position 36 unexpected '/'.
  syntax error line 1 at position 49 unexpected '<EOF>'.
[0m12:27:23.860881 [info ] [MainThread]: 
[0m12:27:23.860881 [info ] [MainThread]:   compiled code at target\compiled\Slip_Tests\models\staging\src_ratings.sql
[0m12:27:23.860881 [info ] [MainThread]: 
[0m12:27:23.869013 [error] [MainThread]: [31mFailure in model src_tags (models\staging\src_tags.sql)[0m
[0m12:27:23.869013 [error] [MainThread]:   Database Error in model src_tags (models\staging\src_tags.sql)
  001003 (42000): SQL compilation error:
  parse error line 1 at position 49 near '<EOF>'.
  syntax error line 1 at position 36 unexpected '/'.
  syntax error line 1 at position 36 unexpected '/'.
  syntax error line 1 at position 49 unexpected '<EOF>'.
[0m12:27:23.871696 [info ] [MainThread]: 
[0m12:27:23.871696 [info ] [MainThread]:   compiled code at target\compiled\Slip_Tests\models\staging\src_tags.sql
[0m12:27:23.878724 [info ] [MainThread]: 
[0m12:27:23.878724 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=6 SKIP=5 NO-OP=0 TOTAL=11
[0m12:27:23.878724 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m12:27:23.885299 [debug] [MainThread]: Command `dbt run` failed at 12:27:23.885069 after 16.00 seconds
[0m12:27:23.885299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1D25FC740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1D29CDCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1D29CF530>]}
[0m12:27:23.886837 [debug] [MainThread]: Flushing usage events
[0m12:27:25.493700 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:30:15.984175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8CD534740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8CD4F2A80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8CD4F1F40>]}


============================== 12:30:15.984175 | 9880e786-b752-4d2f-a47b-797e859a7ff8 ==============================
[0m12:30:15.984175 [info ] [MainThread]: Running with dbt=1.10.1
[0m12:30:15.984175 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\dbt_workspace\\Slip_Tests\\logs', 'profiles_dir': 'C:\\Users\\ThembaniFaleni\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:30:17.226841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9880e786-b752-4d2f-a47b-797e859a7ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8CFD7AE10>]}
[0m12:30:17.507696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9880e786-b752-4d2f-a47b-797e859a7ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8CD0A9820>]}
[0m12:30:17.507696 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m12:30:17.927293 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m12:30:18.145965 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m12:30:18.145965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9880e786-b752-4d2f-a47b-797e859a7ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8D01798B0>]}
[0m12:30:18.177222 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'tests' in "<unicode string>", line 71, column 5 in file
`models\schema.yml`
[0m12:30:18.180144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9880e786-b752-4d2f-a47b-797e859a7ff8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8D026FE90>]}
[0m12:30:21.345930 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'fct_rating' in the 'models' section of file 'models\schema.yml'
[0m12:30:22.360611 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.Slip_Tests.not_null_fct_rating_user_id.140768c4a8' (models\schema.yml) depends on a node named 'fct_rating' in package '' which was not found
[0m12:30:22.360611 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.Slip_Tests.not_null_fct_rating_movie_id.e7004ba604' (models\schema.yml) depends on a node named 'fct_rating' in package '' which was not found
[0m12:30:22.360611 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.Slip_Tests.not_null_fct_rating_rating.2f45ab1d54' (models\schema.yml) depends on a node named 'fct_rating' in package '' which was not found
[0m12:30:22.360611 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.Slip_Tests.dbt_utils_expression_is_true_fct_rating__select_sum_rating_from_ref_src_ratings_select_sum_rating_from_ref_fct_rating_.f8623932f1' (models\schema.yml) depends on a node named 'fct_rating' in package '' which was not found
[0m12:30:22.360611 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.Slip_Tests.dbt_utils_expression_is_true_fct_rating__select_sum_rating_from_ref_src_ratings_select_sum_rating_from_ref_fct_rating_.f8623932f1' (models\schema.yml) depends on a node named 'fct_rating' in package '' which was not found
[0m12:30:22.677539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9880e786-b752-4d2f-a47b-797e859a7ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8CD71E960>]}
[0m12:30:22.852347 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m12:30:22.881520 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m12:30:22.912769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9880e786-b752-4d2f-a47b-797e859a7ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8D02AABA0>]}
[0m12:30:22.912769 [info ] [MainThread]: Found 12 models, 1 snapshot, 12 data tests, 6 sources, 592 macros
[0m12:30:22.912769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9880e786-b752-4d2f-a47b-797e859a7ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8D04A60F0>]}
[0m12:30:22.930986 [info ] [MainThread]: 
[0m12:30:22.933131 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:30:22.933904 [info ] [MainThread]: 
[0m12:30:22.938571 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:30:22.948756 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MOVIELENS'
[0m12:30:23.147026 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS"
[0m12:30:23.147026 [debug] [ThreadPool]: On list_MOVIELENS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS"} */
show terse schemas in database MOVIELENS
    limit 10000
[0m12:30:23.147026 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:30:24.681832 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.530 seconds
[0m12:30:24.686079 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MOVIELENS_snapshots'
[0m12:30:24.707272 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m12:30:24.707272 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
alter session set quoted_identifiers_ignore_case = false;
[0m12:30:24.713960 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:30:26.066239 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.354 seconds
[0m12:30:26.066239 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m12:30:26.066239 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
show objects in MOVIELENS.snapshots
    limit 10000
    
;
[0m12:30:26.394632 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.316 seconds
[0m12:30:26.394632 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m12:30:26.394632 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
alter session unset quoted_identifiers_ignore_case;
[0m12:30:26.738154 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.338 seconds
[0m12:30:26.738154 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MOVIELENS_snapshots, now list_MOVIELENS_DEV)
[0m12:30:26.738154 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m12:30:26.738154 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session set quoted_identifiers_ignore_case = false;
[0m12:30:27.001600 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.265 seconds
[0m12:30:27.017211 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m12:30:27.017211 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
show objects in MOVIELENS.DEV
    limit 10000
    
;
[0m12:30:27.425243 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.413 seconds
[0m12:30:27.425243 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m12:30:27.425243 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session unset quoted_identifiers_ignore_case;
[0m12:30:27.708792 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.276 seconds
[0m12:30:27.708792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9880e786-b752-4d2f-a47b-797e859a7ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8D05D61B0>]}
[0m12:30:27.724415 [debug] [Thread-1 (]: Began running node model.Slip_Tests.src_genome_score
[0m12:30:27.724415 [info ] [Thread-1 (]: 1 of 11 START sql view model DEV.src_genome_score .............................. [RUN]
[0m12:30:27.724415 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Slip_Tests.src_genome_score'
[0m12:30:27.724415 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.src_genome_score
[0m12:30:27.740800 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.src_genome_score"
[0m12:30:27.743147 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.src_genome_score
[0m12:30:27.788810 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.src_genome_score"
[0m12:30:27.788810 [debug] [Thread-1 (]: On model.Slip_Tests.src_genome_score: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.src_genome_score"} */
ALTER SESSION SET TIMEZONE = 'Africa/Johannesburg'
[0m12:30:27.796879 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:30:29.072117 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.278 seconds
[0m12:30:29.087731 [debug] [Thread-1 (]: Writing runtime sql for node "model.Slip_Tests.src_genome_score"
[0m12:30:29.104847 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.src_genome_score"
[0m12:30:29.106037 [debug] [Thread-1 (]: On model.Slip_Tests.src_genome_score: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.src_genome_score"} */
create or replace   view MOVIELENS.DEV.src_genome_score
  
   as (
    -- For genome_scores
WITH raw_genome_scores AS (
    SELECT * FROM MOVIELENS.RAW.RAW_GENOME_SCORES
)

SELECT
    movieId AS movie_id,
    tagId AS tag_id,
    relevance
FROM raw_genome_scores
  );
[0m12:30:29.716478 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.613 seconds
[0m12:30:29.776850 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9880e786-b752-4d2f-a47b-797e859a7ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8CACC9340>]}
[0m12:30:29.779374 [info ] [Thread-1 (]: 1 of 11 OK created sql view model DEV.src_genome_score ......................... [[32mSUCCESS 1[0m in 2.04s]
[0m12:30:29.782033 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.src_genome_score
[0m12:30:29.782033 [debug] [Thread-1 (]: Began running node model.Slip_Tests.src_genome_tags
[0m12:30:29.782033 [info ] [Thread-1 (]: 2 of 11 START sql view model DEV.src_genome_tags ............................... [RUN]
[0m12:30:29.786609 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Slip_Tests.src_genome_score, now model.Slip_Tests.src_genome_tags)
[0m12:30:29.786609 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.src_genome_tags
[0m12:30:29.786609 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.src_genome_tags"
[0m12:30:29.786609 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.src_genome_tags
[0m12:30:29.806533 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.src_genome_tags"
[0m12:30:29.806533 [debug] [Thread-1 (]: On model.Slip_Tests.src_genome_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.src_genome_tags"} */
ALTER SESSION SET TIMEZONE = 'Africa/Johannesburg'
[0m12:30:30.045717 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.233 seconds
[0m12:30:30.045717 [debug] [Thread-1 (]: Writing runtime sql for node "model.Slip_Tests.src_genome_tags"
[0m12:30:30.045717 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.src_genome_tags"
[0m12:30:30.045717 [debug] [Thread-1 (]: On model.Slip_Tests.src_genome_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.src_genome_tags"} */
create or replace   view MOVIELENS.DEV.src_genome_tags
  
   as (
    WITH raw_genome_tags AS (
    SELECT * FROM MOVIELENS.RAW.RAW_GENOME_TAGS
)

SELECT
    tagId AS tag_id,
    tag
FROM raw_genome_tags
  );
[0m12:30:30.546615 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.507 seconds
[0m12:30:30.560276 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9880e786-b752-4d2f-a47b-797e859a7ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8D1ADD010>]}
[0m12:30:30.560276 [info ] [Thread-1 (]: 2 of 11 OK created sql view model DEV.src_genome_tags .......................... [[32mSUCCESS 1[0m in 0.78s]
[0m12:30:30.560276 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.src_genome_tags
[0m12:30:30.560276 [debug] [Thread-1 (]: Began running node model.Slip_Tests.src_links
[0m12:30:30.560276 [info ] [Thread-1 (]: 3 of 11 START sql view model DEV.src_links ..................................... [RUN]
[0m12:30:30.560276 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Slip_Tests.src_genome_tags, now model.Slip_Tests.src_links)
[0m12:30:30.560276 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.src_links
[0m12:30:30.579118 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.src_links"
[0m12:30:30.582722 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.src_links
[0m12:30:30.588333 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.src_links"
[0m12:30:30.589640 [debug] [Thread-1 (]: On model.Slip_Tests.src_links: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.src_links"} */
ALTER SESSION SET TIMEZONE = 'Africa/Johannesburg'
[0m12:30:30.836697 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.251 seconds
[0m12:30:30.836697 [debug] [Thread-1 (]: Writing runtime sql for node "model.Slip_Tests.src_links"
[0m12:30:30.847339 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.src_links"
[0m12:30:30.848179 [debug] [Thread-1 (]: On model.Slip_Tests.src_links: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.src_links"} */
create or replace   view MOVIELENS.DEV.src_links
  
   as (
    -- For links
WITH raw_links AS (
    SELECT * FROM MOVIELENS.RAW.RAW_LINKS
)

SELECT
    movieId AS movie_id,
    imdbId AS imdb_id,
    tmdbId AS tmdb_id
FROM raw_links
  );
[0m12:30:31.348656 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.505 seconds
[0m12:30:31.357290 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9880e786-b752-4d2f-a47b-797e859a7ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8D0A32780>]}
[0m12:30:31.357290 [info ] [Thread-1 (]: 3 of 11 OK created sql view model DEV.src_links ................................ [[32mSUCCESS 1[0m in 0.80s]
[0m12:30:31.357290 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.src_links
[0m12:30:31.357290 [debug] [Thread-1 (]: Began running node model.Slip_Tests.src_movies
[0m12:30:31.357290 [info ] [Thread-1 (]: 4 of 11 START sql view model DEV.src_movies .................................... [RUN]
[0m12:30:31.357290 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Slip_Tests.src_links, now model.Slip_Tests.src_movies)
[0m12:30:31.357290 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.src_movies
[0m12:30:31.357290 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.src_movies"
[0m12:30:31.357290 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.src_movies
[0m12:30:31.373054 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.src_movies"
[0m12:30:31.373054 [debug] [Thread-1 (]: On model.Slip_Tests.src_movies: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.src_movies"} */
ALTER SESSION SET TIMEZONE = 'Africa/Johannesburg'
[0m12:30:31.595462 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.222 seconds
[0m12:30:31.595462 [debug] [Thread-1 (]: Writing runtime sql for node "model.Slip_Tests.src_movies"
[0m12:30:31.595462 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.src_movies"
[0m12:30:31.602478 [debug] [Thread-1 (]: On model.Slip_Tests.src_movies: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.src_movies"} */
create or replace   view MOVIELENS.DEV.src_movies
  
   as (
    WITH raw_movies AS (
   SELECT * FROM MOVIELENS.RAW.RAW_MOVIES
)
SELECT
    movieId As movie_id,
    title,
    genres
FROM raw_movies
  );
[0m12:30:32.175200 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.586 seconds
[0m12:30:32.190815 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9880e786-b752-4d2f-a47b-797e859a7ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8D0909AF0>]}
[0m12:30:32.190815 [info ] [Thread-1 (]: 4 of 11 OK created sql view model DEV.src_movies ............................... [[32mSUCCESS 1[0m in 0.83s]
[0m12:30:32.206450 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.src_movies
[0m12:30:32.206450 [debug] [Thread-1 (]: Began running node model.Slip_Tests.src_ratings
[0m12:30:32.206450 [info ] [Thread-1 (]: 5 of 11 START sql table model DEV.src_ratings .................................. [RUN]
[0m12:30:32.222075 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Slip_Tests.src_movies, now model.Slip_Tests.src_ratings)
[0m12:30:32.222075 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.src_ratings
[0m12:30:32.222075 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.src_ratings"
[0m12:30:32.222075 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.src_ratings
[0m12:30:32.252207 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.src_ratings"
[0m12:30:32.252207 [debug] [Thread-1 (]: On model.Slip_Tests.src_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.src_ratings"} */
ALTER SESSION SET TIMEZONE = 'Africa/Johannesburg'
[0m12:30:32.651213 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.400 seconds
[0m12:30:32.675504 [debug] [Thread-1 (]: Writing runtime sql for node "model.Slip_Tests.src_ratings"
[0m12:30:32.691199 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.src_ratings"
[0m12:30:32.691199 [debug] [Thread-1 (]: On model.Slip_Tests.src_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.src_ratings"} */
create or replace transient table MOVIELENS.DEV.src_ratings
    

    
    as (

WITH raw_ratings AS (

    SELECT * FROM MOVIELENS.RAW.RAW_RATINGS
)

SELECT
    userId AS user_id,
    movieId AS movie_id,
    rating,
    TO_TIMESTAMP_LTZ(timestamp) AS rating_timestamp
FROM raw_ratings
    )
;
[0m12:30:37.771454 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 5.079 seconds
[0m12:30:37.771454 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9880e786-b752-4d2f-a47b-797e859a7ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8D0A3A240>]}
[0m12:30:37.771454 [info ] [Thread-1 (]: 5 of 11 OK created sql table model DEV.src_ratings ............................. [[32mSUCCESS 1[0m in 5.55s]
[0m12:30:37.771454 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.src_ratings
[0m12:30:37.771454 [debug] [Thread-1 (]: Began running node model.Slip_Tests.src_tags
[0m12:30:37.787218 [info ] [Thread-1 (]: 6 of 11 START sql table model DEV.src_tags ..................................... [RUN]
[0m12:30:37.787218 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Slip_Tests.src_ratings, now model.Slip_Tests.src_tags)
[0m12:30:37.787218 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.src_tags
[0m12:30:37.796839 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.src_tags"
[0m12:30:37.796839 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.src_tags
[0m12:30:37.807267 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.src_tags"
[0m12:30:37.807267 [debug] [Thread-1 (]: On model.Slip_Tests.src_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.src_tags"} */
ALTER SESSION SET TIMEZONE = 'Africa/Johannesburg'
[0m12:30:38.067627 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.272 seconds
[0m12:30:38.083309 [debug] [Thread-1 (]: Writing runtime sql for node "model.Slip_Tests.src_tags"
[0m12:30:38.083309 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.src_tags"
[0m12:30:38.083309 [debug] [Thread-1 (]: On model.Slip_Tests.src_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.src_tags"} */
create or replace transient table MOVIELENS.DEV.src_tags
    

    
    as (

WITH raw_tags AS (
    SELECT * FROM MOVIELENS.RAW.RAW_TAGS
)
SELECT
    userId AS user_id,
    movieId AS movie_id,
    tag,
    CONVERT_TIMEZONE('UTC', 'Africa/Johannesburg', TO_TIMESTAMP_NTZ(timestamp)) AS tag_timestamp
    -- TO_TIMESTAMP_NTZ(timestamp) AS tag_timestamp
FROM raw_tags
    )
;
[0m12:30:39.775968 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.693 seconds
[0m12:30:39.775968 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9880e786-b752-4d2f-a47b-797e859a7ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8D1B1AD20>]}
[0m12:30:39.775968 [info ] [Thread-1 (]: 6 of 11 OK created sql table model DEV.src_tags ................................ [[32mSUCCESS 1[0m in 1.99s]
[0m12:30:39.775968 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.src_tags
[0m12:30:39.775968 [debug] [Thread-1 (]: Began running node model.Slip_Tests.fct_genome_score
[0m12:30:39.791730 [info ] [Thread-1 (]: 7 of 11 START sql table model DEV.fct_genome_score ............................. [RUN]
[0m12:30:39.841434 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Slip_Tests.src_tags, now model.Slip_Tests.fct_genome_score)
[0m12:30:39.854491 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.fct_genome_score
[0m12:30:39.862279 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.fct_genome_score"
[0m12:30:39.862279 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.fct_genome_score
[0m12:30:39.870340 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_genome_score"
[0m12:30:39.870340 [debug] [Thread-1 (]: On model.Slip_Tests.fct_genome_score: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_genome_score"} */
ALTER SESSION SET TIMEZONE = 'Africa/Johannesburg'
[0m12:30:40.077130 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.208 seconds
[0m12:30:40.077130 [debug] [Thread-1 (]: Writing runtime sql for node "model.Slip_Tests.fct_genome_score"
[0m12:30:40.077130 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_genome_score"
[0m12:30:40.085261 [debug] [Thread-1 (]: On model.Slip_Tests.fct_genome_score: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_genome_score"} */
create or replace transient table MOVIELENS.DEV.fct_genome_score
    

    
    as (WITH src_scores AS (
    SELECT * FROM MOVIELENS.DEV.src_genome_score
)

SELECT
    movie_id,
    tag_id,
    ROUND(relevance, 4) AS relevance_score
FROM src_scores
WHERE relevance > 0
    )
;
[0m12:30:42.668060 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.589 seconds
[0m12:30:42.676132 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9880e786-b752-4d2f-a47b-797e859a7ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8D1ABBFE0>]}
[0m12:30:42.676132 [info ] [Thread-1 (]: 7 of 11 OK created sql table model DEV.fct_genome_score ........................ [[32mSUCCESS 1[0m in 2.83s]
[0m12:30:42.676132 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.fct_genome_score
[0m12:30:42.676132 [debug] [Thread-1 (]: Began running node model.Slip_Tests.dim_genome_tags
[0m12:30:42.676132 [info ] [Thread-1 (]: 8 of 11 START sql table model DEV.dim_genome_tags .............................. [RUN]
[0m12:30:42.676132 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Slip_Tests.fct_genome_score, now model.Slip_Tests.dim_genome_tags)
[0m12:30:42.676132 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.dim_genome_tags
[0m12:30:42.698795 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.dim_genome_tags"
[0m12:30:42.698795 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.dim_genome_tags
[0m12:30:42.707284 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.dim_genome_tags"
[0m12:30:42.707284 [debug] [Thread-1 (]: On model.Slip_Tests.dim_genome_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.dim_genome_tags"} */
ALTER SESSION SET TIMEZONE = 'Africa/Johannesburg'
[0m12:30:42.983466 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.274 seconds
[0m12:30:42.983466 [debug] [Thread-1 (]: Writing runtime sql for node "model.Slip_Tests.dim_genome_tags"
[0m12:30:42.983466 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.dim_genome_tags"
[0m12:30:42.983466 [debug] [Thread-1 (]: On model.Slip_Tests.dim_genome_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.dim_genome_tags"} */
create or replace transient table MOVIELENS.DEV.dim_genome_tags
    

    
    as (WITH src_tags AS (
    SELECT * FROM MOVIELENS.DEV.src_genome_tags
)

SELECT
    tag_id,
    INITCAP(TRIM(tag)) AS tag_name
FROM src_tags
    )
;
[0m12:30:44.320917 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.334 seconds
[0m12:30:44.330065 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9880e786-b752-4d2f-a47b-797e859a7ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8D0A32240>]}
[0m12:30:44.330065 [info ] [Thread-1 (]: 8 of 11 OK created sql table model DEV.dim_genome_tags ......................... [[32mSUCCESS 1[0m in 1.65s]
[0m12:30:44.330065 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.dim_genome_tags
[0m12:30:44.330065 [debug] [Thread-1 (]: Began running node model.Slip_Tests.dim_movies
[0m12:30:44.330065 [info ] [Thread-1 (]: 9 of 11 START sql table model DEV.dim_movies ................................... [RUN]
[0m12:30:44.345852 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Slip_Tests.dim_genome_tags, now model.Slip_Tests.dim_movies)
[0m12:30:44.347942 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.dim_movies
[0m12:30:44.354478 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.dim_movies"
[0m12:30:44.354478 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.dim_movies
[0m12:30:44.362422 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.dim_movies"
[0m12:30:44.362422 [debug] [Thread-1 (]: On model.Slip_Tests.dim_movies: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.dim_movies"} */
ALTER SESSION SET TIMEZONE = 'Africa/Johannesburg'
[0m12:30:44.584032 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.218 seconds
[0m12:30:44.584032 [debug] [Thread-1 (]: Writing runtime sql for node "model.Slip_Tests.dim_movies"
[0m12:30:44.584032 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.dim_movies"
[0m12:30:44.584032 [debug] [Thread-1 (]: On model.Slip_Tests.dim_movies: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.dim_movies"} */
create or replace transient table MOVIELENS.DEV.dim_movies
    

    
    as (WITH src_movies AS (
    SELECT * FROM MOVIELENS.DEV.src_movies
)

SELECT
    movie_id,
    INITCAP(TRIM(title)) AS movie_title,
    SPLIT(genres, '|') AS genre_array,
FROM src_movies
    )
;
[0m12:30:46.785724 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.190 seconds
[0m12:30:46.789577 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9880e786-b752-4d2f-a47b-797e859a7ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8D1B21E50>]}
[0m12:30:46.790704 [info ] [Thread-1 (]: 9 of 11 OK created sql table model DEV.dim_movies .............................. [[32mSUCCESS 1[0m in 2.44s]
[0m12:30:46.793812 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.dim_movies
[0m12:30:46.793812 [debug] [Thread-1 (]: Began running node model.Slip_Tests.fct_ratings
[0m12:30:46.795526 [info ] [Thread-1 (]: 10 of 11 START sql incremental model DEV.fct_ratings ........................... [RUN]
[0m12:30:46.798374 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Slip_Tests.dim_movies, now model.Slip_Tests.fct_ratings)
[0m12:30:46.799475 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.fct_ratings
[0m12:30:46.815440 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.fct_ratings"
[0m12:30:46.815440 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.fct_ratings
[0m12:30:46.893959 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m12:30:46.893959 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
ALTER SESSION SET TIMEZONE = 'Africa/Johannesburg'
[0m12:30:47.141928 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.254 seconds
[0m12:30:47.141928 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m12:30:47.141928 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
create or replace  temporary view MOVIELENS.DEV.fct_ratings__dbt_tmp
  
   as (
    

WITH src_ratings AS (
    SELECT * FROM MOVIELENS.DEV.src_ratings
)

SELECT
    user_id,
    movie_id,
    rating,
    rating_timestamp
FROM src_ratings
WHERE rating IS NOT NULL

    AND rating_timestamp > (
        SELECT MAX(rating_timestamp) FROM MOVIELENS.DEV.fct_ratings
    )

  );
[0m12:30:47.800731 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.655 seconds
[0m12:30:47.816316 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m12:30:47.816316 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
describe table MOVIELENS.DEV.fct_ratings__dbt_tmp
[0m12:30:48.098461 [debug] [Thread-1 (]: SQL status: SUCCESS 4 in 0.281 seconds
[0m12:30:48.114074 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m12:30:48.114074 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
describe table MOVIELENS.DEV.fct_ratings
[0m12:30:48.365424 [debug] [Thread-1 (]: SQL status: SUCCESS 4 in 0.249 seconds
[0m12:30:48.381207 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m12:30:48.381207 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
describe table MOVIELENS.DEV.fct_ratings__dbt_tmp
[0m12:30:48.632060 [debug] [Thread-1 (]: SQL status: SUCCESS 4 in 0.247 seconds
[0m12:30:48.647765 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m12:30:48.647765 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
describe table "MOVIELENS"."DEV"."FCT_RATINGS"
[0m12:30:48.867700 [debug] [Thread-1 (]: SQL status: SUCCESS 4 in 0.226 seconds
[0m12:30:48.883834 [debug] [Thread-1 (]: 
    In "MOVIELENS"."DEV"."FCT_RATINGS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m12:30:48.930781 [debug] [Thread-1 (]: Writing runtime sql for node "model.Slip_Tests.fct_ratings"
[0m12:30:48.930781 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m12:30:48.930781 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
-- back compat for old kwarg name
  
  begin;
[0m12:30:49.274791 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.342 seconds
[0m12:30:49.274791 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m12:30:49.280943 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
insert into MOVIELENS.DEV.fct_ratings ("USER_ID", "MOVIE_ID", "RATING", "RATING_TIMESTAMP")
        (
            select "USER_ID", "MOVIE_ID", "RATING", "RATING_TIMESTAMP"
            from MOVIELENS.DEV.fct_ratings__dbt_tmp
        );
[0m12:30:49.964353 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.688 seconds
[0m12:30:49.964353 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m12:30:49.964353 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
COMMIT
[0m12:30:50.282988 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.310 seconds
[0m12:30:50.293512 [debug] [Thread-1 (]: Applying DROP to: MOVIELENS.DEV.fct_ratings__dbt_tmp
[0m12:30:50.309154 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m12:30:50.309154 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
drop view if exists MOVIELENS.DEV.fct_ratings__dbt_tmp cascade
[0m12:30:50.641696 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.329 seconds
[0m12:30:50.641696 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9880e786-b752-4d2f-a47b-797e859a7ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8D1B59490>]}
[0m12:30:50.641696 [info ] [Thread-1 (]: 10 of 11 OK created sql incremental model DEV.fct_ratings ...................... [[32mSUCCESS 0[0m in 3.84s]
[0m12:30:50.651010 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.fct_ratings
[0m12:30:50.651010 [debug] [Thread-1 (]: Began running node model.Slip_Tests.dim_user
[0m12:30:50.651010 [info ] [Thread-1 (]: 11 of 11 START sql table model DEV.dim_user .................................... [RUN]
[0m12:30:50.651010 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Slip_Tests.fct_ratings, now model.Slip_Tests.dim_user)
[0m12:30:50.651010 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.dim_user
[0m12:30:50.656025 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.dim_user"
[0m12:30:50.656025 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.dim_user
[0m12:30:50.656025 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.dim_user"
[0m12:30:50.656025 [debug] [Thread-1 (]: On model.Slip_Tests.dim_user: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.dim_user"} */
ALTER SESSION SET TIMEZONE = 'Africa/Johannesburg'
[0m12:30:50.899699 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.235 seconds
[0m12:30:50.899699 [debug] [Thread-1 (]: Writing runtime sql for node "model.Slip_Tests.dim_user"
[0m12:30:50.899699 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.dim_user"
[0m12:30:50.899699 [debug] [Thread-1 (]: On model.Slip_Tests.dim_user: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.dim_user"} */
create or replace transient table MOVIELENS.DEV.dim_user
    

    
    as (WITH ratings AS (
    SELECT DISTINCT user_id FROM MOVIELENS.DEV.src_ratings
),

tags AS (
    SELECT DISTINCT user_id FROM MOVIELENS.DEV.src_tags
)

SELECT DISTINCT user_id
FROM (
    SELECT * FROM ratings
    UNION
    SELECT * FROM tags
)
    )
;
[0m12:30:52.361922 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.449 seconds
[0m12:30:52.361922 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9880e786-b752-4d2f-a47b-797e859a7ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8D090A420>]}
[0m12:30:52.361922 [info ] [Thread-1 (]: 11 of 11 OK created sql table model DEV.dim_user ............................... [[32mSUCCESS 1[0m in 1.71s]
[0m12:30:52.361922 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.dim_user
[0m12:30:52.361922 [debug] [Thread-1 (]: Began running node model.Slip_Tests.dim_movies_with_tags
[0m12:30:52.361922 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Slip_Tests.dim_user, now model.Slip_Tests.dim_movies_with_tags)
[0m12:30:52.361922 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.dim_movies_with_tags
[0m12:30:52.377555 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.dim_movies_with_tags"
[0m12:30:52.377555 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.dim_movies_with_tags
[0m12:30:52.386172 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:30:52.388457 [debug] [MainThread]: Connection 'list_MOVIELENS' was left open.
[0m12:30:52.389901 [debug] [MainThread]: On list_MOVIELENS: Close
[0m12:30:52.907829 [debug] [MainThread]: Connection 'list_MOVIELENS_DEV' was left open.
[0m12:30:52.907829 [debug] [MainThread]: On list_MOVIELENS_DEV: Close
[0m12:30:53.332949 [debug] [MainThread]: Connection 'model.Slip_Tests.dim_movies_with_tags' was left open.
[0m12:30:53.332949 [debug] [MainThread]: On model.Slip_Tests.dim_movies_with_tags: Close
[0m12:30:53.744173 [info ] [MainThread]: 
[0m12:30:53.744173 [info ] [MainThread]: Finished running 1 incremental model, 6 table models, 4 view models in 0 hours 0 minutes and 30.81 seconds (30.81s).
[0m12:30:53.744173 [debug] [MainThread]: Command end result
[0m12:30:53.799647 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m12:30:53.807663 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m12:30:53.825206 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\dbt_workspace\Slip_Tests\target\run_results.json
[0m12:30:53.825206 [info ] [MainThread]: 
[0m12:30:53.825206 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:30:53.825206 [info ] [MainThread]: 
[0m12:30:53.825206 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=11
[0m12:30:53.825206 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m12:30:53.825206 [debug] [MainThread]: Command `dbt run` succeeded at 12:30:53.825206 after 38.29 seconds
[0m12:30:53.840256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8CD779040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8CD0A9220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8CD0A9370>]}
[0m12:30:53.841316 [debug] [MainThread]: Flushing usage events
[0m12:30:55.247376 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:32:19.998376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002125E4B0DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002125E4B0560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002125E4B0080>]}


============================== 12:32:20.006220 | f9988df4-d2c2-4a8a-9cda-8199397acb31 ==============================
[0m12:32:20.006220 [info ] [MainThread]: Running with dbt=1.10.1
[0m12:32:20.006220 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ThembaniFaleni\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\dbt_workspace\\Slip_Tests\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:32:21.493151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f9988df4-d2c2-4a8a-9cda-8199397acb31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002126048DBB0>]}
[0m12:32:21.782320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f9988df4-d2c2-4a8a-9cda-8199397acb31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002125FE592B0>]}
[0m12:32:21.782320 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m12:32:22.331718 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m12:32:22.869012 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:32:22.869012 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:32:23.035286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f9988df4-d2c2-4a8a-9cda-8199397acb31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002126080AC00>]}
[0m12:32:23.361943 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m12:32:23.393791 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m12:32:23.457827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f9988df4-d2c2-4a8a-9cda-8199397acb31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021260AF27B0>]}
[0m12:32:23.457827 [info ] [MainThread]: Found 12 models, 1 snapshot, 12 data tests, 6 sources, 592 macros
[0m12:32:23.464355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9988df4-d2c2-4a8a-9cda-8199397acb31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021260C266C0>]}
[0m12:32:23.473591 [info ] [MainThread]: 
[0m12:32:23.475876 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:32:23.476553 [info ] [MainThread]: 
[0m12:32:23.478667 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:32:23.482697 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MOVIELENS'
[0m12:32:23.663789 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS"
[0m12:32:23.664825 [debug] [ThreadPool]: On list_MOVIELENS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS"} */
show terse schemas in database MOVIELENS
    limit 10000
[0m12:32:23.665866 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:32:26.454741 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.789 seconds
[0m12:32:26.484429 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MOVIELENS_DEV'
[0m12:32:26.496441 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m12:32:26.496441 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session set quoted_identifiers_ignore_case = false;
[0m12:32:26.496441 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:32:27.682367 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.171 seconds
[0m12:32:27.684609 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m12:32:27.684609 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
show objects in MOVIELENS.DEV
    limit 10000
    
;
[0m12:32:28.049037 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.367 seconds
[0m12:32:28.049037 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m12:32:28.062243 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session unset quoted_identifiers_ignore_case;
[0m12:32:28.302650 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.241 seconds
[0m12:32:28.302650 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MOVIELENS_DEV, now list_MOVIELENS_snapshots)
[0m12:32:28.302650 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m12:32:28.302650 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
alter session set quoted_identifiers_ignore_case = false;
[0m12:32:28.564990 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.262 seconds
[0m12:32:28.580480 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m12:32:28.580480 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
show objects in MOVIELENS.snapshots
    limit 10000
    
;
[0m12:32:28.936427 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.350 seconds
[0m12:32:28.940962 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m12:32:28.942476 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
alter session unset quoted_identifiers_ignore_case;
[0m12:32:29.193893 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.253 seconds
[0m12:32:29.193893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9988df4-d2c2-4a8a-9cda-8199397acb31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002125F96EB40>]}
[0m12:32:29.209611 [debug] [Thread-1 (]: Began running node snapshot.Slip_Tests.snap_tags
[0m12:32:29.209611 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.snap_tags ...................................... [RUN]
[0m12:32:29.209611 [debug] [Thread-1 (]: Acquiring new snowflake connection 'snapshot.Slip_Tests.snap_tags'
[0m12:32:29.209611 [debug] [Thread-1 (]: Began compiling node snapshot.Slip_Tests.snap_tags
[0m12:32:29.276613 [debug] [Thread-1 (]: Began executing node snapshot.Slip_Tests.snap_tags
[0m12:32:29.389694 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m12:32:29.389694 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
[0m12:32:29.404938 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:32:30.789316 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 1.392 seconds
[0m12:32:30.931163 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m12:32:30.932897 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
create or replace temporary table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS__dbt_tmp"
as (
    
    
    with snapshot_query as (

        





SELECT
    md5(cast(coalesce(cast(user_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(movie_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS id,
    user_id,
    movie_id,
    tag,
    -- TO_TIMESTAMP_NTZ(tag_timestamp) as tag_timestamp,
    CONVERT_TIMEZONE('UTC', 'Africa/Johannesburg', TO_TIMESTAMP_NTZ(tag_timestamp)) AS tag_timestamp
FROM MOVIELENS.DEV.src_tags
-- LIMIT 100


    ),

    snapshotted_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    

        from "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    
,
            tag_timestamp as dbt_updated_at,
            tag_timestamp as dbt_valid_from,
            
  
  coalesce(nullif(tag_timestamp, tag_timestamp), null)
  as dbt_valid_to
,
            md5(coalesce(cast(user_id as varchar ), '')
         || '|' || coalesce(cast(movie_id as varchar ), '')
         || '|' || coalesce(cast(tag as varchar ), '')
         || '|' || coalesce(cast(tag_timestamp as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    
,
            tag_timestamp as dbt_updated_at,
            tag_timestamp as dbt_valid_from,
            tag_timestamp as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

            where 
    
        snapshotted_data.dbt_unique_key_1 is null
    

            or (
    
        snapshotted_data.dbt_unique_key_1 is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.tag_timestamp)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.tag_timestamp)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

            where 
    
        source_data.dbt_unique_key_1 is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    )
;
[0m12:32:33.458050 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.533 seconds
[0m12:32:33.472679 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m12:32:33.472679 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS__dbt_tmp"
[0m12:32:33.712197 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.249 seconds
[0m12:32:33.727458 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m12:32:33.727458 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
[0m12:32:33.988531 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.260 seconds
[0m12:32:34.004442 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m12:32:34.004442 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS__dbt_tmp"
[0m12:32:34.774010 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.771 seconds
[0m12:32:34.789658 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m12:32:34.789658 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
[0m12:32:35.043126 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.255 seconds
[0m12:32:35.055157 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m12:32:35.055157 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS__dbt_tmp"
[0m12:32:35.363988 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.295 seconds
[0m12:32:35.414131 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m12:32:35.414131 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
/* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
select * from (
        
    
    with snapshot_query as (

        





SELECT
    md5(cast(coalesce(cast(user_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(movie_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS id,
    user_id,
    movie_id,
    tag,
    -- TO_TIMESTAMP_NTZ(tag_timestamp) as tag_timestamp,
    CONVERT_TIMEZONE('UTC', 'Africa/Johannesburg', TO_TIMESTAMP_NTZ(tag_timestamp)) AS tag_timestamp
FROM MOVIELENS.DEV.src_tags
-- LIMIT 100


    ),

    snapshotted_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    

        from "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    
,
            tag_timestamp as dbt_updated_at,
            tag_timestamp as dbt_valid_from,
            
  
  coalesce(nullif(tag_timestamp, tag_timestamp), null)
  as dbt_valid_to
,
            md5(coalesce(cast(user_id as varchar ), '')
         || '|' || coalesce(cast(movie_id as varchar ), '')
         || '|' || coalesce(cast(tag as varchar ), '')
         || '|' || coalesce(cast(tag_timestamp as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    
,
            tag_timestamp as dbt_updated_at,
            tag_timestamp as dbt_valid_from,
            tag_timestamp as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

            where 
    
        snapshotted_data.dbt_unique_key_1 is null
    

            or (
    
        snapshotted_data.dbt_unique_key_1 is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.tag_timestamp)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.tag_timestamp)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

            where 
    
        source_data.dbt_unique_key_1 is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m12:32:36.251139 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.822 seconds
[0m12:32:36.252547 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m12:32:36.252547 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
/* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m12:32:36.510319 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.246 seconds
[0m12:32:36.510319 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.Slip_Tests.snap_tags"
[0m12:32:36.510319 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m12:32:36.510319 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
BEGIN
[0m12:32:36.763071 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.252 seconds
[0m12:32:36.763071 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m12:32:36.763071 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
merge into "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS" as DBT_INTERNAL_DEST
    using "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("ID", "USER_ID", "MOVIE_ID", "TAG", "TAG_TIMESTAMP", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("ID", "USER_ID", "MOVIE_ID", "TAG", "TAG_TIMESTAMP", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m12:32:38.188754 [debug] [Thread-1 (]: SQL status: SUCCESS 2 in 1.424 seconds
[0m12:32:38.188754 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m12:32:38.188754 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
COMMIT
[0m12:32:38.912700 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.712 seconds
[0m12:32:38.960742 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9988df4-d2c2-4a8a-9cda-8199397acb31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002126127F1A0>]}
[0m12:32:38.960742 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.snap_tags ...................................... [[32mSUCCESS 2[0m in 9.74s]
[0m12:32:38.960742 [debug] [Thread-1 (]: Finished running node snapshot.Slip_Tests.snap_tags
[0m12:32:38.960742 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:32:38.960742 [debug] [MainThread]: Connection 'list_MOVIELENS' was left open.
[0m12:32:38.960742 [debug] [MainThread]: On list_MOVIELENS: Close
[0m12:32:39.421799 [debug] [MainThread]: Connection 'list_MOVIELENS_snapshots' was left open.
[0m12:32:39.421799 [debug] [MainThread]: On list_MOVIELENS_snapshots: Close
[0m12:32:39.832050 [debug] [MainThread]: Connection 'snapshot.Slip_Tests.snap_tags' was left open.
[0m12:32:39.832050 [debug] [MainThread]: On snapshot.Slip_Tests.snap_tags: Close
[0m12:32:40.247595 [info ] [MainThread]: 
[0m12:32:40.249661 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 16.77 seconds (16.77s).
[0m12:32:40.256838 [debug] [MainThread]: Command end result
[0m12:32:40.315536 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m12:32:40.315536 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m12:32:40.346408 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\dbt_workspace\Slip_Tests\target\run_results.json
[0m12:32:40.346408 [info ] [MainThread]: 
[0m12:32:40.349631 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:32:40.349631 [info ] [MainThread]: 
[0m12:32:40.349631 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:32:40.355074 [debug] [MainThread]: Command `dbt snapshot` succeeded at 12:32:40.355074 after 20.73 seconds
[0m12:32:40.355074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002125E4B3140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002125E4B0560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002125E4B0DD0>]}
[0m12:32:40.355074 [debug] [MainThread]: Flushing usage events
[0m12:32:41.501193 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:34:38.959980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0106CE090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F011622870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F010E0AFF0>]}


============================== 12:34:38.959980 | 1a14ee6f-d53a-4422-a7e9-bbf105563a3a ==============================
[0m12:34:38.959980 [info ] [MainThread]: Running with dbt=1.10.1
[0m12:34:38.959980 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ThembaniFaleni\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\dbt_workspace\\Slip_Tests\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:34:40.045682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a14ee6f-d53a-4422-a7e9-bbf105563a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F011AEC290>]}
[0m12:34:40.261083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1a14ee6f-d53a-4422-a7e9-bbf105563a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F011BF2060>]}
[0m12:34:40.261083 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m12:34:40.674049 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m12:34:40.995095 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m12:34:40.995095 [debug] [MainThread]: Partial parsing: updated file: Slip_Tests://snapshots\snap_tag.sql
[0m12:34:40.995095 [debug] [MainThread]: Partial parsing: updated file: Slip_Tests://models\staging\src_tags.sql
[0m12:34:42.916747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a14ee6f-d53a-4422-a7e9-bbf105563a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F014602480>]}
[0m12:34:43.059206 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m12:34:43.091039 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m12:34:43.128725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a14ee6f-d53a-4422-a7e9-bbf105563a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F014600CB0>]}
[0m12:34:43.128725 [info ] [MainThread]: Found 12 models, 12 data tests, 1 snapshot, 6 sources, 592 macros
[0m12:34:43.128725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a14ee6f-d53a-4422-a7e9-bbf105563a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0141123F0>]}
[0m12:34:43.138951 [info ] [MainThread]: 
[0m12:34:43.138951 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:34:43.143203 [info ] [MainThread]: 
[0m12:34:43.144784 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:34:43.158853 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MOVIELENS'
[0m12:34:43.273902 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS"
[0m12:34:43.273902 [debug] [ThreadPool]: On list_MOVIELENS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS"} */
show terse schemas in database MOVIELENS
    limit 10000
[0m12:34:43.273902 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:34:44.815737 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.530 seconds
[0m12:34:44.821739 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MOVIELENS_snapshots'
[0m12:34:44.842829 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m12:34:44.844223 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
alter session set quoted_identifiers_ignore_case = false;
[0m12:34:44.844223 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:34:46.258337 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.421 seconds
[0m12:34:46.258337 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m12:34:46.258337 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
show objects in MOVIELENS.snapshots
    limit 10000
    
;
[0m12:34:46.559221 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.300 seconds
[0m12:34:46.574871 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m12:34:46.574871 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
alter session unset quoted_identifiers_ignore_case;
[0m12:34:47.013914 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.436 seconds
[0m12:34:47.014902 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MOVIELENS_snapshots, now list_MOVIELENS_DEV)
[0m12:34:47.014902 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m12:34:47.023647 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session set quoted_identifiers_ignore_case = false;
[0m12:34:47.280852 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.256 seconds
[0m12:34:47.280852 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m12:34:47.280852 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
show objects in MOVIELENS.DEV
    limit 10000
    
;
[0m12:34:47.826443 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.549 seconds
[0m12:34:47.826443 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m12:34:47.826443 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session unset quoted_identifiers_ignore_case;
[0m12:34:48.147512 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.310 seconds
[0m12:34:48.156530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a14ee6f-d53a-4422-a7e9-bbf105563a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0144DA4E0>]}
[0m12:34:48.156530 [debug] [Thread-1 (]: Began running node model.Slip_Tests.src_genome_score
[0m12:34:48.156530 [info ] [Thread-1 (]: 1 of 11 START sql view model DEV.src_genome_score .............................. [RUN]
[0m12:34:48.156530 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Slip_Tests.src_genome_score'
[0m12:34:48.156530 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.src_genome_score
[0m12:34:48.177180 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.src_genome_score"
[0m12:34:48.181800 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.src_genome_score
[0m12:34:48.223290 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.src_genome_score"
[0m12:34:48.224530 [debug] [Thread-1 (]: On model.Slip_Tests.src_genome_score: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.src_genome_score"} */
ALTER SESSION SET TIMEZONE = 'Africa/Johannesburg'
[0m12:34:48.225546 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:34:49.549557 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.326 seconds
[0m12:34:49.566156 [debug] [Thread-1 (]: Writing runtime sql for node "model.Slip_Tests.src_genome_score"
[0m12:34:49.566156 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.src_genome_score"
[0m12:34:49.566156 [debug] [Thread-1 (]: On model.Slip_Tests.src_genome_score: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.src_genome_score"} */
create or replace   view MOVIELENS.DEV.src_genome_score
  
   as (
    -- For genome_scores
WITH raw_genome_scores AS (
    SELECT * FROM MOVIELENS.RAW.RAW_GENOME_SCORES
)

SELECT
    movieId AS movie_id,
    tagId AS tag_id,
    relevance
FROM raw_genome_scores
  );
[0m12:34:50.280804 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.700 seconds
[0m12:34:50.336327 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a14ee6f-d53a-4422-a7e9-bbf105563a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F014D310A0>]}
[0m12:34:50.336327 [info ] [Thread-1 (]: 1 of 11 OK created sql view model DEV.src_genome_score ......................... [[32mSUCCESS 1[0m in 2.18s]
[0m12:34:50.336327 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.src_genome_score
[0m12:34:50.336327 [debug] [Thread-1 (]: Began running node model.Slip_Tests.src_genome_tags
[0m12:34:50.336327 [info ] [Thread-1 (]: 2 of 11 START sql view model DEV.src_genome_tags ............................... [RUN]
[0m12:34:50.336327 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Slip_Tests.src_genome_score, now model.Slip_Tests.src_genome_tags)
[0m12:34:50.342634 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.src_genome_tags
[0m12:34:50.344651 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.src_genome_tags"
[0m12:34:50.344651 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.src_genome_tags
[0m12:34:50.350820 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.src_genome_tags"
[0m12:34:50.352837 [debug] [Thread-1 (]: On model.Slip_Tests.src_genome_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.src_genome_tags"} */
ALTER SESSION SET TIMEZONE = 'Africa/Johannesburg'
[0m12:34:50.559095 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.217 seconds
[0m12:34:50.559095 [debug] [Thread-1 (]: Writing runtime sql for node "model.Slip_Tests.src_genome_tags"
[0m12:34:50.575076 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.src_genome_tags"
[0m12:34:50.575076 [debug] [Thread-1 (]: On model.Slip_Tests.src_genome_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.src_genome_tags"} */
create or replace   view MOVIELENS.DEV.src_genome_tags
  
   as (
    WITH raw_genome_tags AS (
    SELECT * FROM MOVIELENS.RAW.RAW_GENOME_TAGS
)

SELECT
    tagId AS tag_id,
    tag
FROM raw_genome_tags
  );
[0m12:34:51.292417 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.726 seconds
[0m12:34:51.307893 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a14ee6f-d53a-4422-a7e9-bbf105563a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F014D77650>]}
[0m12:34:51.307893 [info ] [Thread-1 (]: 2 of 11 OK created sql view model DEV.src_genome_tags .......................... [[32mSUCCESS 1[0m in 0.97s]
[0m12:34:51.307893 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.src_genome_tags
[0m12:34:51.307893 [debug] [Thread-1 (]: Began running node model.Slip_Tests.src_links
[0m12:34:51.307893 [info ] [Thread-1 (]: 3 of 11 START sql view model DEV.src_links ..................................... [RUN]
[0m12:34:51.307893 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Slip_Tests.src_genome_tags, now model.Slip_Tests.src_links)
[0m12:34:51.307893 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.src_links
[0m12:34:51.307893 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.src_links"
[0m12:34:51.307893 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.src_links
[0m12:34:51.325374 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.src_links"
[0m12:34:51.325897 [debug] [Thread-1 (]: On model.Slip_Tests.src_links: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.src_links"} */
ALTER SESSION SET TIMEZONE = 'Africa/Johannesburg'
[0m12:34:51.590125 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.263 seconds
[0m12:34:51.593819 [debug] [Thread-1 (]: Writing runtime sql for node "model.Slip_Tests.src_links"
[0m12:34:51.593819 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.src_links"
[0m12:34:51.593819 [debug] [Thread-1 (]: On model.Slip_Tests.src_links: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.src_links"} */
create or replace   view MOVIELENS.DEV.src_links
  
   as (
    -- For links
WITH raw_links AS (
    SELECT * FROM MOVIELENS.RAW.RAW_LINKS
)

SELECT
    movieId AS movie_id,
    imdbId AS imdb_id,
    tmdbId AS tmdb_id
FROM raw_links
  );
[0m12:34:52.128037 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.530 seconds
[0m12:34:52.186773 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a14ee6f-d53a-4422-a7e9-bbf105563a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F014D2C470>]}
[0m12:34:52.188028 [info ] [Thread-1 (]: 3 of 11 OK created sql view model DEV.src_links ................................ [[32mSUCCESS 1[0m in 0.88s]
[0m12:34:52.189791 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.src_links
[0m12:34:52.190337 [debug] [Thread-1 (]: Began running node model.Slip_Tests.src_movies
[0m12:34:52.190337 [info ] [Thread-1 (]: 4 of 11 START sql view model DEV.src_movies .................................... [RUN]
[0m12:34:52.190337 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Slip_Tests.src_links, now model.Slip_Tests.src_movies)
[0m12:34:52.190337 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.src_movies
[0m12:34:52.190337 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.src_movies"
[0m12:34:52.190337 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.src_movies
[0m12:34:52.200942 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.src_movies"
[0m12:34:52.200942 [debug] [Thread-1 (]: On model.Slip_Tests.src_movies: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.src_movies"} */
ALTER SESSION SET TIMEZONE = 'Africa/Johannesburg'
[0m12:34:52.430425 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.239 seconds
[0m12:34:52.430425 [debug] [Thread-1 (]: Writing runtime sql for node "model.Slip_Tests.src_movies"
[0m12:34:52.446067 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.src_movies"
[0m12:34:52.446067 [debug] [Thread-1 (]: On model.Slip_Tests.src_movies: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.src_movies"} */
create or replace   view MOVIELENS.DEV.src_movies
  
   as (
    WITH raw_movies AS (
   SELECT * FROM MOVIELENS.RAW.RAW_MOVIES
)
SELECT
    movieId As movie_id,
    title,
    genres
FROM raw_movies
  );
[0m12:34:53.122881 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.678 seconds
[0m12:34:53.122881 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a14ee6f-d53a-4422-a7e9-bbf105563a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F014D45610>]}
[0m12:34:53.122881 [info ] [Thread-1 (]: 4 of 11 OK created sql view model DEV.src_movies ............................... [[32mSUCCESS 1[0m in 0.93s]
[0m12:34:53.122881 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.src_movies
[0m12:34:53.122881 [debug] [Thread-1 (]: Began running node model.Slip_Tests.src_ratings
[0m12:34:53.122881 [info ] [Thread-1 (]: 5 of 11 START sql table model DEV.src_ratings .................................. [RUN]
[0m12:34:53.122881 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Slip_Tests.src_movies, now model.Slip_Tests.src_ratings)
[0m12:34:53.122881 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.src_ratings
[0m12:34:53.143174 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.src_ratings"
[0m12:34:53.143174 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.src_ratings
[0m12:34:53.164424 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.src_ratings"
[0m12:34:53.165450 [debug] [Thread-1 (]: On model.Slip_Tests.src_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.src_ratings"} */
ALTER SESSION SET TIMEZONE = 'Africa/Johannesburg'
[0m12:34:53.363931 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.198 seconds
[0m12:34:53.398682 [debug] [Thread-1 (]: Writing runtime sql for node "model.Slip_Tests.src_ratings"
[0m12:34:53.398682 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.src_ratings"
[0m12:34:53.398682 [debug] [Thread-1 (]: On model.Slip_Tests.src_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.src_ratings"} */
create or replace transient table MOVIELENS.DEV.src_ratings
    

    
    as (

WITH raw_ratings AS (

    SELECT * FROM MOVIELENS.RAW.RAW_RATINGS
)

SELECT
    userId AS user_id,
    movieId AS movie_id,
    rating,
    TO_TIMESTAMP_LTZ(timestamp) AS rating_timestamp
FROM raw_ratings
    )
;
[0m12:34:58.366715 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.978 seconds
[0m12:34:58.381731 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a14ee6f-d53a-4422-a7e9-bbf105563a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F014D07BC0>]}
[0m12:34:58.381731 [info ] [Thread-1 (]: 5 of 11 OK created sql table model DEV.src_ratings ............................. [[32mSUCCESS 1[0m in 5.26s]
[0m12:34:58.381731 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.src_ratings
[0m12:34:58.381731 [debug] [Thread-1 (]: Began running node model.Slip_Tests.src_tags
[0m12:34:58.381731 [info ] [Thread-1 (]: 6 of 11 START sql table model DEV.src_tags ..................................... [RUN]
[0m12:34:58.381731 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Slip_Tests.src_ratings, now model.Slip_Tests.src_tags)
[0m12:34:58.381731 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.src_tags
[0m12:34:58.381731 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.src_tags"
[0m12:34:58.381731 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.src_tags
[0m12:34:58.400266 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.src_tags"
[0m12:34:58.400266 [debug] [Thread-1 (]: On model.Slip_Tests.src_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.src_tags"} */
ALTER SESSION SET TIMEZONE = 'Africa/Johannesburg'
[0m12:34:58.612613 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.210 seconds
[0m12:34:58.612613 [debug] [Thread-1 (]: Writing runtime sql for node "model.Slip_Tests.src_tags"
[0m12:34:58.612613 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.src_tags"
[0m12:34:58.612613 [debug] [Thread-1 (]: On model.Slip_Tests.src_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.src_tags"} */
create or replace transient table MOVIELENS.DEV.src_tags
    

    
    as (

WITH raw_tags AS (
    SELECT * FROM MOVIELENS.RAW.RAW_TAGS
)
SELECT
    userId AS user_id,
    movieId AS movie_id,
    tag,
    TO_TIMESTAMP_NTZ(timestamp) AS tag_timestamp
FROM raw_tags
    )
;
[0m12:35:00.223580 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.603 seconds
[0m12:35:00.223580 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a14ee6f-d53a-4422-a7e9-bbf105563a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F015E23EF0>]}
[0m12:35:00.223580 [info ] [Thread-1 (]: 6 of 11 OK created sql table model DEV.src_tags ................................ [[32mSUCCESS 1[0m in 1.84s]
[0m12:35:00.231768 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.src_tags
[0m12:35:00.231768 [debug] [Thread-1 (]: Began running node model.Slip_Tests.fct_genome_score
[0m12:35:00.231768 [info ] [Thread-1 (]: 7 of 11 START sql table model DEV.fct_genome_score ............................. [RUN]
[0m12:35:00.235357 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Slip_Tests.src_tags, now model.Slip_Tests.fct_genome_score)
[0m12:35:00.235357 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.fct_genome_score
[0m12:35:00.242070 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.fct_genome_score"
[0m12:35:00.242070 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.fct_genome_score
[0m12:35:00.242070 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_genome_score"
[0m12:35:00.242070 [debug] [Thread-1 (]: On model.Slip_Tests.fct_genome_score: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_genome_score"} */
ALTER SESSION SET TIMEZONE = 'Africa/Johannesburg'
[0m12:35:00.439362 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.202 seconds
[0m12:35:00.455012 [debug] [Thread-1 (]: Writing runtime sql for node "model.Slip_Tests.fct_genome_score"
[0m12:35:00.455012 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_genome_score"
[0m12:35:00.455012 [debug] [Thread-1 (]: On model.Slip_Tests.fct_genome_score: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_genome_score"} */
create or replace transient table MOVIELENS.DEV.fct_genome_score
    

    
    as (WITH src_scores AS (
    SELECT * FROM MOVIELENS.DEV.src_genome_score
)

SELECT
    movie_id,
    tag_id,
    ROUND(relevance, 4) AS relevance_score
FROM src_scores
WHERE relevance > 0
    )
;
[0m12:35:02.984300 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.538 seconds
[0m12:35:03.000210 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a14ee6f-d53a-4422-a7e9-bbf105563a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F014BCBE00>]}
[0m12:35:03.000210 [info ] [Thread-1 (]: 7 of 11 OK created sql table model DEV.fct_genome_score ........................ [[32mSUCCESS 1[0m in 2.77s]
[0m12:35:03.000210 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.fct_genome_score
[0m12:35:03.000210 [debug] [Thread-1 (]: Began running node model.Slip_Tests.dim_genome_tags
[0m12:35:03.000210 [info ] [Thread-1 (]: 8 of 11 START sql table model DEV.dim_genome_tags .............................. [RUN]
[0m12:35:03.000210 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Slip_Tests.fct_genome_score, now model.Slip_Tests.dim_genome_tags)
[0m12:35:03.009840 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.dim_genome_tags
[0m12:35:03.016418 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.dim_genome_tags"
[0m12:35:03.016418 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.dim_genome_tags
[0m12:35:03.025933 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.dim_genome_tags"
[0m12:35:03.085237 [debug] [Thread-1 (]: On model.Slip_Tests.dim_genome_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.dim_genome_tags"} */
ALTER SESSION SET TIMEZONE = 'Africa/Johannesburg'
[0m12:35:03.301656 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.219 seconds
[0m12:35:03.301656 [debug] [Thread-1 (]: Writing runtime sql for node "model.Slip_Tests.dim_genome_tags"
[0m12:35:03.301656 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.dim_genome_tags"
[0m12:35:03.301656 [debug] [Thread-1 (]: On model.Slip_Tests.dim_genome_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.dim_genome_tags"} */
create or replace transient table MOVIELENS.DEV.dim_genome_tags
    

    
    as (WITH src_tags AS (
    SELECT * FROM MOVIELENS.DEV.src_genome_tags
)

SELECT
    tag_id,
    INITCAP(TRIM(tag)) AS tag_name
FROM src_tags
    )
;
[0m12:35:04.518725 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.210 seconds
[0m12:35:04.518725 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a14ee6f-d53a-4422-a7e9-bbf105563a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F014BFC440>]}
[0m12:35:04.518725 [info ] [Thread-1 (]: 8 of 11 OK created sql table model DEV.dim_genome_tags ......................... [[32mSUCCESS 1[0m in 1.52s]
[0m12:35:04.518725 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.dim_genome_tags
[0m12:35:04.518725 [debug] [Thread-1 (]: Began running node model.Slip_Tests.dim_movies
[0m12:35:04.518725 [info ] [Thread-1 (]: 9 of 11 START sql table model DEV.dim_movies ................................... [RUN]
[0m12:35:04.518725 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Slip_Tests.dim_genome_tags, now model.Slip_Tests.dim_movies)
[0m12:35:04.533745 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.dim_movies
[0m12:35:04.534419 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.dim_movies"
[0m12:35:04.534419 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.dim_movies
[0m12:35:04.534419 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.dim_movies"
[0m12:35:04.534419 [debug] [Thread-1 (]: On model.Slip_Tests.dim_movies: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.dim_movies"} */
ALTER SESSION SET TIMEZONE = 'Africa/Johannesburg'
[0m12:35:04.736118 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.197 seconds
[0m12:35:04.736118 [debug] [Thread-1 (]: Writing runtime sql for node "model.Slip_Tests.dim_movies"
[0m12:35:04.736118 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.dim_movies"
[0m12:35:04.736118 [debug] [Thread-1 (]: On model.Slip_Tests.dim_movies: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.dim_movies"} */
create or replace transient table MOVIELENS.DEV.dim_movies
    

    
    as (WITH src_movies AS (
    SELECT * FROM MOVIELENS.DEV.src_movies
)

SELECT
    movie_id,
    INITCAP(TRIM(title)) AS movie_title,
    SPLIT(genres, '|') AS genre_array,
FROM src_movies
    )
;
[0m12:35:06.507002 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.760 seconds
[0m12:35:06.507002 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a14ee6f-d53a-4422-a7e9-bbf105563a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0149576E0>]}
[0m12:35:06.507002 [info ] [Thread-1 (]: 9 of 11 OK created sql table model DEV.dim_movies .............................. [[32mSUCCESS 1[0m in 1.99s]
[0m12:35:06.507002 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.dim_movies
[0m12:35:06.507002 [debug] [Thread-1 (]: Began running node model.Slip_Tests.fct_ratings
[0m12:35:06.507002 [info ] [Thread-1 (]: 10 of 11 START sql incremental model DEV.fct_ratings ........................... [RUN]
[0m12:35:06.507002 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Slip_Tests.dim_movies, now model.Slip_Tests.fct_ratings)
[0m12:35:06.507002 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.fct_ratings
[0m12:35:06.522574 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.fct_ratings"
[0m12:35:06.522574 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.fct_ratings
[0m12:35:06.603453 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m12:35:06.611649 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
ALTER SESSION SET TIMEZONE = 'Africa/Johannesburg'
[0m12:35:06.801952 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.192 seconds
[0m12:35:06.801952 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m12:35:06.801952 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
create or replace  temporary view MOVIELENS.DEV.fct_ratings__dbt_tmp
  
   as (
    

WITH src_ratings AS (
    SELECT * FROM MOVIELENS.DEV.src_ratings
)

SELECT
    user_id,
    movie_id,
    rating,
    rating_timestamp
FROM src_ratings
WHERE rating IS NOT NULL

    AND rating_timestamp > (
        SELECT MAX(rating_timestamp) FROM MOVIELENS.DEV.fct_ratings
    )

  );
[0m12:35:08.785365 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.981 seconds
[0m12:35:08.809129 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m12:35:08.809129 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
describe table MOVIELENS.DEV.fct_ratings__dbt_tmp
[0m12:35:09.032359 [debug] [Thread-1 (]: SQL status: SUCCESS 4 in 0.222 seconds
[0m12:35:09.032359 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m12:35:09.032359 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
describe table MOVIELENS.DEV.fct_ratings
[0m12:35:09.267482 [debug] [Thread-1 (]: SQL status: SUCCESS 4 in 0.235 seconds
[0m12:35:09.299416 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m12:35:09.315076 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
describe table MOVIELENS.DEV.fct_ratings__dbt_tmp
[0m12:35:09.549383 [debug] [Thread-1 (]: SQL status: SUCCESS 4 in 0.235 seconds
[0m12:35:09.553442 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m12:35:09.553442 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
describe table "MOVIELENS"."DEV"."FCT_RATINGS"
[0m12:35:09.816978 [debug] [Thread-1 (]: SQL status: SUCCESS 4 in 0.271 seconds
[0m12:35:09.832587 [debug] [Thread-1 (]: 
    In "MOVIELENS"."DEV"."FCT_RATINGS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m12:35:09.874031 [debug] [Thread-1 (]: Writing runtime sql for node "model.Slip_Tests.fct_ratings"
[0m12:35:09.911235 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m12:35:09.911235 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
-- back compat for old kwarg name
  
  begin;
[0m12:35:10.332569 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.421 seconds
[0m12:35:10.332569 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m12:35:10.332569 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
insert into MOVIELENS.DEV.fct_ratings ("USER_ID", "MOVIE_ID", "RATING", "RATING_TIMESTAMP")
        (
            select "USER_ID", "MOVIE_ID", "RATING", "RATING_TIMESTAMP"
            from MOVIELENS.DEV.fct_ratings__dbt_tmp
        );
[0m12:35:10.975945 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.639 seconds
[0m12:35:10.975945 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m12:35:10.975945 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
COMMIT
[0m12:35:11.383869 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.404 seconds
[0m12:35:11.401737 [debug] [Thread-1 (]: Applying DROP to: MOVIELENS.DEV.fct_ratings__dbt_tmp
[0m12:35:11.415843 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.fct_ratings"
[0m12:35:11.415843 [debug] [Thread-1 (]: On model.Slip_Tests.fct_ratings: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.fct_ratings"} */
drop view if exists MOVIELENS.DEV.fct_ratings__dbt_tmp cascade
[0m12:35:11.719036 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.297 seconds
[0m12:35:11.719036 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a14ee6f-d53a-4422-a7e9-bbf105563a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F014BCA8D0>]}
[0m12:35:11.719036 [info ] [Thread-1 (]: 10 of 11 OK created sql incremental model DEV.fct_ratings ...................... [[32mSUCCESS 0[0m in 5.21s]
[0m12:35:11.719036 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.fct_ratings
[0m12:35:11.727145 [debug] [Thread-1 (]: Began running node model.Slip_Tests.dim_user
[0m12:35:11.727918 [info ] [Thread-1 (]: 11 of 11 START sql table model DEV.dim_user .................................... [RUN]
[0m12:35:11.729884 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Slip_Tests.fct_ratings, now model.Slip_Tests.dim_user)
[0m12:35:11.730424 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.dim_user
[0m12:35:11.736192 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.dim_user"
[0m12:35:11.736705 [debug] [Thread-1 (]: Began executing node model.Slip_Tests.dim_user
[0m12:35:11.736705 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.dim_user"
[0m12:35:11.743225 [debug] [Thread-1 (]: On model.Slip_Tests.dim_user: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.dim_user"} */
ALTER SESSION SET TIMEZONE = 'Africa/Johannesburg'
[0m12:35:11.998388 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.255 seconds
[0m12:35:12.002549 [debug] [Thread-1 (]: Writing runtime sql for node "model.Slip_Tests.dim_user"
[0m12:35:12.005663 [debug] [Thread-1 (]: Using snowflake connection "model.Slip_Tests.dim_user"
[0m12:35:12.006699 [debug] [Thread-1 (]: On model.Slip_Tests.dim_user: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "model.Slip_Tests.dim_user"} */
create or replace transient table MOVIELENS.DEV.dim_user
    

    
    as (WITH ratings AS (
    SELECT DISTINCT user_id FROM MOVIELENS.DEV.src_ratings
),

tags AS (
    SELECT DISTINCT user_id FROM MOVIELENS.DEV.src_tags
)

SELECT DISTINCT user_id
FROM (
    SELECT * FROM ratings
    UNION
    SELECT * FROM tags
)
    )
;
[0m12:35:14.047496 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.041 seconds
[0m12:35:14.047496 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a14ee6f-d53a-4422-a7e9-bbf105563a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F015E7C1D0>]}
[0m12:35:14.055016 [info ] [Thread-1 (]: 11 of 11 OK created sql table model DEV.dim_user ............................... [[32mSUCCESS 1[0m in 2.32s]
[0m12:35:14.055016 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.dim_user
[0m12:35:14.055016 [debug] [Thread-1 (]: Began running node model.Slip_Tests.dim_movies_with_tags
[0m12:35:14.055016 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Slip_Tests.dim_user, now model.Slip_Tests.dim_movies_with_tags)
[0m12:35:14.055016 [debug] [Thread-1 (]: Began compiling node model.Slip_Tests.dim_movies_with_tags
[0m12:35:14.175337 [debug] [Thread-1 (]: Writing injected SQL for node "model.Slip_Tests.dim_movies_with_tags"
[0m12:35:14.175337 [debug] [Thread-1 (]: Finished running node model.Slip_Tests.dim_movies_with_tags
[0m12:35:14.175337 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:35:14.175337 [debug] [MainThread]: Connection 'list_MOVIELENS' was left open.
[0m12:35:14.175337 [debug] [MainThread]: On list_MOVIELENS: Close
[0m12:35:14.611433 [debug] [MainThread]: Connection 'list_MOVIELENS_DEV' was left open.
[0m12:35:14.611433 [debug] [MainThread]: On list_MOVIELENS_DEV: Close
[0m12:35:15.067706 [debug] [MainThread]: Connection 'model.Slip_Tests.dim_movies_with_tags' was left open.
[0m12:35:15.067706 [debug] [MainThread]: On model.Slip_Tests.dim_movies_with_tags: Close
[0m12:35:15.481369 [info ] [MainThread]: 
[0m12:35:15.481369 [info ] [MainThread]: Finished running 1 incremental model, 6 table models, 4 view models in 0 hours 0 minutes and 32.34 seconds (32.34s).
[0m12:35:15.498503 [debug] [MainThread]: Command end result
[0m12:35:15.554157 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m12:35:15.554157 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m12:35:15.574523 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\dbt_workspace\Slip_Tests\target\run_results.json
[0m12:35:15.574523 [info ] [MainThread]: 
[0m12:35:15.574523 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:35:15.582999 [info ] [MainThread]: 
[0m12:35:15.584762 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=11
[0m12:35:15.585008 [debug] [MainThread]: Command `dbt run` succeeded at 12:35:15.585008 after 36.94 seconds
[0m12:35:15.585008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F01193F560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F014682240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0146B2750>]}
[0m12:35:15.585008 [debug] [MainThread]: Flushing usage events
[0m12:35:17.017490 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:36:57.828576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278227393A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027822061940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027822061280>]}


============================== 12:36:57.841955 | 6b8fab01-5c0a-4114-8dde-f26af7e82d18 ==============================
[0m12:36:57.841955 [info ] [MainThread]: Running with dbt=1.10.1
[0m12:36:57.841955 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ThembaniFaleni\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\dbt_workspace\\Slip_Tests\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:36:59.172676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b8fab01-5c0a-4114-8dde-f26af7e82d18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002781FA4A0C0>]}
[0m12:36:59.441242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b8fab01-5c0a-4114-8dde-f26af7e82d18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027824B62B40>]}
[0m12:36:59.441242 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m12:36:59.920806 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m12:37:00.393335 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:37:00.393335 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:37:00.537483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b8fab01-5c0a-4114-8dde-f26af7e82d18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278228D4A40>]}
[0m12:37:00.818048 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m12:37:00.849797 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m12:37:00.884032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b8fab01-5c0a-4114-8dde-f26af7e82d18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027825088D10>]}
[0m12:37:00.884032 [info ] [MainThread]: Found 12 models, 12 data tests, 1 snapshot, 6 sources, 592 macros
[0m12:37:00.916969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b8fab01-5c0a-4114-8dde-f26af7e82d18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027824E10A40>]}
[0m12:37:00.916969 [info ] [MainThread]: 
[0m12:37:00.916969 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:37:00.925760 [info ] [MainThread]: 
[0m12:37:00.927908 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:37:00.927908 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MOVIELENS'
[0m12:37:01.098507 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS"
[0m12:37:01.098507 [debug] [ThreadPool]: On list_MOVIELENS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS"} */
show terse schemas in database MOVIELENS
    limit 10000
[0m12:37:01.098507 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:37:03.139736 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.038 seconds
[0m12:37:03.161064 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MOVIELENS_snapshots'
[0m12:37:03.188965 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m12:37:03.188965 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
alter session set quoted_identifiers_ignore_case = false;
[0m12:37:03.188965 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:37:04.391490 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.204 seconds
[0m12:37:04.391490 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m12:37:04.391490 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
show objects in MOVIELENS.snapshots
    limit 10000
    
;
[0m12:37:04.674506 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.276 seconds
[0m12:37:04.674506 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_snapshots"
[0m12:37:04.674506 [debug] [ThreadPool]: On list_MOVIELENS_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_snapshots"} */
alter session unset quoted_identifiers_ignore_case;
[0m12:37:04.939325 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.256 seconds
[0m12:37:04.939325 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MOVIELENS_snapshots, now list_MOVIELENS_DEV)
[0m12:37:04.939325 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m12:37:04.939325 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session set quoted_identifiers_ignore_case = false;
[0m12:37:05.208272 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.256 seconds
[0m12:37:05.208272 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m12:37:05.208272 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
show objects in MOVIELENS.DEV
    limit 10000
    
;
[0m12:37:05.549499 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.346 seconds
[0m12:37:05.565148 [debug] [ThreadPool]: Using snowflake connection "list_MOVIELENS_DEV"
[0m12:37:05.565148 [debug] [ThreadPool]: On list_MOVIELENS_DEV: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "connection_name": "list_MOVIELENS_DEV"} */
alter session unset quoted_identifiers_ignore_case;
[0m12:37:05.794404 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.228 seconds
[0m12:37:05.835287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b8fab01-5c0a-4114-8dde-f26af7e82d18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002781F0E3860>]}
[0m12:37:05.846576 [debug] [Thread-1 (]: Began running node snapshot.Slip_Tests.snap_tags
[0m12:37:05.846576 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.snap_tags ...................................... [RUN]
[0m12:37:05.846576 [debug] [Thread-1 (]: Acquiring new snowflake connection 'snapshot.Slip_Tests.snap_tags'
[0m12:37:05.846576 [debug] [Thread-1 (]: Began compiling node snapshot.Slip_Tests.snap_tags
[0m12:37:05.885228 [debug] [Thread-1 (]: Began executing node snapshot.Slip_Tests.snap_tags
[0m12:37:05.976544 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m12:37:05.976544 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
[0m12:37:05.976544 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:37:07.260705 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 1.288 seconds
[0m12:37:07.380557 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m12:37:07.388159 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
create or replace temporary table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS__dbt_tmp"
as (
    
    
    with snapshot_query as (

        





SELECT
    md5(cast(coalesce(cast(user_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(movie_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS id,
    user_id,
    movie_id,
    tag,
    tag_timestamp
FROM MOVIELENS.DEV.src_tags
-- LIMIT 100


    ),

    snapshotted_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    

        from "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    
,
            tag_timestamp as dbt_updated_at,
            tag_timestamp as dbt_valid_from,
            
  
  coalesce(nullif(tag_timestamp, tag_timestamp), null)
  as dbt_valid_to
,
            md5(coalesce(cast(user_id as varchar ), '')
         || '|' || coalesce(cast(movie_id as varchar ), '')
         || '|' || coalesce(cast(tag as varchar ), '')
         || '|' || coalesce(cast(tag_timestamp as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    
,
            tag_timestamp as dbt_updated_at,
            tag_timestamp as dbt_valid_from,
            tag_timestamp as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

            where 
    
        snapshotted_data.dbt_unique_key_1 is null
    

            or (
    
        snapshotted_data.dbt_unique_key_1 is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.tag_timestamp)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.tag_timestamp)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

            where 
    
        source_data.dbt_unique_key_1 is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    )
;
[0m12:37:10.063982 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.678 seconds
[0m12:37:10.063982 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m12:37:10.063982 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS__dbt_tmp"
[0m12:37:10.314832 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.247 seconds
[0m12:37:10.314832 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m12:37:10.314832 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
[0m12:37:10.581968 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.254 seconds
[0m12:37:10.588581 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m12:37:10.588581 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS__dbt_tmp"
[0m12:37:10.871540 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.293 seconds
[0m12:37:10.889188 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m12:37:10.889188 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
[0m12:37:11.108436 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.224 seconds
[0m12:37:11.135308 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m12:37:11.139415 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
describe table "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS__dbt_tmp"
[0m12:37:11.392529 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.258 seconds
[0m12:37:11.456418 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m12:37:11.456418 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
/* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
select * from (
        
    
    with snapshot_query as (

        





SELECT
    md5(cast(coalesce(cast(user_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(movie_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS id,
    user_id,
    movie_id,
    tag,
    tag_timestamp
FROM MOVIELENS.DEV.src_tags
-- LIMIT 100


    ),

    snapshotted_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    

        from "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    
,
            tag_timestamp as dbt_updated_at,
            tag_timestamp as dbt_valid_from,
            
  
  coalesce(nullif(tag_timestamp, tag_timestamp), null)
  as dbt_valid_to
,
            md5(coalesce(cast(user_id as varchar ), '')
         || '|' || coalesce(cast(movie_id as varchar ), '')
         || '|' || coalesce(cast(tag as varchar ), '')
         || '|' || coalesce(cast(tag_timestamp as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    
,
            tag_timestamp as dbt_updated_at,
            tag_timestamp as dbt_valid_from,
            tag_timestamp as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        
            user_id as dbt_unique_key_1 ,
        
            movie_id as dbt_unique_key_2 ,
        
            tag as dbt_unique_key_3
        
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

            where 
    
        snapshotted_data.dbt_unique_key_1 is null
    

            or (
    
        snapshotted_data.dbt_unique_key_1 is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.tag_timestamp)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.tag_timestamp)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

            where 
    
        source_data.dbt_unique_key_1 is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m12:37:12.100528 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.652 seconds
[0m12:37:12.116172 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m12:37:12.116172 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
/* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m12:37:12.336765 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.214 seconds
[0m12:37:12.336765 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.Slip_Tests.snap_tags"
[0m12:37:12.336765 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m12:37:12.336765 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
BEGIN
[0m12:37:12.729779 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.380 seconds
[0m12:37:12.729779 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m12:37:12.729779 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
merge into "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS" as DBT_INTERNAL_DEST
    using "MOVIELENS"."SNAPSHOTS"."SNAP_TAGS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("ID", "USER_ID", "MOVIE_ID", "TAG", "TAG_TIMESTAMP", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("ID", "USER_ID", "MOVIE_ID", "TAG", "TAG_TIMESTAMP", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m12:37:13.856283 [debug] [Thread-1 (]: SQL status: SUCCESS 2 in 1.122 seconds
[0m12:37:13.856283 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Slip_Tests.snap_tags"
[0m12:37:13.856283 [debug] [Thread-1 (]: On snapshot.Slip_Tests.snap_tags: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "Slip_Tests", "target_name": "dev", "node_id": "snapshot.Slip_Tests.snap_tags"} */
COMMIT
[0m12:37:14.373365 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.514 seconds
[0m12:37:14.421094 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b8fab01-5c0a-4114-8dde-f26af7e82d18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002781FA492B0>]}
[0m12:37:14.421094 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.snap_tags ...................................... [[32mSUCCESS 2[0m in 8.57s]
[0m12:37:14.421094 [debug] [Thread-1 (]: Finished running node snapshot.Slip_Tests.snap_tags
[0m12:37:14.437264 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:37:14.437264 [debug] [MainThread]: Connection 'list_MOVIELENS' was left open.
[0m12:37:14.437264 [debug] [MainThread]: On list_MOVIELENS: Close
[0m12:37:14.875256 [debug] [MainThread]: Connection 'list_MOVIELENS_DEV' was left open.
[0m12:37:14.890976 [debug] [MainThread]: On list_MOVIELENS_DEV: Close
[0m12:37:15.301897 [debug] [MainThread]: Connection 'snapshot.Slip_Tests.snap_tags' was left open.
[0m12:37:15.301897 [debug] [MainThread]: On snapshot.Slip_Tests.snap_tags: Close
[0m12:37:15.679997 [info ] [MainThread]: 
[0m12:37:15.681237 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 14.75 seconds (14.75s).
[0m12:37:15.682985 [debug] [MainThread]: Command end result
[0m12:37:15.744601 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dbt_workspace\Slip_Tests\target\manifest.json
[0m12:37:15.744601 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dbt_workspace\Slip_Tests\target\semantic_manifest.json
[0m12:37:15.775199 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\dbt_workspace\Slip_Tests\target\run_results.json
[0m12:37:15.775199 [info ] [MainThread]: 
[0m12:37:15.775199 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:37:15.782215 [info ] [MainThread]: 
[0m12:37:15.783728 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:37:15.786531 [debug] [MainThread]: Command `dbt snapshot` succeeded at 12:37:15.786531 after 18.33 seconds
[0m12:37:15.786531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278227393A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027824F6B3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027824BDC7D0>]}
[0m12:37:15.786531 [debug] [MainThread]: Flushing usage events
[0m12:37:17.124655 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:24:42.061956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002474391E120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024744788550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247448E3D90>]}


============================== 16:24:42.106734 | 4cb69409-c4d3-4a37-b28b-c9c3ecbea33e ==============================
[0m16:24:42.106734 [info ] [MainThread]: Running with dbt=1.9.0
[0m16:24:42.108481 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\ThandoCalana\\.dbt', 'log_path': 'c:\\Users\\ThandoCalana\\Downloads\\Slip_Tests-20250620T114550Z-1-001\\Slip_Tests\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:24:42.569683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4cb69409-c4d3-4a37-b28b-c9c3ecbea33e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024743DBE650>]}
[0m16:24:42.699935 [error] [MainThread]: Encountered an error:
Runtime Error
  The packages.yml file in this project is malformed. Please double check
  the contents of this file and fix any errors before retrying.
  
  You can find more information on the syntax for this file here:
  https://docs.getdbt.com/docs/package-management
  
  Validator Error:
  {'name': 'dbt_utils', 'package': 'dbt-labs/dbt_utils', 'version': '1.3.0', 'unrendered': {'name': 'dbt_utils', 'package': 'dbt-labs/dbt_utils', 'version': '1.3.0'}} is not valid under any of the given schemas
  
[0m16:24:42.702463 [debug] [MainThread]: Command `cli deps` failed at 16:24:42.702199 after 0.92 seconds
[0m16:24:42.703122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024745AF8C00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024745AFACF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024744943950>]}
[0m16:24:42.703741 [debug] [MainThread]: Flushing usage events
[0m16:24:44.036587 [debug] [MainThread]: An error was encountered while trying to flush usage events
